"use strict";!function(d,_){if("IntersectionObserver"in d&&"IntersectionObserverEntry"in d&&"intersectionRatio"in d.IntersectionObserverEntry.prototype)"isIntersecting"in d.IntersectionObserverEntry.prototype||Object.defineProperty(d.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return 0<this.intersectionRatio}});else{var e=[];t.prototype.THROTTLE_TIMEOUT=100,t.prototype.POLL_INTERVAL=null,t.prototype.USE_MUTATION_OBSERVER=!0,t.prototype.observe=function(e){if(!this._observationTargets.some(function(t){return t.element==e})){if(!e||1!=e.nodeType)throw new Error("target must be an Element");this._registerInstance(),this._observationTargets.push({element:e,entry:null}),this._monitorIntersections(),this._checkForIntersections()}},t.prototype.unobserve=function(e){this._observationTargets=this._observationTargets.filter(function(t){return t.element!=e}),this._observationTargets.length||(this._unmonitorIntersections(),this._unregisterInstance())},t.prototype.disconnect=function(){this._observationTargets=[],this._unmonitorIntersections(),this._unregisterInstance()},t.prototype.takeRecords=function(){var t=this._queuedEntries.slice();return this._queuedEntries=[],t},t.prototype._initThresholds=function(t){var e=t||[0];return Array.isArray(e)||(e=[e]),e.sort().filter(function(t,e,n){if("number"!=typeof t||isNaN(t)||t<0||1<t)throw new Error("threshold must be a number between 0 and 1 inclusively");return t!==n[e-1]})},t.prototype._parseRootMargin=function(t){var e=(t||"0px").split(/\s+/).map(function(t){var e=/^(-?\d*\.?\d+)(px|%)$/.exec(t);if(!e)throw new Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(e[1]),unit:e[2]}});return e[1]=e[1]||e[0],e[2]=e[2]||e[0],e[3]=e[3]||e[1],e},t.prototype._monitorIntersections=function(){this._monitoringIntersections||(this._monitoringIntersections=!0,this.POLL_INTERVAL?this._monitoringInterval=setInterval(this._checkForIntersections,this.POLL_INTERVAL):(n(d,"resize",this._checkForIntersections,!0),n(_,"scroll",this._checkForIntersections,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in d&&(this._domObserver=new MutationObserver(this._checkForIntersections),this._domObserver.observe(_,{attributes:!0,childList:!0,characterData:!0,subtree:!0}))))},t.prototype._unmonitorIntersections=function(){this._monitoringIntersections&&(this._monitoringIntersections=!1,clearInterval(this._monitoringInterval),this._monitoringInterval=null,o(d,"resize",this._checkForIntersections,!0),o(_,"scroll",this._checkForIntersections,!0),this._domObserver&&(this._domObserver.disconnect(),this._domObserver=null))},t.prototype._checkForIntersections=function(){var h=this._rootIsInDom(),c=h?this._getRootRect():{top:0,bottom:0,left:0,right:0,width:0,height:0};this._observationTargets.forEach(function(t){var e=t.element,n=m(e),o=this._rootContainsTarget(e),i=t.entry,r=h&&o&&this._computeTargetAndRootIntersection(e,c),s=t.entry=new a({time:d.performance&&performance.now&&performance.now(),target:e,boundingClientRect:n,rootBounds:c,intersectionRect:r});i?h&&o?this._hasCrossedThreshold(i,s)&&this._queuedEntries.push(s):i&&i.isIntersecting&&this._queuedEntries.push(s):this._queuedEntries.push(s)},this),this._queuedEntries.length&&this._callback(this.takeRecords(),this)},t.prototype._computeTargetAndRootIntersection=function(t,e){if("none"!=d.getComputedStyle(t).display){for(var n,o,i,r,s,h,c,a,u=m(t),l=v(t),p=!1;!p;){var f=null,g=1==l.nodeType?d.getComputedStyle(l):{};if("none"==g.display)return;if(l==this.root||l==_?(p=!0,f=e):l!=_.body&&l!=_.documentElement&&"visible"!=g.overflow&&(f=m(l)),f&&(n=f,o=u,void 0,i=Math.max(n.top,o.top),r=Math.min(n.bottom,o.bottom),s=Math.max(n.left,o.left),h=Math.min(n.right,o.right),a=r-i,!(u=0<=(c=h-s)&&0<=a&&{top:i,bottom:r,left:s,right:h,width:c,height:a})))break;l=v(l)}return u}},t.prototype._getRootRect=function(){var t;if(this.root)t=m(this.root);else{var e=_.documentElement,n=_.body;t={top:0,left:0,right:e.clientWidth||n.clientWidth,width:e.clientWidth||n.clientWidth,bottom:e.clientHeight||n.clientHeight,height:e.clientHeight||n.clientHeight}}return this._expandRectByRootMargin(t)},t.prototype._expandRectByRootMargin=function(n){var t=this._rootMarginValues.map(function(t,e){return"px"==t.unit?t.value:t.value*(e%2?n.width:n.height)/100}),e={top:n.top-t[0],right:n.right+t[1],bottom:n.bottom+t[2],left:n.left-t[3]};return e.width=e.right-e.left,e.height=e.bottom-e.top,e},t.prototype._hasCrossedThreshold=function(t,e){var n=t&&t.isIntersecting?t.intersectionRatio||0:-1,o=e.isIntersecting?e.intersectionRatio||0:-1;if(n!==o)for(var i=0;i<this.thresholds.length;i++){var r=this.thresholds[i];if(r==n||r==o||r<n!=r<o)return!0}},t.prototype._rootIsInDom=function(){return!this.root||i(_,this.root)},t.prototype._rootContainsTarget=function(t){return i(this.root||_,t)},t.prototype._registerInstance=function(){e.indexOf(this)<0&&e.push(this)},t.prototype._unregisterInstance=function(){var t=e.indexOf(this);-1!=t&&e.splice(t,1)},d.IntersectionObserver=t,d.IntersectionObserverEntry=a}function a(t){this.time=t.time,this.target=t.target,this.rootBounds=t.rootBounds,this.boundingClientRect=t.boundingClientRect,this.intersectionRect=t.intersectionRect||{top:0,bottom:0,left:0,right:0,width:0,height:0},this.isIntersecting=!!t.intersectionRect;var e=this.boundingClientRect,n=e.width*e.height,o=this.intersectionRect,i=o.width*o.height;this.intersectionRatio=n?i/n:this.isIntersecting?1:0}function t(t,e){var n,o,i,r=e||{};if("function"!=typeof t)throw new Error("callback must be a function");if(r.root&&1!=r.root.nodeType)throw new Error("root must be an Element");this._checkForIntersections=(n=this._checkForIntersections.bind(this),o=this.THROTTLE_TIMEOUT,i=null,function(){i||(i=setTimeout(function(){n(),i=null},o))}),this._callback=t,this._observationTargets=[],this._queuedEntries=[],this._rootMarginValues=this._parseRootMargin(r.rootMargin),this.thresholds=this._initThresholds(r.threshold),this.root=r.root||null,this.rootMargin=this._rootMarginValues.map(function(t){return t.value+t.unit}).join(" ")}function n(t,e,n,o){"function"==typeof t.addEventListener?t.addEventListener(e,n,o||!1):"function"==typeof t.attachEvent&&t.attachEvent("on"+e,n)}function o(t,e,n,o){"function"==typeof t.removeEventListener?t.removeEventListener(e,n,o||!1):"function"==typeof t.detatchEvent&&t.detatchEvent("on"+e,n)}function m(t){var e;try{e=t.getBoundingClientRect()}catch(t){}return e?(e.width&&e.height||(e={top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.right-e.left,height:e.bottom-e.top}),e):{top:0,bottom:0,left:0,right:0,width:0,height:0}}function i(t,e){for(var n=e;n;){if(n==t)return!0;n=v(n)}return!1}function v(t){var e=t.parentNode;return e&&11==e.nodeType&&e.host?e.host:e}}(window,document);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImludGVyc2VjdGlvbi1vYnNlcnZlci5qcyJdLCJuYW1lcyI6WyJ3aW5kb3ciLCJkb2N1bWVudCIsInByb3RvdHlwZSIsIkludGVyc2VjdGlvbk9ic2VydmVyRW50cnkiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImdldCIsInRoaXMiLCJpbnRlcnNlY3Rpb25SYXRpbyIsInJlZ2lzdHJ5IiwiSW50ZXJzZWN0aW9uT2JzZXJ2ZXIiLCJUSFJPVFRMRV9USU1FT1VUIiwiUE9MTF9JTlRFUlZBTCIsIm9ic2VydmUiLCJ0YXJnZXQiLCJub2RlVHlwZSIsIl9vYnNlcnZhdGlvblRhcmdldHMiLCJzb21lIiwiaXRlbSIsIkVycm9yIiwiX21vbml0b3JJbnRlcnNlY3Rpb25zIiwiX3JlZ2lzdGVySW5zdGFuY2UiLCJwdXNoIiwiZWxlbWVudCIsImVudHJ5IiwidW5vYnNlcnZlIiwiZmlsdGVyIiwibGVuZ3RoIiwiX3VubW9uaXRvckludGVyc2VjdGlvbnMiLCJfdW5yZWdpc3Rlckluc3RhbmNlIiwiZGlzY29ubmVjdCIsInJlY29yZHMiLCJfcXVldWVkRW50cmllcyIsInRha2VSZWNvcmRzIiwic2xpY2UiLCJfaW5pdFRocmVzaG9sZHMiLCJvcHRfdGhyZXNob2xkIiwidGhyZXNob2xkIiwiQXJyYXkiLCJpc0FycmF5Iiwic29ydCIsInQiLCJpIiwiYSIsImlzTmFOIiwibWFyZ2lucyIsIm9wdF9yb290TWFyZ2luIiwibWFwIiwibWFyZ2luIiwicGFydHMiLCJleGVjIiwidmFsdWUiLCJwYXJzZUZsb2F0IiwidW5pdCIsIl9tb25pdG9yaW5nSW50ZXJzZWN0aW9ucyIsImF0dHJpYnV0ZXMiLCJjaGlsZExpc3QiLCJjaGFyYWN0ZXJEYXRhIiwiX21vbml0b3JpbmdJbnRlcnZhbCIsInNldEludGVydmFsIiwiX2NoZWNrRm9ySW50ZXJzZWN0aW9ucyIsImFkZEV2ZW50IiwiVVNFX01VVEFUSU9OX09CU0VSVkVSIiwiY2xlYXJJbnRlcnZhbCIsInJlbW92ZUV2ZW50Iiwicm9vdElzSW5Eb20iLCJfcm9vdElzSW5Eb20iLCJyb290UmVjdCIsIl9nZXRSb290UmVjdCIsImdldEVtcHR5UmVjdCIsInRhcmdldFJlY3QiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJuZXdFbnRyeSIsInJpZ2h0Iiwid2lkdGgiLCJoZWlnaHQiLCJmb3JFYWNoIiwiX2hhc0Nyb3NzZWRUaHJlc2hvbGQiLCJvbGRFbnRyeSIsInJvb3RDb250YWluc1RhcmdldCIsImludGVyc2VjdGlvblJlY3QiLCJfY29tcHV0ZVRhcmdldEFuZFJvb3RJbnRlcnNlY3Rpb24iLCJ0aW1lIiwicGVyZm9ybWFuY2UiLCJub3ciLCJib3VuZGluZ0NsaWVudFJlY3QiLCJyb290Qm91bmRzIiwiX2NhbGxiYWNrIiwiaXNJbnRlcnNlY3RpbmciLCJnZXRDb21wdXRlZFN0eWxlIiwiZGlzcGxheSIsInBhcmVudFJlY3QiLCJyZWN0MSIsInJlY3QyIiwibGVmdCIsInBhcmVudCIsImdldFBhcmVudE5vZGUiLCJhdFJvb3QiLCJjb21wdXRlUmVjdEludGVyc2VjdGlvbiIsInRvcCIsInJvb3QiLCJkb2N1bWVudEVsZW1lbnQiLCJwYXJlbnRDb21wdXRlZFN0eWxlIiwib3ZlcmZsb3ciLCJyZWN0IiwiYm90dG9tIiwiTWF0aCIsIm1heCIsIm1pbiIsImh0bWwiLCJjbGllbnRIZWlnaHQiLCJuZXdSZWN0IiwiYm9keSIsImNsaWVudFdpZHRoIiwiX2V4cGFuZFJlY3RCeVJvb3RNYXJnaW4iLCJfcm9vdE1hcmdpblZhbHVlcyIsIm5ld1JhdGlvIiwib2xkUmF0aW8iLCJ0aHJlc2hvbGRzIiwiX3Jvb3RDb250YWluc1RhcmdldCIsImNvbnRhaW5zRGVlcCIsInRpbWVyIiwic2V0VGltZW91dCIsImZuIiwiaW5kZXgiLCJpbmRleE9mIiwic3BsaWNlIiwiaW50ZXJzZWN0aW9uQXJlYSIsInRhcmdldEFyZWEiLCJjYWxsYmFjayIsIm9wdF9vcHRpb25zIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIm9wdGlvbnMiLCJiaW5kIiwiZGV0YXRjaEV2ZW50IiwidGltZW91dCIsInJvb3RNYXJnaW4iLCJqb2luIiwibm9kZSIsIm9wdF91c2VDYXB0dXJlIiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2ZW50IiwiYXR0YWNoRXZlbnQiLCJlbCIsImVyciIsImNoaWxkIiwicGFyZW50Tm9kZSIsImhvc3QiXSwibWFwcGluZ3MiOiJjQVNDLFNBQVNBLEVBQVFDLEdBS2hCLEdBQUEseUJBQUFELEdBRUUsOEJBQStCQSxHQURqQyxzQkFBSUEsRUFBMEJBLDBCQUM1QkUsVUFLTSxtQkFBb0JGLEVBQU9HLDBCQUEwQkQsV0FDekRFLE9BQU9DLGVBQWVMLEVBQU9HLDBCQUEwQkQsVUFFbkRJLGlCQUFLLENBQ0hBLElBQUEsV0FDRCxPQUFBLEVBQUFDLEtBQUFDLHlCQVpULENBNEJBLElBQUFDLEVBQUEsR0EwRUFDLEVBQXFCUixVQUFVUyxpQkFBbUIsSUFRbERELEVBQXFCUixVQUFVVSxjQUFnQixLQWMvQ0YsRUFBcUJSLFVBQVVXLHVCQUFtQkMsRUFBbERKLEVBQXFCUixVQUFVVyxRQUFVLFNBQVNDLEdBYWhELElBSnVCQyxLQUFZQyxvQkFBSUMsS0FBQSxTQUFBQyxHQUNyQyxPQUFNQSxFQUFJQyxTQUFNTCxJQUdsQixDQUM4QixJQUE5QkEsR0FBQSxHQUFBQSxFQUFBQyxTQUlBLE1BQUtLLElBQUFBLE1BQUFBLDZCQUxMYixLQUFLYyxvQkFVUGQsS0FBQVMsb0JBQUFNLEtBQUEsQ0FSSUMsUUFBU1QsRUFDVFUsTUFBTyxPQVdYZCxLQUFBQSx3QkFDRUgsS0FBS1MsMkJBU05OLEVBVkRSLFVBQUF1QixVQUFBLFNBQUFYLEdBQ0VQLEtBQUtTLG9CQVlQVCxLQUFBUyxvQkFBQVUsT0FBQSxTQUFBUixHQVRNLE9BQU9BLEVBQUtLLFNBQVdULElBYXRCRSxLQUFBQSxvQkFBTFcsU0FDQXBCLEtBQUtxQiwwQkFDTHJCLEtBQUtzQix3QkFIUG5CLEVBQXFCUixVQUFVNEIsV0FBYSxXQWE1Q3BCLEtBQUFBLG9CQUFxQlIsR0FDbkJLLEtBQUl3QiwwQkFDSnhC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bi1vYnNlcnZlci5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNiBHb29nbGUgSW5jLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgVzNDIFNPRlRXQVJFIEFORCBET0NVTUVOVCBOT1RJQ0UgQU5EIExJQ0VOU0UuXHJcbiAqXHJcbiAqICBodHRwczovL3d3dy53My5vcmcvQ29uc29ydGl1bS9MZWdhbC8yMDE1L2NvcHlyaWdodC1zb2Z0d2FyZS1hbmQtZG9jdW1lbnRcclxuICpcclxuICovXHJcblxyXG4oZnVuY3Rpb24od2luZG93LCBkb2N1bWVudCkge1xyXG4gICd1c2Ugc3RyaWN0JztcclxuXHJcblxyXG4gIC8vIEV4aXRzIGVhcmx5IGlmIGFsbCBJbnRlcnNlY3Rpb25PYnNlcnZlciBhbmQgSW50ZXJzZWN0aW9uT2JzZXJ2ZXJFbnRyeVxyXG4gIC8vIGZlYXR1cmVzIGFyZSBuYXRpdmVseSBzdXBwb3J0ZWQuXHJcbiAgaWYgKCdJbnRlcnNlY3Rpb25PYnNlcnZlcicgaW4gd2luZG93ICYmXHJcbiAgICAnSW50ZXJzZWN0aW9uT2JzZXJ2ZXJFbnRyeScgaW4gd2luZG93ICYmXHJcbiAgICAnaW50ZXJzZWN0aW9uUmF0aW8nIGluIHdpbmRvdy5JbnRlcnNlY3Rpb25PYnNlcnZlckVudHJ5LnByb3RvdHlwZSkge1xyXG5cclxuICAgIC8vIE1pbmltYWwgcG9seWZpbGwgZm9yIEVkZ2UgMTUncyBsYWNrIG9mIGBpc0ludGVyc2VjdGluZ2BcclxuICAgIC8vIFNlZTogaHR0cHM6Ly9naXRodWIuY29tL3czYy9JbnRlcnNlY3Rpb25PYnNlcnZlci9pc3N1ZXMvMjExXHJcbiAgICBpZiAoISgnaXNJbnRlcnNlY3RpbmcnIGluIHdpbmRvdy5JbnRlcnNlY3Rpb25PYnNlcnZlckVudHJ5LnByb3RvdHlwZSkpIHtcclxuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbmRvdy5JbnRlcnNlY3Rpb25PYnNlcnZlckVudHJ5LnByb3RvdHlwZSxcclxuICAgICAgICAnaXNJbnRlcnNlY3RpbmcnLCB7XHJcbiAgICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5pbnRlcnNlY3Rpb25SYXRpbyA+IDA7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG5cclxuXHJcbiAgLyoqXHJcbiAgICogQW4gSW50ZXJzZWN0aW9uT2JzZXJ2ZXIgcmVnaXN0cnkuIFRoaXMgcmVnaXN0cnkgZXhpc3RzIHRvIGhvbGQgYSBzdHJvbmdcclxuICAgKiByZWZlcmVuY2UgdG8gSW50ZXJzZWN0aW9uT2JzZXJ2ZXIgaW5zdGFuY2VzIGN1cnJlbnRseSBvYnNlcnZlcmluZyBhIHRhcmdldFxyXG4gICAqIGVsZW1lbnQuIFdpdGhvdXQgdGhpcyByZWdpc3RyeSwgaW5zdGFuY2VzIHdpdGhvdXQgYW5vdGhlciByZWZlcmVuY2UgbWF5IGJlXHJcbiAgICogZ2FyYmFnZSBjb2xsZWN0ZWQuXHJcbiAgICovXHJcbiAgdmFyIHJlZ2lzdHJ5ID0gW107XHJcblxyXG5cclxuICAvKipcclxuICAgKiBDcmVhdGVzIHRoZSBnbG9iYWwgSW50ZXJzZWN0aW9uT2JzZXJ2ZXJFbnRyeSBjb25zdHJ1Y3Rvci5cclxuICAgKiBodHRwczovL3czYy5naXRodWIuaW8vSW50ZXJzZWN0aW9uT2JzZXJ2ZXIvI2ludGVyc2VjdGlvbi1vYnNlcnZlci1lbnRyeVxyXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBlbnRyeSBBIGRpY3Rpb25hcnkgb2YgaW5zdGFuY2UgcHJvcGVydGllcy5cclxuICAgKiBAY29uc3RydWN0b3JcclxuICAgKi9cclxuICBmdW5jdGlvbiBJbnRlcnNlY3Rpb25PYnNlcnZlckVudHJ5KGVudHJ5KSB7XHJcbiAgICB0aGlzLnRpbWUgPSBlbnRyeS50aW1lO1xyXG4gICAgdGhpcy50YXJnZXQgPSBlbnRyeS50YXJnZXQ7XHJcbiAgICB0aGlzLnJvb3RCb3VuZHMgPSBlbnRyeS5yb290Qm91bmRzO1xyXG4gICAgdGhpcy5ib3VuZGluZ0NsaWVudFJlY3QgPSBlbnRyeS5ib3VuZGluZ0NsaWVudFJlY3Q7XHJcbiAgICB0aGlzLmludGVyc2VjdGlvblJlY3QgPSBlbnRyeS5pbnRlcnNlY3Rpb25SZWN0IHx8IGdldEVtcHR5UmVjdCgpO1xyXG4gICAgdGhpcy5pc0ludGVyc2VjdGluZyA9ICEhZW50cnkuaW50ZXJzZWN0aW9uUmVjdDtcclxuXHJcbiAgICAvLyBDYWxjdWxhdGVzIHRoZSBpbnRlcnNlY3Rpb24gcmF0aW8uXHJcbiAgICB2YXIgdGFyZ2V0UmVjdCA9IHRoaXMuYm91bmRpbmdDbGllbnRSZWN0O1xyXG4gICAgdmFyIHRhcmdldEFyZWEgPSB0YXJnZXRSZWN0LndpZHRoICogdGFyZ2V0UmVjdC5oZWlnaHQ7XHJcbiAgICB2YXIgaW50ZXJzZWN0aW9uUmVjdCA9IHRoaXMuaW50ZXJzZWN0aW9uUmVjdDtcclxuICAgIHZhciBpbnRlcnNlY3Rpb25BcmVhID0gaW50ZXJzZWN0aW9uUmVjdC53aWR0aCAqIGludGVyc2VjdGlvblJlY3QuaGVpZ2h0O1xyXG5cclxuICAgIC8vIFNldHMgaW50ZXJzZWN0aW9uIHJhdGlvLlxyXG4gICAgaWYgKHRhcmdldEFyZWEpIHtcclxuICAgICAgdGhpcy5pbnRlcnNlY3Rpb25SYXRpbyA9IGludGVyc2VjdGlvbkFyZWEgLyB0YXJnZXRBcmVhO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgLy8gSWYgYXJlYSBpcyB6ZXJvIGFuZCBpcyBpbnRlcnNlY3RpbmcsIHNldHMgdG8gMSwgb3RoZXJ3aXNlIHRvIDBcclxuICAgICAgdGhpcy5pbnRlcnNlY3Rpb25SYXRpbyA9IHRoaXMuaXNJbnRlcnNlY3RpbmcgPyAxIDogMDtcclxuICAgIH1cclxuICB9XHJcblxyXG5cclxuICAvKipcclxuICAgKiBDcmVhdGVzIHRoZSBnbG9iYWwgSW50ZXJzZWN0aW9uT2JzZXJ2ZXIgY29uc3RydWN0b3IuXHJcbiAgICogaHR0cHM6Ly93M2MuZ2l0aHViLmlvL0ludGVyc2VjdGlvbk9ic2VydmVyLyNpbnRlcnNlY3Rpb24tb2JzZXJ2ZXItaW50ZXJmYWNlXHJcbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2sgVGhlIGZ1bmN0aW9uIHRvIGJlIGludm9rZWQgYWZ0ZXIgaW50ZXJzZWN0aW9uXHJcbiAgICogICAgIGNoYW5nZXMgaGF2ZSBxdWV1ZWQuIFRoZSBmdW5jdGlvbiBpcyBub3QgaW52b2tlZCBpZiB0aGUgcXVldWUgaGFzXHJcbiAgICogICAgIGJlZW4gZW1wdGllZCBieSBjYWxsaW5nIHRoZSBgdGFrZVJlY29yZHNgIG1ldGhvZC5cclxuICAgKiBAcGFyYW0ge09iamVjdD19IG9wdF9vcHRpb25zIE9wdGlvbmFsIGNvbmZpZ3VyYXRpb24gb3B0aW9ucy5cclxuICAgKiBAY29uc3RydWN0b3JcclxuICAgKi9cclxuICBmdW5jdGlvbiBJbnRlcnNlY3Rpb25PYnNlcnZlcihjYWxsYmFjaywgb3B0X29wdGlvbnMpIHtcclxuXHJcbiAgICB2YXIgb3B0aW9ucyA9IG9wdF9vcHRpb25zIHx8IHt9O1xyXG5cclxuICAgIGlmICh0eXBlb2YgY2FsbGJhY2sgIT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ2NhbGxiYWNrIG11c3QgYmUgYSBmdW5jdGlvbicpO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChvcHRpb25zLnJvb3QgJiYgb3B0aW9ucy5yb290Lm5vZGVUeXBlICE9IDEpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdyb290IG11c3QgYmUgYW4gRWxlbWVudCcpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEJpbmRzIGFuZCB0aHJvdHRsZXMgYHRoaXMuX2NoZWNrRm9ySW50ZXJzZWN0aW9uc2AuXHJcbiAgICB0aGlzLl9jaGVja0ZvckludGVyc2VjdGlvbnMgPSB0aHJvdHRsZShcclxuICAgICAgdGhpcy5fY2hlY2tGb3JJbnRlcnNlY3Rpb25zLmJpbmQodGhpcyksIHRoaXMuVEhST1RUTEVfVElNRU9VVCk7XHJcblxyXG4gICAgLy8gUHJpdmF0ZSBwcm9wZXJ0aWVzLlxyXG4gICAgdGhpcy5fY2FsbGJhY2sgPSBjYWxsYmFjaztcclxuICAgIHRoaXMuX29ic2VydmF0aW9uVGFyZ2V0cyA9IFtdO1xyXG4gICAgdGhpcy5fcXVldWVkRW50cmllcyA9IFtdO1xyXG4gICAgdGhpcy5fcm9vdE1hcmdpblZhbHVlcyA9IHRoaXMuX3BhcnNlUm9vdE1hcmdpbihvcHRpb25zLnJvb3RNYXJnaW4pO1xyXG5cclxuICAgIC8vIFB1YmxpYyBwcm9wZXJ0aWVzLlxyXG4gICAgdGhpcy50aHJlc2hvbGRzID0gdGhpcy5faW5pdFRocmVzaG9sZHMob3B0aW9ucy50aHJlc2hvbGQpO1xyXG4gICAgdGhpcy5yb290ID0gb3B0aW9ucy5yb290IHx8IG51bGw7XHJcbiAgICB0aGlzLnJvb3RNYXJnaW4gPSB0aGlzLl9yb290TWFyZ2luVmFsdWVzLm1hcChmdW5jdGlvbihtYXJnaW4pIHtcclxuICAgICAgcmV0dXJuIG1hcmdpbi52YWx1ZSArIG1hcmdpbi51bml0O1xyXG4gICAgfSkuam9pbignICcpO1xyXG4gIH1cclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIFRoZSBtaW5pbXVtIGludGVydmFsIHdpdGhpbiB3aGljaCB0aGUgZG9jdW1lbnQgd2lsbCBiZSBjaGVja2VkIGZvclxyXG4gICAqIGludGVyc2VjdGlvbiBjaGFuZ2VzLlxyXG4gICAqL1xyXG4gIEludGVyc2VjdGlvbk9ic2VydmVyLnByb3RvdHlwZS5USFJPVFRMRV9USU1FT1VUID0gMTAwO1xyXG5cclxuXHJcbiAgLyoqXHJcbiAgICogVGhlIGZyZXF1ZW5jeSBpbiB3aGljaCB0aGUgcG9seWZpbGwgcG9sbHMgZm9yIGludGVyc2VjdGlvbiBjaGFuZ2VzLlxyXG4gICAqIHRoaXMgY2FuIGJlIHVwZGF0ZWQgb24gYSBwZXIgaW5zdGFuY2UgYmFzaXMgYW5kIG11c3QgYmUgc2V0IHByaW9yIHRvXHJcbiAgICogY2FsbGluZyBgb2JzZXJ2ZWAgb24gdGhlIGZpcnN0IHRhcmdldC5cclxuICAgKi9cclxuICBJbnRlcnNlY3Rpb25PYnNlcnZlci5wcm90b3R5cGUuUE9MTF9JTlRFUlZBTCA9IG51bGw7XHJcblxyXG4gIC8qKlxyXG4gICAqIFVzZSBhIG11dGF0aW9uIG9ic2VydmVyIG9uIHRoZSByb290IGVsZW1lbnRcclxuICAgKiB0byBkZXRlY3QgaW50ZXJzZWN0aW9uIGNoYW5nZXMuXHJcbiAgICovXHJcbiAgSW50ZXJzZWN0aW9uT2JzZXJ2ZXIucHJvdG90eXBlLlVTRV9NVVRBVElPTl9PQlNFUlZFUiA9IHRydWU7XHJcblxyXG5cclxuICAvKipcclxuICAgKiBTdGFydHMgb2JzZXJ2aW5nIGEgdGFyZ2V0IGVsZW1lbnQgZm9yIGludGVyc2VjdGlvbiBjaGFuZ2VzIGJhc2VkIG9uXHJcbiAgICogdGhlIHRocmVzaG9sZHMgdmFsdWVzLlxyXG4gICAqIEBwYXJhbSB7RWxlbWVudH0gdGFyZ2V0IFRoZSBET00gZWxlbWVudCB0byBvYnNlcnZlLlxyXG4gICAqL1xyXG4gIEludGVyc2VjdGlvbk9ic2VydmVyLnByb3RvdHlwZS5vYnNlcnZlID0gZnVuY3Rpb24odGFyZ2V0KSB7XHJcbiAgICB2YXIgaXNUYXJnZXRBbHJlYWR5T2JzZXJ2ZWQgPSB0aGlzLl9vYnNlcnZhdGlvblRhcmdldHMuc29tZShmdW5jdGlvbihpdGVtKSB7XHJcbiAgICAgIHJldHVybiBpdGVtLmVsZW1lbnQgPT0gdGFyZ2V0O1xyXG4gICAgfSk7XHJcblxyXG4gICAgaWYgKGlzVGFyZ2V0QWxyZWFkeU9ic2VydmVkKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoISh0YXJnZXQgJiYgdGFyZ2V0Lm5vZGVUeXBlID09IDEpKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcigndGFyZ2V0IG11c3QgYmUgYW4gRWxlbWVudCcpO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuX3JlZ2lzdGVySW5zdGFuY2UoKTtcclxuICAgIHRoaXMuX29ic2VydmF0aW9uVGFyZ2V0cy5wdXNoKHtcclxuICAgICAgZWxlbWVudDogdGFyZ2V0LFxyXG4gICAgICBlbnRyeTogbnVsbFxyXG4gICAgfSk7XHJcbiAgICB0aGlzLl9tb25pdG9ySW50ZXJzZWN0aW9ucygpO1xyXG4gICAgdGhpcy5fY2hlY2tGb3JJbnRlcnNlY3Rpb25zKCk7XHJcbiAgfTtcclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIFN0b3BzIG9ic2VydmluZyBhIHRhcmdldCBlbGVtZW50IGZvciBpbnRlcnNlY3Rpb24gY2hhbmdlcy5cclxuICAgKiBAcGFyYW0ge0VsZW1lbnR9IHRhcmdldCBUaGUgRE9NIGVsZW1lbnQgdG8gb2JzZXJ2ZS5cclxuICAgKi9cclxuICBJbnRlcnNlY3Rpb25PYnNlcnZlci5wcm90b3R5cGUudW5vYnNlcnZlID0gZnVuY3Rpb24odGFyZ2V0KSB7XHJcbiAgICB0aGlzLl9vYnNlcnZhdGlvblRhcmdldHMgPVxyXG4gICAgICB0aGlzLl9vYnNlcnZhdGlvblRhcmdldHMuZmlsdGVyKGZ1bmN0aW9uKGl0ZW0pIHtcclxuXHJcbiAgICAgICAgcmV0dXJuIGl0ZW0uZWxlbWVudCAhPSB0YXJnZXQ7XHJcbiAgICAgIH0pO1xyXG4gICAgaWYgKCF0aGlzLl9vYnNlcnZhdGlvblRhcmdldHMubGVuZ3RoKSB7XHJcbiAgICAgIHRoaXMuX3VubW9uaXRvckludGVyc2VjdGlvbnMoKTtcclxuICAgICAgdGhpcy5fdW5yZWdpc3Rlckluc3RhbmNlKCk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIFN0b3BzIG9ic2VydmluZyBhbGwgdGFyZ2V0IGVsZW1lbnRzIGZvciBpbnRlcnNlY3Rpb24gY2hhbmdlcy5cclxuICAgKi9cclxuICBJbnRlcnNlY3Rpb25PYnNlcnZlci5wcm90b3R5cGUuZGlzY29ubmVjdCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgdGhpcy5fb2JzZXJ2YXRpb25UYXJnZXRzID0gW107XHJcbiAgICB0aGlzLl91bm1vbml0b3JJbnRlcnNlY3Rpb25zKCk7XHJcbiAgICB0aGlzLl91bnJlZ2lzdGVySW5zdGFuY2UoKTtcclxuICB9O1xyXG5cclxuXHJcbiAgLyoqXHJcbiAgICogUmV0dXJucyBhbnkgcXVldWUgZW50cmllcyB0aGF0IGhhdmUgbm90IHlldCBiZWVuIHJlcG9ydGVkIHRvIHRoZVxyXG4gICAqIGNhbGxiYWNrIGFuZCBjbGVhcnMgdGhlIHF1ZXVlLiBUaGlzIGNhbiBiZSB1c2VkIGluIGNvbmp1bmN0aW9uIHdpdGggdGhlXHJcbiAgICogY2FsbGJhY2sgdG8gb2J0YWluIHRoZSBhYnNvbHV0ZSBtb3N0IHVwLXRvLWRhdGUgaW50ZXJzZWN0aW9uIGluZm9ybWF0aW9uLlxyXG4gICAqIEByZXR1cm4ge0FycmF5fSBUaGUgY3VycmVudGx5IHF1ZXVlZCBlbnRyaWVzLlxyXG4gICAqL1xyXG4gIEludGVyc2VjdGlvbk9ic2VydmVyLnByb3RvdHlwZS50YWtlUmVjb3JkcyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIHJlY29yZHMgPSB0aGlzLl9xdWV1ZWRFbnRyaWVzLnNsaWNlKCk7XHJcbiAgICB0aGlzLl9xdWV1ZWRFbnRyaWVzID0gW107XHJcbiAgICByZXR1cm4gcmVjb3JkcztcclxuICB9O1xyXG5cclxuXHJcbiAgLyoqXHJcbiAgICogQWNjZXB0cyB0aGUgdGhyZXNob2xkIHZhbHVlIGZyb20gdGhlIHVzZXIgY29uZmlndXJhdGlvbiBvYmplY3QgYW5kXHJcbiAgICogcmV0dXJucyBhIHNvcnRlZCBhcnJheSBvZiB1bmlxdWUgdGhyZXNob2xkIHZhbHVlcy4gSWYgYSB2YWx1ZSBpcyBub3RcclxuICAgKiBiZXR3ZWVuIDAgYW5kIDEgYW5kIGVycm9yIGlzIHRocm93bi5cclxuICAgKiBAcHJpdmF0ZVxyXG4gICAqIEBwYXJhbSB7QXJyYXl8bnVtYmVyPX0gb3B0X3RocmVzaG9sZCBBbiBvcHRpb25hbCB0aHJlc2hvbGQgdmFsdWUgb3JcclxuICAgKiAgICAgYSBsaXN0IG9mIHRocmVzaG9sZCB2YWx1ZXMsIGRlZmF1bHRpbmcgdG8gWzBdLlxyXG4gICAqIEByZXR1cm4ge0FycmF5fSBBIHNvcnRlZCBsaXN0IG9mIHVuaXF1ZSBhbmQgdmFsaWQgdGhyZXNob2xkIHZhbHVlcy5cclxuICAgKi9cclxuICBJbnRlcnNlY3Rpb25PYnNlcnZlci5wcm90b3R5cGUuX2luaXRUaHJlc2hvbGRzID0gZnVuY3Rpb24ob3B0X3RocmVzaG9sZCkge1xyXG4gICAgdmFyIHRocmVzaG9sZCA9IG9wdF90aHJlc2hvbGQgfHwgWzBdO1xyXG4gICAgaWYgKCFBcnJheS5pc0FycmF5KHRocmVzaG9sZCkpIHRocmVzaG9sZCA9IFt0aHJlc2hvbGRdO1xyXG5cclxuICAgIHJldHVybiB0aHJlc2hvbGQuc29ydCgpLmZpbHRlcihmdW5jdGlvbih0LCBpLCBhKSB7XHJcbiAgICAgIGlmICh0eXBlb2YgdCAhPSAnbnVtYmVyJyB8fCBpc05hTih0KSB8fCB0IDwgMCB8fCB0ID4gMSkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcigndGhyZXNob2xkIG11c3QgYmUgYSBudW1iZXIgYmV0d2VlbiAwIGFuZCAxIGluY2x1c2l2ZWx5Jyk7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIHQgIT09IGFbaSAtIDFdO1xyXG4gICAgfSk7XHJcbiAgfTtcclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIEFjY2VwdHMgdGhlIHJvb3RNYXJnaW4gdmFsdWUgZnJvbSB0aGUgdXNlciBjb25maWd1cmF0aW9uIG9iamVjdFxyXG4gICAqIGFuZCByZXR1cm5zIGFuIGFycmF5IG9mIHRoZSBmb3VyIG1hcmdpbiB2YWx1ZXMgYXMgYW4gb2JqZWN0IGNvbnRhaW5pbmdcclxuICAgKiB0aGUgdmFsdWUgYW5kIHVuaXQgcHJvcGVydGllcy4gSWYgYW55IG9mIHRoZSB2YWx1ZXMgYXJlIG5vdCBwcm9wZXJseVxyXG4gICAqIGZvcm1hdHRlZCBvciB1c2UgYSB1bml0IG90aGVyIHRoYW4gcHggb3IgJSwgYW5kIGVycm9yIGlzIHRocm93bi5cclxuICAgKiBAcHJpdmF0ZVxyXG4gICAqIEBwYXJhbSB7c3RyaW5nPX0gb3B0X3Jvb3RNYXJnaW4gQW4gb3B0aW9uYWwgcm9vdE1hcmdpbiB2YWx1ZSxcclxuICAgKiAgICAgZGVmYXVsdGluZyB0byAnMHB4Jy5cclxuICAgKiBAcmV0dXJuIHtBcnJheTxPYmplY3Q+fSBBbiBhcnJheSBvZiBtYXJnaW4gb2JqZWN0cyB3aXRoIHRoZSBrZXlzXHJcbiAgICogICAgIHZhbHVlIGFuZCB1bml0LlxyXG4gICAqL1xyXG4gIEludGVyc2VjdGlvbk9ic2VydmVyLnByb3RvdHlwZS5fcGFyc2VSb290TWFyZ2luID0gZnVuY3Rpb24ob3B0X3Jvb3RNYXJnaW4pIHtcclxuICAgIHZhciBtYXJnaW5TdHJpbmcgPSBvcHRfcm9vdE1hcmdpbiB8fCAnMHB4JztcclxuICAgIHZhciBtYXJnaW5zID0gbWFyZ2luU3RyaW5nLnNwbGl0KC9cXHMrLykubWFwKGZ1bmN0aW9uKG1hcmdpbikge1xyXG4gICAgICB2YXIgcGFydHMgPSAvXigtP1xcZCpcXC4/XFxkKykocHh8JSkkLy5leGVjKG1hcmdpbik7XHJcbiAgICAgIGlmICghcGFydHMpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ3Jvb3RNYXJnaW4gbXVzdCBiZSBzcGVjaWZpZWQgaW4gcGl4ZWxzIG9yIHBlcmNlbnQnKTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHZhbHVlOiBwYXJzZUZsb2F0KHBhcnRzWzFdKSxcclxuICAgICAgICB1bml0OiBwYXJ0c1syXVxyXG4gICAgICB9O1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gSGFuZGxlcyBzaG9ydGhhbmQuXHJcbiAgICBtYXJnaW5zWzFdID0gbWFyZ2luc1sxXSB8fCBtYXJnaW5zWzBdO1xyXG4gICAgbWFyZ2luc1syXSA9IG1hcmdpbnNbMl0gfHwgbWFyZ2luc1swXTtcclxuICAgIG1hcmdpbnNbM10gPSBtYXJnaW5zWzNdIHx8IG1hcmdpbnNbMV07XHJcblxyXG4gICAgcmV0dXJuIG1hcmdpbnM7XHJcbiAgfTtcclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIFN0YXJ0cyBwb2xsaW5nIGZvciBpbnRlcnNlY3Rpb24gY2hhbmdlcyBpZiB0aGUgcG9sbGluZyBpcyBub3QgYWxyZWFkeVxyXG4gICAqIGhhcHBlbmluZywgYW5kIGlmIHRoZSBwYWdlJ3MgdmlzaWJpbHR5IHN0YXRlIGlzIHZpc2libGUuXHJcbiAgICogQHByaXZhdGVcclxuICAgKi9cclxuICBJbnRlcnNlY3Rpb25PYnNlcnZlci5wcm90b3R5cGUuX21vbml0b3JJbnRlcnNlY3Rpb25zID0gZnVuY3Rpb24oKSB7XHJcbiAgICBpZiAoIXRoaXMuX21vbml0b3JpbmdJbnRlcnNlY3Rpb25zKSB7XHJcbiAgICAgIHRoaXMuX21vbml0b3JpbmdJbnRlcnNlY3Rpb25zID0gdHJ1ZTtcclxuXHJcbiAgICAgIC8vIElmIGEgcG9sbCBpbnRlcnZhbCBpcyBzZXQsIHVzZSBwb2xsaW5nIGluc3RlYWQgb2YgbGlzdGVuaW5nIHRvXHJcbiAgICAgIC8vIHJlc2l6ZSBhbmQgc2Nyb2xsIGV2ZW50cyBvciBET00gbXV0YXRpb25zLlxyXG4gICAgICBpZiAodGhpcy5QT0xMX0lOVEVSVkFMKSB7XHJcbiAgICAgICAgdGhpcy5fbW9uaXRvcmluZ0ludGVydmFsID0gc2V0SW50ZXJ2YWwoXHJcbiAgICAgICAgICB0aGlzLl9jaGVja0ZvckludGVyc2VjdGlvbnMsIHRoaXMuUE9MTF9JTlRFUlZBTCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgYWRkRXZlbnQod2luZG93LCAncmVzaXplJywgdGhpcy5fY2hlY2tGb3JJbnRlcnNlY3Rpb25zLCB0cnVlKTtcclxuICAgICAgICBhZGRFdmVudChkb2N1bWVudCwgJ3Njcm9sbCcsIHRoaXMuX2NoZWNrRm9ySW50ZXJzZWN0aW9ucywgdHJ1ZSk7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLlVTRV9NVVRBVElPTl9PQlNFUlZFUiAmJiAnTXV0YXRpb25PYnNlcnZlcicgaW4gd2luZG93KSB7XHJcbiAgICAgICAgICB0aGlzLl9kb21PYnNlcnZlciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKHRoaXMuX2NoZWNrRm9ySW50ZXJzZWN0aW9ucyk7XHJcbiAgICAgICAgICB0aGlzLl9kb21PYnNlcnZlci5vYnNlcnZlKGRvY3VtZW50LCB7XHJcbiAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHRydWUsXHJcbiAgICAgICAgICAgIGNoaWxkTGlzdDogdHJ1ZSxcclxuICAgICAgICAgICAgY2hhcmFjdGVyRGF0YTogdHJ1ZSxcclxuICAgICAgICAgICAgc3VidHJlZTogdHJ1ZVxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIFN0b3BzIHBvbGxpbmcgZm9yIGludGVyc2VjdGlvbiBjaGFuZ2VzLlxyXG4gICAqIEBwcml2YXRlXHJcbiAgICovXHJcbiAgSW50ZXJzZWN0aW9uT2JzZXJ2ZXIucHJvdG90eXBlLl91bm1vbml0b3JJbnRlcnNlY3Rpb25zID0gZnVuY3Rpb24oKSB7XHJcbiAgICBpZiAodGhpcy5fbW9uaXRvcmluZ0ludGVyc2VjdGlvbnMpIHtcclxuICAgICAgdGhpcy5fbW9uaXRvcmluZ0ludGVyc2VjdGlvbnMgPSBmYWxzZTtcclxuXHJcbiAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5fbW9uaXRvcmluZ0ludGVydmFsKTtcclxuICAgICAgdGhpcy5fbW9uaXRvcmluZ0ludGVydmFsID0gbnVsbDtcclxuXHJcbiAgICAgIHJlbW92ZUV2ZW50KHdpbmRvdywgJ3Jlc2l6ZScsIHRoaXMuX2NoZWNrRm9ySW50ZXJzZWN0aW9ucywgdHJ1ZSk7XHJcbiAgICAgIHJlbW92ZUV2ZW50KGRvY3VtZW50LCAnc2Nyb2xsJywgdGhpcy5fY2hlY2tGb3JJbnRlcnNlY3Rpb25zLCB0cnVlKTtcclxuXHJcbiAgICAgIGlmICh0aGlzLl9kb21PYnNlcnZlcikge1xyXG4gICAgICAgIHRoaXMuX2RvbU9ic2VydmVyLmRpc2Nvbm5lY3QoKTtcclxuICAgICAgICB0aGlzLl9kb21PYnNlcnZlciA9IG51bGw7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9O1xyXG5cclxuXHJcbiAgLyoqXHJcbiAgICogU2NhbnMgZWFjaCBvYnNlcnZhdGlvbiB0YXJnZXQgZm9yIGludGVyc2VjdGlvbiBjaGFuZ2VzIGFuZCBhZGRzIHRoZW1cclxuICAgKiB0byB0aGUgaW50ZXJuYWwgZW50cmllcyBxdWV1ZS4gSWYgbmV3IGVudHJpZXMgYXJlIGZvdW5kLCBpdFxyXG4gICAqIHNjaGVkdWxlcyB0aGUgY2FsbGJhY2sgdG8gYmUgaW52b2tlZC5cclxuICAgKiBAcHJpdmF0ZVxyXG4gICAqL1xyXG4gIEludGVyc2VjdGlvbk9ic2VydmVyLnByb3RvdHlwZS5fY2hlY2tGb3JJbnRlcnNlY3Rpb25zID0gZnVuY3Rpb24oKSB7XHJcbiAgICB2YXIgcm9vdElzSW5Eb20gPSB0aGlzLl9yb290SXNJbkRvbSgpO1xyXG4gICAgdmFyIHJvb3RSZWN0ID0gcm9vdElzSW5Eb20gPyB0aGlzLl9nZXRSb290UmVjdCgpIDogZ2V0RW1wdHlSZWN0KCk7XHJcblxyXG4gICAgdGhpcy5fb2JzZXJ2YXRpb25UYXJnZXRzLmZvckVhY2goZnVuY3Rpb24oaXRlbSkge1xyXG4gICAgICB2YXIgdGFyZ2V0ID0gaXRlbS5lbGVtZW50O1xyXG4gICAgICB2YXIgdGFyZ2V0UmVjdCA9IGdldEJvdW5kaW5nQ2xpZW50UmVjdCh0YXJnZXQpO1xyXG4gICAgICB2YXIgcm9vdENvbnRhaW5zVGFyZ2V0ID0gdGhpcy5fcm9vdENvbnRhaW5zVGFyZ2V0KHRhcmdldCk7XHJcbiAgICAgIHZhciBvbGRFbnRyeSA9IGl0ZW0uZW50cnk7XHJcbiAgICAgIHZhciBpbnRlcnNlY3Rpb25SZWN0ID0gcm9vdElzSW5Eb20gJiYgcm9vdENvbnRhaW5zVGFyZ2V0ICYmXHJcbiAgICAgICAgdGhpcy5fY29tcHV0ZVRhcmdldEFuZFJvb3RJbnRlcnNlY3Rpb24odGFyZ2V0LCByb290UmVjdCk7XHJcblxyXG4gICAgICB2YXIgbmV3RW50cnkgPSBpdGVtLmVudHJ5ID0gbmV3IEludGVyc2VjdGlvbk9ic2VydmVyRW50cnkoe1xyXG4gICAgICAgIHRpbWU6IG5vdygpLFxyXG4gICAgICAgIHRhcmdldDogdGFyZ2V0LFxyXG4gICAgICAgIGJvdW5kaW5nQ2xpZW50UmVjdDogdGFyZ2V0UmVjdCxcclxuICAgICAgICByb290Qm91bmRzOiByb290UmVjdCxcclxuICAgICAgICBpbnRlcnNlY3Rpb25SZWN0OiBpbnRlcnNlY3Rpb25SZWN0XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgaWYgKCFvbGRFbnRyeSkge1xyXG4gICAgICAgIHRoaXMuX3F1ZXVlZEVudHJpZXMucHVzaChuZXdFbnRyeSk7XHJcbiAgICAgIH0gZWxzZSBpZiAocm9vdElzSW5Eb20gJiYgcm9vdENvbnRhaW5zVGFyZ2V0KSB7XHJcbiAgICAgICAgLy8gSWYgdGhlIG5ldyBlbnRyeSBpbnRlcnNlY3Rpb24gcmF0aW8gaGFzIGNyb3NzZWQgYW55IG9mIHRoZVxyXG4gICAgICAgIC8vIHRocmVzaG9sZHMsIGFkZCBhIG5ldyBlbnRyeS5cclxuICAgICAgICBpZiAodGhpcy5faGFzQ3Jvc3NlZFRocmVzaG9sZChvbGRFbnRyeSwgbmV3RW50cnkpKSB7XHJcbiAgICAgICAgICB0aGlzLl9xdWV1ZWRFbnRyaWVzLnB1c2gobmV3RW50cnkpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAvLyBJZiB0aGUgcm9vdCBpcyBub3QgaW4gdGhlIERPTSBvciB0YXJnZXQgaXMgbm90IGNvbnRhaW5lZCB3aXRoaW5cclxuICAgICAgICAvLyByb290IGJ1dCB0aGUgcHJldmlvdXMgZW50cnkgZm9yIHRoaXMgdGFyZ2V0IGhhZCBhbiBpbnRlcnNlY3Rpb24sXHJcbiAgICAgICAgLy8gYWRkIGEgbmV3IHJlY29yZCBpbmRpY2F0aW5nIHJlbW92YWwuXHJcbiAgICAgICAgaWYgKG9sZEVudHJ5ICYmIG9sZEVudHJ5LmlzSW50ZXJzZWN0aW5nKSB7XHJcbiAgICAgICAgICB0aGlzLl9xdWV1ZWRFbnRyaWVzLnB1c2gobmV3RW50cnkpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSwgdGhpcyk7XHJcblxyXG4gICAgaWYgKHRoaXMuX3F1ZXVlZEVudHJpZXMubGVuZ3RoKSB7XHJcbiAgICAgIHRoaXMuX2NhbGxiYWNrKHRoaXMudGFrZVJlY29yZHMoKSwgdGhpcyk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIEFjY2VwdHMgYSB0YXJnZXQgYW5kIHJvb3QgcmVjdCBjb21wdXRlcyB0aGUgaW50ZXJzZWN0aW9uIGJldHdlZW4gdGhlblxyXG4gICAqIGZvbGxvd2luZyB0aGUgYWxnb3JpdGhtIGluIHRoZSBzcGVjLlxyXG4gICAqIFRPRE8ocGhpbGlwd2FsdG9uKTogYXQgdGhpcyB0aW1lIGNsaXAtcGF0aCBpcyBub3QgY29uc2lkZXJlZC5cclxuICAgKiBodHRwczovL3czYy5naXRodWIuaW8vSW50ZXJzZWN0aW9uT2JzZXJ2ZXIvI2NhbGN1bGF0ZS1pbnRlcnNlY3Rpb24tcmVjdC1hbGdvXHJcbiAgICogQHBhcmFtIHtFbGVtZW50fSB0YXJnZXQgVGhlIHRhcmdldCBET00gZWxlbWVudFxyXG4gICAqIEBwYXJhbSB7T2JqZWN0fSByb290UmVjdCBUaGUgYm91bmRpbmcgcmVjdCBvZiB0aGUgcm9vdCBhZnRlciBiZWluZ1xyXG4gICAqICAgICBleHBhbmRlZCBieSB0aGUgcm9vdE1hcmdpbiB2YWx1ZS5cclxuICAgKiBAcmV0dXJuIHs/T2JqZWN0fSBUaGUgZmluYWwgaW50ZXJzZWN0aW9uIHJlY3Qgb2JqZWN0IG9yIHVuZGVmaW5lZCBpZiBub1xyXG4gICAqICAgICBpbnRlcnNlY3Rpb24gaXMgZm91bmQuXHJcbiAgICogQHByaXZhdGVcclxuICAgKi9cclxuICBJbnRlcnNlY3Rpb25PYnNlcnZlci5wcm90b3R5cGUuX2NvbXB1dGVUYXJnZXRBbmRSb290SW50ZXJzZWN0aW9uID1cclxuICAgIGZ1bmN0aW9uKHRhcmdldCwgcm9vdFJlY3QpIHtcclxuXHJcbiAgICAgIC8vIElmIHRoZSBlbGVtZW50IGlzbid0IGRpc3BsYXllZCwgYW4gaW50ZXJzZWN0aW9uIGNhbid0IGhhcHBlbi5cclxuICAgICAgaWYgKHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHRhcmdldCkuZGlzcGxheSA9PSAnbm9uZScpIHJldHVybjtcclxuXHJcbiAgICAgIHZhciB0YXJnZXRSZWN0ID0gZ2V0Qm91bmRpbmdDbGllbnRSZWN0KHRhcmdldCk7XHJcbiAgICAgIHZhciBpbnRlcnNlY3Rpb25SZWN0ID0gdGFyZ2V0UmVjdDtcclxuICAgICAgdmFyIHBhcmVudCA9IGdldFBhcmVudE5vZGUodGFyZ2V0KTtcclxuICAgICAgdmFyIGF0Um9vdCA9IGZhbHNlO1xyXG5cclxuICAgICAgd2hpbGUgKCFhdFJvb3QpIHtcclxuICAgICAgICB2YXIgcGFyZW50UmVjdCA9IG51bGw7XHJcbiAgICAgICAgdmFyIHBhcmVudENvbXB1dGVkU3R5bGUgPSBwYXJlbnQubm9kZVR5cGUgPT0gMSA/XHJcbiAgICAgICAgICB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShwYXJlbnQpIDoge307XHJcblxyXG4gICAgICAgIC8vIElmIHRoZSBwYXJlbnQgaXNuJ3QgZGlzcGxheWVkLCBhbiBpbnRlcnNlY3Rpb24gY2FuJ3QgaGFwcGVuLlxyXG4gICAgICAgIGlmIChwYXJlbnRDb21wdXRlZFN0eWxlLmRpc3BsYXkgPT0gJ25vbmUnKSByZXR1cm47XHJcblxyXG4gICAgICAgIGlmIChwYXJlbnQgPT0gdGhpcy5yb290IHx8IHBhcmVudCA9PSBkb2N1bWVudCkge1xyXG4gICAgICAgICAgYXRSb290ID0gdHJ1ZTtcclxuICAgICAgICAgIHBhcmVudFJlY3QgPSByb290UmVjdDtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgLy8gSWYgdGhlIGVsZW1lbnQgaGFzIGEgbm9uLXZpc2libGUgb3ZlcmZsb3csIGFuZCBpdCdzIG5vdCB0aGUgPGJvZHk+XHJcbiAgICAgICAgICAvLyBvciA8aHRtbD4gZWxlbWVudCwgdXBkYXRlIHRoZSBpbnRlcnNlY3Rpb24gcmVjdC5cclxuICAgICAgICAgIC8vIE5vdGU6IDxib2R5PiBhbmQgPGh0bWw+IGNhbm5vdCBiZSBjbGlwcGVkIHRvIGEgcmVjdCB0aGF0J3Mgbm90IGFsc29cclxuICAgICAgICAgIC8vIHRoZSBkb2N1bWVudCByZWN0LCBzbyBubyBuZWVkIHRvIGNvbXB1dGUgYSBuZXcgaW50ZXJzZWN0aW9uLlxyXG4gICAgICAgICAgaWYgKHBhcmVudCAhPSBkb2N1bWVudC5ib2R5ICYmXHJcbiAgICAgICAgICAgIHBhcmVudCAhPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQgJiZcclxuICAgICAgICAgICAgcGFyZW50Q29tcHV0ZWRTdHlsZS5vdmVyZmxvdyAhPSAndmlzaWJsZScpIHtcclxuICAgICAgICAgICAgcGFyZW50UmVjdCA9IGdldEJvdW5kaW5nQ2xpZW50UmVjdChwYXJlbnQpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gSWYgZWl0aGVyIG9mIHRoZSBhYm92ZSBjb25kaXRpb25hbHMgc2V0IGEgbmV3IHBhcmVudFJlY3QsXHJcbiAgICAgICAgLy8gY2FsY3VsYXRlIG5ldyBpbnRlcnNlY3Rpb24gZGF0YS5cclxuICAgICAgICBpZiAocGFyZW50UmVjdCkge1xyXG4gICAgICAgICAgaW50ZXJzZWN0aW9uUmVjdCA9IGNvbXB1dGVSZWN0SW50ZXJzZWN0aW9uKHBhcmVudFJlY3QsIGludGVyc2VjdGlvblJlY3QpO1xyXG5cclxuICAgICAgICAgIGlmICghaW50ZXJzZWN0aW9uUmVjdCkgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHBhcmVudCA9IGdldFBhcmVudE5vZGUocGFyZW50KTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gaW50ZXJzZWN0aW9uUmVjdDtcclxuICAgIH07XHJcblxyXG5cclxuICAvKipcclxuICAgKiBSZXR1cm5zIHRoZSByb290IHJlY3QgYWZ0ZXIgYmVpbmcgZXhwYW5kZWQgYnkgdGhlIHJvb3RNYXJnaW4gdmFsdWUuXHJcbiAgICogQHJldHVybiB7T2JqZWN0fSBUaGUgZXhwYW5kZWQgcm9vdCByZWN0LlxyXG4gICAqIEBwcml2YXRlXHJcbiAgICovXHJcbiAgSW50ZXJzZWN0aW9uT2JzZXJ2ZXIucHJvdG90eXBlLl9nZXRSb290UmVjdCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIHJvb3RSZWN0O1xyXG4gICAgaWYgKHRoaXMucm9vdCkge1xyXG4gICAgICByb290UmVjdCA9IGdldEJvdW5kaW5nQ2xpZW50UmVjdCh0aGlzLnJvb3QpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgLy8gVXNlIDxodG1sPi88Ym9keT4gaW5zdGVhZCBvZiB3aW5kb3cgc2luY2Ugc2Nyb2xsIGJhcnMgYWZmZWN0IHNpemUuXHJcbiAgICAgIHZhciBodG1sID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50O1xyXG4gICAgICB2YXIgYm9keSA9IGRvY3VtZW50LmJvZHk7XHJcbiAgICAgIHJvb3RSZWN0ID0ge1xyXG4gICAgICAgIHRvcDogMCxcclxuICAgICAgICBsZWZ0OiAwLFxyXG4gICAgICAgIHJpZ2h0OiBodG1sLmNsaWVudFdpZHRoIHx8IGJvZHkuY2xpZW50V2lkdGgsXHJcbiAgICAgICAgd2lkdGg6IGh0bWwuY2xpZW50V2lkdGggfHwgYm9keS5jbGllbnRXaWR0aCxcclxuICAgICAgICBib3R0b206IGh0bWwuY2xpZW50SGVpZ2h0IHx8IGJvZHkuY2xpZW50SGVpZ2h0LFxyXG4gICAgICAgIGhlaWdodDogaHRtbC5jbGllbnRIZWlnaHQgfHwgYm9keS5jbGllbnRIZWlnaHRcclxuICAgICAgfTtcclxuICAgIH1cclxuICAgIHJldHVybiB0aGlzLl9leHBhbmRSZWN0QnlSb290TWFyZ2luKHJvb3RSZWN0KTtcclxuICB9O1xyXG5cclxuXHJcbiAgLyoqXHJcbiAgICogQWNjZXB0cyBhIHJlY3QgYW5kIGV4cGFuZHMgaXQgYnkgdGhlIHJvb3RNYXJnaW4gdmFsdWUuXHJcbiAgICogQHBhcmFtIHtPYmplY3R9IHJlY3QgVGhlIHJlY3Qgb2JqZWN0IHRvIGV4cGFuZC5cclxuICAgKiBAcmV0dXJuIHtPYmplY3R9IFRoZSBleHBhbmRlZCByZWN0LlxyXG4gICAqIEBwcml2YXRlXHJcbiAgICovXHJcbiAgSW50ZXJzZWN0aW9uT2JzZXJ2ZXIucHJvdG90eXBlLl9leHBhbmRSZWN0QnlSb290TWFyZ2luID0gZnVuY3Rpb24ocmVjdCkge1xyXG4gICAgdmFyIG1hcmdpbnMgPSB0aGlzLl9yb290TWFyZ2luVmFsdWVzLm1hcChmdW5jdGlvbihtYXJnaW4sIGkpIHtcclxuICAgICAgcmV0dXJuIG1hcmdpbi51bml0ID09ICdweCcgPyBtYXJnaW4udmFsdWUgOlxyXG4gICAgICAgIG1hcmdpbi52YWx1ZSAqIChpICUgMiA/IHJlY3Qud2lkdGggOiByZWN0LmhlaWdodCkgLyAxMDA7XHJcbiAgICB9KTtcclxuICAgIHZhciBuZXdSZWN0ID0ge1xyXG4gICAgICB0b3A6IHJlY3QudG9wIC0gbWFyZ2luc1swXSxcclxuICAgICAgcmlnaHQ6IHJlY3QucmlnaHQgKyBtYXJnaW5zWzFdLFxyXG4gICAgICBib3R0b206IHJlY3QuYm90dG9tICsgbWFyZ2luc1syXSxcclxuICAgICAgbGVmdDogcmVjdC5sZWZ0IC0gbWFyZ2luc1szXVxyXG4gICAgfTtcclxuICAgIG5ld1JlY3Qud2lkdGggPSBuZXdSZWN0LnJpZ2h0IC0gbmV3UmVjdC5sZWZ0O1xyXG4gICAgbmV3UmVjdC5oZWlnaHQgPSBuZXdSZWN0LmJvdHRvbSAtIG5ld1JlY3QudG9wO1xyXG5cclxuICAgIHJldHVybiBuZXdSZWN0O1xyXG4gIH07XHJcblxyXG5cclxuICAvKipcclxuICAgKiBBY2NlcHRzIGFuIG9sZCBhbmQgbmV3IGVudHJ5IGFuZCByZXR1cm5zIHRydWUgaWYgYXQgbGVhc3Qgb25lIG9mIHRoZVxyXG4gICAqIHRocmVzaG9sZCB2YWx1ZXMgaGFzIGJlZW4gY3Jvc3NlZC5cclxuICAgKiBAcGFyYW0gez9JbnRlcnNlY3Rpb25PYnNlcnZlckVudHJ5fSBvbGRFbnRyeSBUaGUgcHJldmlvdXMgZW50cnkgZm9yIGFcclxuICAgKiAgICBwYXJ0aWN1bGFyIHRhcmdldCBlbGVtZW50IG9yIG51bGwgaWYgbm8gcHJldmlvdXMgZW50cnkgZXhpc3RzLlxyXG4gICAqIEBwYXJhbSB7SW50ZXJzZWN0aW9uT2JzZXJ2ZXJFbnRyeX0gbmV3RW50cnkgVGhlIGN1cnJlbnQgZW50cnkgZm9yIGFcclxuICAgKiAgICBwYXJ0aWN1bGFyIHRhcmdldCBlbGVtZW50LlxyXG4gICAqIEByZXR1cm4ge2Jvb2xlYW59IFJldHVybnMgdHJ1ZSBpZiBhIGFueSB0aHJlc2hvbGQgaGFzIGJlZW4gY3Jvc3NlZC5cclxuICAgKiBAcHJpdmF0ZVxyXG4gICAqL1xyXG4gIEludGVyc2VjdGlvbk9ic2VydmVyLnByb3RvdHlwZS5faGFzQ3Jvc3NlZFRocmVzaG9sZCA9XHJcbiAgICBmdW5jdGlvbihvbGRFbnRyeSwgbmV3RW50cnkpIHtcclxuXHJcbiAgICAgIC8vIFRvIG1ha2UgY29tcGFyaW5nIGVhc2llciwgYW4gZW50cnkgdGhhdCBoYXMgYSByYXRpbyBvZiAwXHJcbiAgICAgIC8vIGJ1dCBkb2VzIG5vdCBhY3R1YWxseSBpbnRlcnNlY3QgaXMgZ2l2ZW4gYSB2YWx1ZSBvZiAtMVxyXG4gICAgICB2YXIgb2xkUmF0aW8gPSBvbGRFbnRyeSAmJiBvbGRFbnRyeS5pc0ludGVyc2VjdGluZyA/XHJcbiAgICAgICAgb2xkRW50cnkuaW50ZXJzZWN0aW9uUmF0aW8gfHwgMCA6IC0xO1xyXG4gICAgICB2YXIgbmV3UmF0aW8gPSBuZXdFbnRyeS5pc0ludGVyc2VjdGluZyA/XHJcbiAgICAgICAgbmV3RW50cnkuaW50ZXJzZWN0aW9uUmF0aW8gfHwgMCA6IC0xO1xyXG5cclxuICAgICAgLy8gSWdub3JlIHVuY2hhbmdlZCByYXRpb3NcclxuICAgICAgaWYgKG9sZFJhdGlvID09PSBuZXdSYXRpbykgcmV0dXJuO1xyXG5cclxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnRocmVzaG9sZHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICB2YXIgdGhyZXNob2xkID0gdGhpcy50aHJlc2hvbGRzW2ldO1xyXG5cclxuICAgICAgICAvLyBSZXR1cm4gdHJ1ZSBpZiBhbiBlbnRyeSBtYXRjaGVzIGEgdGhyZXNob2xkIG9yIGlmIHRoZSBuZXcgcmF0aW9cclxuICAgICAgICAvLyBhbmQgdGhlIG9sZCByYXRpbyBhcmUgb24gdGhlIG9wcG9zaXRlIHNpZGVzIG9mIGEgdGhyZXNob2xkLlxyXG4gICAgICAgIGlmICh0aHJlc2hvbGQgPT0gb2xkUmF0aW8gfHwgdGhyZXNob2xkID09IG5ld1JhdGlvIHx8XHJcbiAgICAgICAgICB0aHJlc2hvbGQgPCBvbGRSYXRpbyAhPT0gdGhyZXNob2xkIDwgbmV3UmF0aW8pIHtcclxuICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfTtcclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIFJldHVybnMgd2hldGhlciBvciBub3QgdGhlIHJvb3QgZWxlbWVudCBpcyBhbiBlbGVtZW50IGFuZCBpcyBpbiB0aGUgRE9NLlxyXG4gICAqIEByZXR1cm4ge2Jvb2xlYW59IFRydWUgaWYgdGhlIHJvb3QgZWxlbWVudCBpcyBhbiBlbGVtZW50IGFuZCBpcyBpbiB0aGUgRE9NLlxyXG4gICAqIEBwcml2YXRlXHJcbiAgICovXHJcbiAgSW50ZXJzZWN0aW9uT2JzZXJ2ZXIucHJvdG90eXBlLl9yb290SXNJbkRvbSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgcmV0dXJuICF0aGlzLnJvb3QgfHwgY29udGFpbnNEZWVwKGRvY3VtZW50LCB0aGlzLnJvb3QpO1xyXG4gIH07XHJcblxyXG5cclxuICAvKipcclxuICAgKiBSZXR1cm5zIHdoZXRoZXIgb3Igbm90IHRoZSB0YXJnZXQgZWxlbWVudCBpcyBhIGNoaWxkIG9mIHJvb3QuXHJcbiAgICogQHBhcmFtIHtFbGVtZW50fSB0YXJnZXQgVGhlIHRhcmdldCBlbGVtZW50IHRvIGNoZWNrLlxyXG4gICAqIEByZXR1cm4ge2Jvb2xlYW59IFRydWUgaWYgdGhlIHRhcmdldCBlbGVtZW50IGlzIGEgY2hpbGQgb2Ygcm9vdC5cclxuICAgKiBAcHJpdmF0ZVxyXG4gICAqL1xyXG4gIEludGVyc2VjdGlvbk9ic2VydmVyLnByb3RvdHlwZS5fcm9vdENvbnRhaW5zVGFyZ2V0ID0gZnVuY3Rpb24odGFyZ2V0KSB7XHJcbiAgICByZXR1cm4gY29udGFpbnNEZWVwKHRoaXMucm9vdCB8fCBkb2N1bWVudCwgdGFyZ2V0KTtcclxuICB9O1xyXG5cclxuXHJcbiAgLyoqXHJcbiAgICogQWRkcyB0aGUgaW5zdGFuY2UgdG8gdGhlIGdsb2JhbCBJbnRlcnNlY3Rpb25PYnNlcnZlciByZWdpc3RyeSBpZiBpdCBpc24ndFxyXG4gICAqIGFscmVhZHkgcHJlc2VudC5cclxuICAgKiBAcHJpdmF0ZVxyXG4gICAqL1xyXG4gIEludGVyc2VjdGlvbk9ic2VydmVyLnByb3RvdHlwZS5fcmVnaXN0ZXJJbnN0YW5jZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgaWYgKHJlZ2lzdHJ5LmluZGV4T2YodGhpcykgPCAwKSB7XHJcbiAgICAgIHJlZ2lzdHJ5LnB1c2godGhpcyk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIFJlbW92ZXMgdGhlIGluc3RhbmNlIGZyb20gdGhlIGdsb2JhbCBJbnRlcnNlY3Rpb25PYnNlcnZlciByZWdpc3RyeS5cclxuICAgKiBAcHJpdmF0ZVxyXG4gICAqL1xyXG4gIEludGVyc2VjdGlvbk9ic2VydmVyLnByb3RvdHlwZS5fdW5yZWdpc3Rlckluc3RhbmNlID0gZnVuY3Rpb24oKSB7XHJcbiAgICB2YXIgaW5kZXggPSByZWdpc3RyeS5pbmRleE9mKHRoaXMpO1xyXG4gICAgaWYgKGluZGV4ICE9IC0xKSByZWdpc3RyeS5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gIH07XHJcblxyXG5cclxuICAvKipcclxuICAgKiBSZXR1cm5zIHRoZSByZXN1bHQgb2YgdGhlIHBlcmZvcm1hbmNlLm5vdygpIG1ldGhvZCBvciBudWxsIGluIGJyb3dzZXJzXHJcbiAgICogdGhhdCBkb24ndCBzdXBwb3J0IHRoZSBBUEkuXHJcbiAgICogQHJldHVybiB7bnVtYmVyfSBUaGUgZWxhcHNlZCB0aW1lIHNpbmNlIHRoZSBwYWdlIHdhcyByZXF1ZXN0ZWQuXHJcbiAgICovXHJcbiAgZnVuY3Rpb24gbm93KCkge1xyXG4gICAgcmV0dXJuIHdpbmRvdy5wZXJmb3JtYW5jZSAmJiBwZXJmb3JtYW5jZS5ub3cgJiYgcGVyZm9ybWFuY2Uubm93KCk7XHJcbiAgfVxyXG5cclxuXHJcbiAgLyoqXHJcbiAgICogVGhyb3R0bGVzIGEgZnVuY3Rpb24gYW5kIGRlbGF5cyBpdHMgZXhlY3V0aW9uZywgc28gaXQncyBvbmx5IGNhbGxlZCBhdCBtb3N0XHJcbiAgICogb25jZSB3aXRoaW4gYSBnaXZlbiB0aW1lIHBlcmlvZC5cclxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBUaGUgZnVuY3Rpb24gdG8gdGhyb3R0bGUuXHJcbiAgICogQHBhcmFtIHtudW1iZXJ9IHRpbWVvdXQgVGhlIGFtb3VudCBvZiB0aW1lIHRoYXQgbXVzdCBwYXNzIGJlZm9yZSB0aGVcclxuICAgKiAgICAgZnVuY3Rpb24gY2FuIGJlIGNhbGxlZCBhZ2Fpbi5cclxuICAgKiBAcmV0dXJuIHtGdW5jdGlvbn0gVGhlIHRocm90dGxlZCBmdW5jdGlvbi5cclxuICAgKi9cclxuICBmdW5jdGlvbiB0aHJvdHRsZShmbiwgdGltZW91dCkge1xyXG4gICAgdmFyIHRpbWVyID0gbnVsbDtcclxuICAgIHJldHVybiBmdW5jdGlvbigpIHtcclxuICAgICAgaWYgKCF0aW1lcikge1xyXG4gICAgICAgIHRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgIGZuKCk7XHJcbiAgICAgICAgICB0aW1lciA9IG51bGw7XHJcbiAgICAgICAgfSwgdGltZW91dCk7XHJcbiAgICAgIH1cclxuICAgIH07XHJcbiAgfVxyXG5cclxuXHJcbiAgLyoqXHJcbiAgICogQWRkcyBhbiBldmVudCBoYW5kbGVyIHRvIGEgRE9NIG5vZGUgZW5zdXJpbmcgY3Jvc3MtYnJvd3NlciBjb21wYXRpYmlsaXR5LlxyXG4gICAqIEBwYXJhbSB7Tm9kZX0gbm9kZSBUaGUgRE9NIG5vZGUgdG8gYWRkIHRoZSBldmVudCBoYW5kbGVyIHRvLlxyXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBldmVudCBUaGUgZXZlbnQgbmFtZS5cclxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBUaGUgZXZlbnQgaGFuZGxlciB0byBhZGQuXHJcbiAgICogQHBhcmFtIHtib29sZWFufSBvcHRfdXNlQ2FwdHVyZSBPcHRpb25hbGx5IGFkZHMgdGhlIGV2ZW4gdG8gdGhlIGNhcHR1cmVcclxuICAgKiAgICAgcGhhc2UuIE5vdGU6IHRoaXMgb25seSB3b3JrcyBpbiBtb2Rlcm4gYnJvd3NlcnMuXHJcbiAgICovXHJcbiAgZnVuY3Rpb24gYWRkRXZlbnQobm9kZSwgZXZlbnQsIGZuLCBvcHRfdXNlQ2FwdHVyZSkge1xyXG4gICAgaWYgKHR5cGVvZiBub2RlLmFkZEV2ZW50TGlzdGVuZXIgPT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICBub2RlLmFkZEV2ZW50TGlzdGVuZXIoZXZlbnQsIGZuLCBvcHRfdXNlQ2FwdHVyZSB8fCBmYWxzZSk7XHJcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBub2RlLmF0dGFjaEV2ZW50ID09ICdmdW5jdGlvbicpIHtcclxuICAgICAgbm9kZS5hdHRhY2hFdmVudCgnb24nICsgZXZlbnQsIGZuKTtcclxuICAgIH1cclxuICB9XHJcblxyXG5cclxuICAvKipcclxuICAgKiBSZW1vdmVzIGEgcHJldmlvdXNseSBhZGRlZCBldmVudCBoYW5kbGVyIGZyb20gYSBET00gbm9kZS5cclxuICAgKiBAcGFyYW0ge05vZGV9IG5vZGUgVGhlIERPTSBub2RlIHRvIHJlbW92ZSB0aGUgZXZlbnQgaGFuZGxlciBmcm9tLlxyXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBldmVudCBUaGUgZXZlbnQgbmFtZS5cclxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBUaGUgZXZlbnQgaGFuZGxlciB0byByZW1vdmUuXHJcbiAgICogQHBhcmFtIHtib29sZWFufSBvcHRfdXNlQ2FwdHVyZSBJZiB0aGUgZXZlbnQgaGFuZGxlciB3YXMgYWRkZWQgd2l0aCB0aGlzXHJcbiAgICogICAgIGZsYWcgc2V0IHRvIHRydWUsIGl0IHNob3VsZCBiZSBzZXQgdG8gdHJ1ZSBoZXJlIGluIG9yZGVyIHRvIHJlbW92ZSBpdC5cclxuICAgKi9cclxuICBmdW5jdGlvbiByZW1vdmVFdmVudChub2RlLCBldmVudCwgZm4sIG9wdF91c2VDYXB0dXJlKSB7XHJcbiAgICBpZiAodHlwZW9mIG5vZGUucmVtb3ZlRXZlbnRMaXN0ZW5lciA9PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgIG5vZGUucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudCwgZm4sIG9wdF91c2VDYXB0dXJlIHx8IGZhbHNlKTtcclxuICAgIH0gZWxzZSBpZiAodHlwZW9mIG5vZGUuZGV0YXRjaEV2ZW50ID09ICdmdW5jdGlvbicpIHtcclxuICAgICAgbm9kZS5kZXRhdGNoRXZlbnQoJ29uJyArIGV2ZW50LCBmbik7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuXHJcbiAgLyoqXHJcbiAgICogUmV0dXJucyB0aGUgaW50ZXJzZWN0aW9uIGJldHdlZW4gdHdvIHJlY3Qgb2JqZWN0cy5cclxuICAgKiBAcGFyYW0ge09iamVjdH0gcmVjdDEgVGhlIGZpcnN0IHJlY3QuXHJcbiAgICogQHBhcmFtIHtPYmplY3R9IHJlY3QyIFRoZSBzZWNvbmQgcmVjdC5cclxuICAgKiBAcmV0dXJuIHs/T2JqZWN0fSBUaGUgaW50ZXJzZWN0aW9uIHJlY3Qgb3IgdW5kZWZpbmVkIGlmIG5vIGludGVyc2VjdGlvblxyXG4gICAqICAgICBpcyBmb3VuZC5cclxuICAgKi9cclxuICBmdW5jdGlvbiBjb21wdXRlUmVjdEludGVyc2VjdGlvbihyZWN0MSwgcmVjdDIpIHtcclxuICAgIHZhciB0b3AgPSBNYXRoLm1heChyZWN0MS50b3AsIHJlY3QyLnRvcCk7XHJcbiAgICB2YXIgYm90dG9tID0gTWF0aC5taW4ocmVjdDEuYm90dG9tLCByZWN0Mi5ib3R0b20pO1xyXG4gICAgdmFyIGxlZnQgPSBNYXRoLm1heChyZWN0MS5sZWZ0LCByZWN0Mi5sZWZ0KTtcclxuICAgIHZhciByaWdodCA9IE1hdGgubWluKHJlY3QxLnJpZ2h0LCByZWN0Mi5yaWdodCk7XHJcbiAgICB2YXIgd2lkdGggPSByaWdodCAtIGxlZnQ7XHJcbiAgICB2YXIgaGVpZ2h0ID0gYm90dG9tIC0gdG9wO1xyXG5cclxuICAgIHJldHVybiAod2lkdGggPj0gMCAmJiBoZWlnaHQgPj0gMCkgJiYge1xyXG4gICAgICB0b3A6IHRvcCxcclxuICAgICAgYm90dG9tOiBib3R0b20sXHJcbiAgICAgIGxlZnQ6IGxlZnQsXHJcbiAgICAgIHJpZ2h0OiByaWdodCxcclxuICAgICAgd2lkdGg6IHdpZHRoLFxyXG4gICAgICBoZWlnaHQ6IGhlaWdodFxyXG4gICAgfTtcclxuICB9XHJcblxyXG5cclxuICAvKipcclxuICAgKiBTaGltcyB0aGUgbmF0aXZlIGdldEJvdW5kaW5nQ2xpZW50UmVjdCBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG9sZGVyIElFLlxyXG4gICAqIEBwYXJhbSB7RWxlbWVudH0gZWwgVGhlIGVsZW1lbnQgd2hvc2UgYm91bmRpbmcgcmVjdCB0byBnZXQuXHJcbiAgICogQHJldHVybiB7T2JqZWN0fSBUaGUgKHBvc3NpYmx5IHNoaW1tZWQpIHJlY3Qgb2YgdGhlIGVsZW1lbnQuXHJcbiAgICovXHJcbiAgZnVuY3Rpb24gZ2V0Qm91bmRpbmdDbGllbnRSZWN0KGVsKSB7XHJcbiAgICB2YXIgcmVjdDtcclxuXHJcbiAgICB0cnkge1xyXG4gICAgICByZWN0ID0gZWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgLy8gSWdub3JlIFdpbmRvd3MgNyBJRTExIFwiVW5zcGVjaWZpZWQgZXJyb3JcIlxyXG4gICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vdzNjL0ludGVyc2VjdGlvbk9ic2VydmVyL3B1bGwvMjA1XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKCFyZWN0KSByZXR1cm4gZ2V0RW1wdHlSZWN0KCk7XHJcblxyXG4gICAgLy8gT2xkZXIgSUVcclxuICAgIGlmICghKHJlY3Qud2lkdGggJiYgcmVjdC5oZWlnaHQpKSB7XHJcbiAgICAgIHJlY3QgPSB7XHJcbiAgICAgICAgdG9wOiByZWN0LnRvcCxcclxuICAgICAgICByaWdodDogcmVjdC5yaWdodCxcclxuICAgICAgICBib3R0b206IHJlY3QuYm90dG9tLFxyXG4gICAgICAgIGxlZnQ6IHJlY3QubGVmdCxcclxuICAgICAgICB3aWR0aDogcmVjdC5yaWdodCAtIHJlY3QubGVmdCxcclxuICAgICAgICBoZWlnaHQ6IHJlY3QuYm90dG9tIC0gcmVjdC50b3BcclxuICAgICAgfTtcclxuICAgIH1cclxuICAgIHJldHVybiByZWN0O1xyXG4gIH1cclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIFJldHVybnMgYW4gZW1wdHkgcmVjdCBvYmplY3QuIEFuIGVtcHR5IHJlY3QgaXMgcmV0dXJuZWQgd2hlbiBhbiBlbGVtZW50XHJcbiAgICogaXMgbm90IGluIHRoZSBET00uXHJcbiAgICogQHJldHVybiB7T2JqZWN0fSBUaGUgZW1wdHkgcmVjdC5cclxuICAgKi9cclxuICBmdW5jdGlvbiBnZXRFbXB0eVJlY3QoKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICB0b3A6IDAsXHJcbiAgICAgIGJvdHRvbTogMCxcclxuICAgICAgbGVmdDogMCxcclxuICAgICAgcmlnaHQ6IDAsXHJcbiAgICAgIHdpZHRoOiAwLFxyXG4gICAgICBoZWlnaHQ6IDBcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDaGVja3MgdG8gc2VlIGlmIGEgcGFyZW50IGVsZW1lbnQgY29udGFpbnMgYSBjaGlsZCBlbGVtbnQgKGluY2x1ZGluZyBpbnNpZGVcclxuICAgKiBzaGFkb3cgRE9NKS5cclxuICAgKiBAcGFyYW0ge05vZGV9IHBhcmVudCBUaGUgcGFyZW50IGVsZW1lbnQuXHJcbiAgICogQHBhcmFtIHtOb2RlfSBjaGlsZCBUaGUgY2hpbGQgZWxlbWVudC5cclxuICAgKiBAcmV0dXJuIHtib29sZWFufSBUcnVlIGlmIHRoZSBwYXJlbnQgbm9kZSBjb250YWlucyB0aGUgY2hpbGQgbm9kZS5cclxuICAgKi9cclxuICBmdW5jdGlvbiBjb250YWluc0RlZXAocGFyZW50LCBjaGlsZCkge1xyXG4gICAgdmFyIG5vZGUgPSBjaGlsZDtcclxuICAgIHdoaWxlIChub2RlKSB7XHJcbiAgICAgIGlmIChub2RlID09IHBhcmVudCkgcmV0dXJuIHRydWU7XHJcblxyXG4gICAgICBub2RlID0gZ2V0UGFyZW50Tm9kZShub2RlKTtcclxuICAgIH1cclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcblxyXG5cclxuICAvKipcclxuICAgKiBHZXRzIHRoZSBwYXJlbnQgbm9kZSBvZiBhbiBlbGVtZW50IG9yIGl0cyBob3N0IGVsZW1lbnQgaWYgdGhlIHBhcmVudCBub2RlXHJcbiAgICogaXMgYSBzaGFkb3cgcm9vdC5cclxuICAgKiBAcGFyYW0ge05vZGV9IG5vZGUgVGhlIG5vZGUgd2hvc2UgcGFyZW50IHRvIGdldC5cclxuICAgKiBAcmV0dXJuIHtOb2RlfG51bGx9IFRoZSBwYXJlbnQgbm9kZSBvciBudWxsIGlmIG5vIHBhcmVudCBleGlzdHMuXHJcbiAgICovXHJcbiAgZnVuY3Rpb24gZ2V0UGFyZW50Tm9kZShub2RlKSB7XHJcbiAgICB2YXIgcGFyZW50ID0gbm9kZS5wYXJlbnROb2RlO1xyXG5cclxuICAgIGlmIChwYXJlbnQgJiYgcGFyZW50Lm5vZGVUeXBlID09IDExICYmIHBhcmVudC5ob3N0KSB7XHJcbiAgICAgIC8vIElmIHRoZSBwYXJlbnQgaXMgYSBzaGFkb3cgcm9vdCwgcmV0dXJuIHRoZSBob3N0IGVsZW1lbnQuXHJcbiAgICAgIHJldHVybiBwYXJlbnQuaG9zdDtcclxuICAgIH1cclxuICAgIHJldHVybiBwYXJlbnQ7XHJcbiAgfVxyXG5cclxuXHJcbiAgLy8gRXhwb3NlcyB0aGUgY29uc3RydWN0b3JzIGdsb2JhbGx5LlxyXG4gIHdpbmRvdy5JbnRlcnNlY3Rpb25PYnNlcnZlciA9IEludGVyc2VjdGlvbk9ic2VydmVyO1xyXG4gIHdpbmRvdy5JbnRlcnNlY3Rpb25PYnNlcnZlckVudHJ5ID0gSW50ZXJzZWN0aW9uT2JzZXJ2ZXJFbnRyeTtcclxuXHJcbn0od2luZG93LCBkb2N1bWVudCkpOyJdfQ==
