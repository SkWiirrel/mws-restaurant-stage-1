"use strict";var restaurant=void 0,map=void 0,dbHelper=new DBHelper;window.initMap=function(){fetchRestaurantFromURL(function(e,t){e?(self.map=new google.maps.Map(document.getElementById("map"),{zoom:16,center:t.latlng,scrollwheel:!1}),fillBreadcrumb(),dbHelper.mapMarkerForRestaurant(self.restaurant,self.map)):console.error(t)})};var fillRestaurantErrorHTML=function(){document.getElementById("restaurant-name").innerHTML="No restaurant found!"},fetchRestaurantFromURL=function(r){if(self.restaurant)r(null,self.restaurant);else{var e=getParameterByName("id");e?dbHelper.fetchRestaurantById(e,function(e,t){if(self.restaurant=t,!e||t instanceof Error||!t)return console.error(t),void fillRestaurantErrorHTML();fillRestaurantHTML(),r(!0,t)}):fillRestaurantErrorHTML()}},fillRestaurantHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant;document.getElementById("restaurant-name").innerHTML=e.name,document.getElementById("restaurant-address").innerHTML=e.address;var t=dbHelper.imageNameForRestaurant(e),r=document.getElementById("restaurant-pic-container");if(null===r.querySelector("picture")){var n=document.createElement("picture"),a=document.createElement("source");a.setAttribute("media","(max-width:750px)"),a.setAttribute("srcset","/img/"+t+"-650.webp 1x, /img/"+t+"-800.webp 2x");var i=document.createElement("source");i.setAttribute("media","(max-width:1200px)"),i.setAttribute("srcset","/img/"+t+"-550.webp 1x, /img/"+t+"-800.webp 2x");var l=document.createElement("img");l.src="/img/"+t+"-800.webp",l.className="restaurant-img",l.id="restaurant-img",l.alt=e.name,n.append(a),n.append(i),n.append(l),r.prepend(n),document.getElementById("map-container").setAttribute("aria-label","Google Maps showing "+e.name+"'s location"),document.getElementById("restaurant-cuisine").innerHTML=e.cuisine_type+" Restaurant",e.operating_hours&&fillRestaurantHoursHTML(),fillReviewsHTML()}},fillRestaurantHoursHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant.operating_hours,t=document.getElementById("restaurant-hours");for(var r in e){var n=document.createElement("tr"),a=document.createElement("td");a.innerHTML=r,n.appendChild(a);var i=document.createElement("td");i.innerHTML=e[r],n.appendChild(i),t.appendChild(n)}},fillReviewsHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant.reviews,t=document.getElementById("reviews-container"),r=document.createElement("h3");if(r.innerHTML="Reviews",t.appendChild(r),!e){var n=document.createElement("p");return n.innerHTML="No reviews yet!",void t.appendChild(n)}var a=document.getElementById("reviews-list");e.forEach(function(e){a.appendChild(createReviewHTML(e))}),t.appendChild(a)},createReviewHTML=function(e){var t=document.createElement("li"),r=document.createElement("div");r.className="reviews-author",r.innerHTML=e.name,t.appendChild(r);var n=document.createElement("small");n.className="reviews-date",n.innerHTML=e.date,r.appendChild(n);var a=document.createElement("p");a.innerHTML=e.comments,t.appendChild(a);var i=document.createElement("span");return i.className="reviews-rating",i.title="Rating: "+e.rating,i.setAttribute("aria-label",i.title),i.innerHTML="&#9733;".repeat(parseInt(e.rating))+"&#9734;".repeat(5-parseInt(e.rating)),t.appendChild(i),t},fillBreadcrumb=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant,t=document.getElementById("breadcrumb");if(null===t.querySelector("#crumb-restaurant-"+e.id)){var r=document.createElement("li");r.id="crumb-restaurant-"+e.id,r.innerHTML=e.name,t.appendChild(r)}},getParameterByName=function(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var r=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return r?r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):"":null};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlc3RhdXJhbnRfaW5mby5qcyJdLCJuYW1lcyI6WyJyZXN0YXVyYW50IiwibWFwIiwiZGJIZWxwZXIiLCJEQkhlbHBlciIsIndpbmRvdyIsImluaXRNYXAiLCJmZXRjaFJlc3RhdXJhbnRGcm9tVVJMIiwib2siLCJjb25zb2xlIiwiZXJyb3IiLCJNYXAiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiem9vbSIsImNlbnRlciIsImxhdGxuZyIsInNlbGYiLCJnb29nbGUiLCJzY3JvbGx3aGVlbCIsImZpbGxSZXN0YXVyYW50RXJyb3JIVE1MIiwiaW5uZXJIVE1MIiwiY2FsbGJhY2siLCJpZCIsImdldFBhcmFtZXRlckJ5TmFtZSIsImZpbGxSZXN0YXVyYW50SFRNTCIsImFyZ3VtZW50cyIsImxlbmd0aCIsInVuZGVmaW5lZCIsIm5hbWUiLCJhZGRyZXNzIiwiaW1nTmFtZSIsImltYWdlTmFtZUZvclJlc3RhdXJhbnQiLCJwaWN0dXJlX2NvbnRhaW5lciIsInF1ZXJ5U2VsZWN0b3IiLCJzb3VyY2Vfc21hbGwiLCJzZXRBdHRyaWJ1dGUiLCJzb3VyY2VfbGFyZ2UiLCJjcmVhdGVFbGVtZW50IiwicGljdHVyZSIsImltYWdlIiwiY2xhc3NOYW1lIiwiYXBwZW5kIiwic3JjIiwicHJlcGVuZCIsImN1aXNpbmVfdHlwZSIsIm9wZXJhdGluZ19ob3VycyIsImN1aXNpbmUiLCJmaWxsUmV2aWV3c0hUTUwiLCJob3VycyIsImtleSIsIm9wZXJhdGluZ0hvdXJzIiwicm93IiwiZGF5IiwiZmlsbFJlc3RhdXJhbnRIb3Vyc0hUTUwiLCJ0aW1lIiwiYXBwZW5kQ2hpbGQiLCJyZXZpZXdzIiwiY29udGFpbmVyIiwidGl0bGUiLCJub1Jldmlld3MiLCJjcmVhdGVSZXZpZXdIVE1MIiwicmV2aWV3IiwidWwiLCJmb3JFYWNoIiwiZGF0ZSIsImxpIiwiY29tbWVudHMiLCJyYXRpbmciLCJyZXBlYXQiLCJwYXJzZUludCIsImJyZWFkY3J1bWIiLCJ1cmwiLCJSZWdFeHAiLCJyZXN1bHRzIiwiZGVjb2RlVVJJQ29tcG9uZW50IiwicmVwbGFjZSJdLCJtYXBwaW5ncyI6ImFBQUEsSUFBQUEsZ0JBQUFBLEVBQUFDLFNBQUFBLEVBR01DLFNBQVcsSUFBSUMsU0FNckJDLE9BQU9DLFFBQVUsV0FDZkMsdUJBQXVCLFNBQUNDLEVBQUlQLEdBRHZCSyxHQUdERyxLQUFBQSxJQUFRQyxJQUFNVCxPQUFBQSxLQUFkVSxJQUFBQyxTQUFBQyxlQUFBLE9BQUEsQ0FDQUMsS0FBQSxHQUZGQyxPQUdPZCxFQUFBZSxPQUNMQyxhQUFlQyxJQUViSCxpQkFDQUksU0FBQUEsdUJBQWFGLEtBQUFoQixXQUFBZ0IsS0FBQWYsTUFSbkJLLFFBQUFBLE1BQUFBLE1BZ0JGLElBQUFhLHdCQUFBLFdBSUVSLFNBQVNDLGVBQWUsbUJBQW1CUSxVQUFZLHdCQUd6RGQsdUJBQUEsU0FBQWUsR0FJRSxHQUFJTCxLQUFLaEIsV0FDUHFCLEVBQVMsS0FBTUwsS0FBS2hCLGdCQUR0QixDQUF1QixJQUFBc0IsRUFBQUMsbUJBQUEsTUFDckJGLEVBR0ZuQixTQUFXcUIsb0JBQW1CRCxFQUE5QixTQUFBZixFQUFBUCxHQUVFbUIsR0FERUgsS0FBS2hCLFdBQUFBLEdBQ1BtQixHQUFBQSxhQUFBQSxRQUFBQSxFQUdFSCxPQUpKUixRQUVPQyxNQUFBVCxRQUNMRSwwQkFHRXNCLHFCQUNFaEIsR0FBQUEsRUFBQVIsS0FWSm1CLDRCQUhKSyxtQkFBQSxXQUFBLElBQUF4QixFQUFBLEVBQUF5QixVQUFBQyxhQUFBQyxJQUFBRixVQUFBLEdBQUFBLFVBQUEsR0FBQVQsS0FBQWhCLFdBdUJBVyxTQUFBQyxlQUFBLG1CQU1PUSxVQUFZcEIsRUFBVzRCLEtBSHhCSixTQUFxQlosZUFBckJZLHNCQUFzQnhCLFVBQWlDQSxFQUFBNkIsUUFRM0QsSUFBTUMsRUFBVTVCLFNBQVM2Qix1QkFBdUIvQixHQUwzQ29CLEVBQVlwQixTQUFqQlksZUFBQSw0QkFRQSxHQUFtRCxPQUEvQ29CLEVBQWtCQyxjQUFjLFdBQXFCLENBTHpESixJQUFRVCxFQUFSVCxTQUFvQlgsY0FBcEIsV0FFTThCLEVBQW1CQyxTQUFBQSxjQUF1Qi9CLFVBUTlDa0MsRUFBYUMsYUFBYSxRQUFTLHFCQU5yQ0QsRUFBTUYsYUFBb0JyQixTQUExQixRQUFtQ0MsRUFBbkMsc0JBQUFrQixFQUFBLGdCQVNFLElBQU1NLEVBQWV6QixTQUFTMEIsY0FBYyxVQU41Q0QsRUFBTUUsYUFBbUJELFFBQUFBLHNCQVF6QkQsRUFBYUQsYUFBYSxTQUExQixRQUE0Q0wsRUFBNUMsc0JBQXlFQSxFQUF6RSxnQkFMQUksSUFBQUEsRUFBYUMsU0FBQUEsY0FBc0IsT0FDbkNELEVBQUFBLElBQUFBLFFBQWFDLEVBQWJELFlBUUFLLEVBQU1DLFVBQVksaUJBTmxCRCxFQUFNSCxHQUFBQSxpQkFDTkEsRUFBQUEsSUFBQUEsRUFBYUQsS0FTYkcsRUFBUUcsT0FBT1AsR0FOZkksRUFBTUMsT0FBUTVCLEdBQ2Q0QixFQUFNRyxPQUFOSCxHQUVBQSxFQUFXSSxRQUFBTCxHQVNYM0IsU0FBU0MsZUFBZSxpQkFBaUJ1QixhQUFhLGFBQXRELHVCQUEyRm5DLEVBQVc0QixLQUF0RyxlQUxlUSxTQUFBQSxlQUFmLHNCQUNRSyxVQUFSekMsRUFBQTRDLGFBQUFOLGNBVUl0QyxFQUFXNkMsaUJBTmZsQywwQkFHQW1DLG9CQU9BQyx3QkFBQUEsV0FBQUEsSUFBQUEsRUFBQUEsRUFBQUEsVUFBQUEsYUFBQUEsSUFBQUEsVUFBQUEsR0FBQUEsVUFBQUEsR0FBQUEsS0FBQUEsV0FBQUEsZ0JBQ0RDLEVBQUFyQyxTQUFBQyxlQUFBLG9CQTlDSCxJQUFBLElBQUFxQyxLQUFBQyxFQUFBLENBdURJLElBQU1DLEVBQU14QyxTQUFTMEIsY0FBYyxNQUU3QmUsRUFBTXpDLFNBQVMwQixjQUFjLE1BQ25DZSxFQUFJaEMsVUFBWTZCLEVBTmRJLEVBQUFBLFlBQUFBLEdBU0YsSUFBTUMsRUFBTzNDLFNBQVMwQixjQUFjLE1BUnRDaUIsRUFBTU4sVUFBUXJDLEVBQVNDLEdBQ3ZCdUMsRUFBS0ksWUFBV0wsR0FXZEYsRUFBTU8sWUFBWUosS0FGbEJBLGdCQUFBLFdBQUEsSUFBQUssRUFBQSxFQUFBL0IsVUFBQUMsYUFBQUMsSUFBQUYsVUFBQSxHQUFBQSxVQUFBLEdBQUFULEtBQUFoQixXQUFBd0QsUUFVSUMsRUFBWTlDLFNBQVNDLGVBQWUscUJBUnhDb0MsRUFBTU8sU0FBTmxCLGNBQUEsTUFJSixHQUhHcUIsRUFBQXRDLFVBQUEsVUFkSHFDLEVBQUFGLFlBQUFHLElBaUJBRixFQUFBLENBVUksSUFBTUcsRUFBWWhELFNBQVMwQixjQUFjLEtBUGtCLE9BUTNEc0IsRUFBVXZDLFVBQVksdUJBUnBCMkIsRUFBQUEsWUFBa0JZLEdBQ3RCLElBQU1GLEVBQUFBLFNBQVk5QyxlQUFTQyxnQkFDM0I0QyxFQUFNRSxRQUFRL0MsU0FBQUEsR0FDZCtDLEVBQUFBLFlBQUFFLGlCQUFBQyxNQWFBSixFQUFVRixZQUFZTyxJQUxyQkYsaUJBQUEsU0FBQUMsR0FDRCxJQUFNQyxFQUFLbkQsU0FBU0MsY0FBZSxNQUNuQzRDLEVBQVFPLFNBQVExQixjQUFVLE9BQ3hCeUIsRUFBR1AsVUFBWUssaUJBQ2hCaEMsRUFGRFIsVUFBQXlDLEVBQUFqQyxLQUdBNkIsRUFBQUEsWUFBVUYsR0FhVixJQUFNUyxFQUFPckQsU0FBUzBCLGNBQWMsU0FWdEMyQixFQUFBeEIsVUFBQSxlQVlFd0IsRUFBSzVDLFVBQVl5QyxFQUFPRyxLQUN4QnBDLEVBQUsyQixZQUFZUyxHQVRqQixJQUFNQyxFQUFLdEQsU0FBUzBCLGNBQXBCLEtBQ0E2QixFQUFNdEMsVUFBZ0JTLEVBQUFBLFNBQ3RCVCxFQUFBQSxZQUFBc0MsR0FFQUQsSUFBR1YsRUFBWTNCLFNBQWZTLGNBQUEsUUFPQSxPQUtBOEIsRUFBTzNCLFVBQVksaUJBVm5CMkIsRUFBTUgsTUFBTixXQUFzQjNCLEVBQVQ4QixPQUNiSCxFQUFLeEIsYUFBWSxhQUFqQjJCLEVBQUFULE9BQ0FNLEVBQUs1QyxVQUFZeUMsVUFBakJPLE9BQUFDLFNBQUFSLEVBQUFNLFNBQUEsVUFBQUMsT0FBQSxFQUFBQyxTQUFBUixFQUFBTSxTQUNBdkMsRUFBQUEsWUFBSzJCLEdBRUNXLEdBTU5DLGVBQUEsV0FBQSxJQUFBbkUsRUFBQSxFQUFBeUIsVUFBQUMsYUFBQUMsSUFBQUYsVUFBQSxHQUFBQSxVQUFBLEdBQWlDMEMsS0FBQUEsV0FDakNBLEVBQUF4RCxTQUFvQkMsZUFBcUI4QyxjQUN6Q1MsR0FBK0QsT0FBL0RBLEVBQU8vQyxjQUFQK0MscUJBQTZDTixFQUExQnZDLElBQXNEOEMsQ0FDekVILElBQUdWLEVBQUFBLFNBQUhsQixjQUFBLE1BWUU0QixFQUFHM0MsR0FBSCxvQkFBNEJ0QixFQUFXc0IsR0FWekMyQyxFQUFBN0MsVUFBQXBCLEVBQUE0QixLQXZCRjBDLEVBQUFmLFlBQUFVLEtBMENNMUMsbUJBQXFCLFNBQUNLLEVBQU0yQyxHQVoxQkQsSUFDTkMsRUFBSUQsT0FBV3JDLFNBQUFBLE1BQ2JMLEVBQU1xQyxFQUFLdEQsUUFBUzBCLFVBQUFBLFFBQ3BCNEIsSUFDQUEsRUFEQSxJQUFBTyxPQUFBLE9BQTRCeEUsRUFBNUIscUJBQ2VBLEtBQUFBLEdBQ2ZzRSxPQUFBQSxFQU5KRyxFQUFBLEdBVUFDLG1CQUFBRCxFQUFBLEdBQUFFLFFBQUEsTUFBQSxNQVlXLEdBZlIiLCJmaWxlIjoicmVzdGF1cmFudF9pbmZvLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLypqc2hpbnQgZXN2ZXJzaW9uOiA2ICovXHJcblxyXG5sZXQgcmVzdGF1cmFudCwgbWFwO1xyXG5jb25zdCBkYkhlbHBlciA9IG5ldyBEQkhlbHBlcigpO1xyXG5cclxuXHJcbi8qKlxyXG4gKiBJbml0aWFsaXplIEdvb2dsZSBtYXAsIGNhbGxlZCBmcm9tIEhUTUwuXHJcbiAqL1xyXG53aW5kb3cuaW5pdE1hcCA9ICgpID0+IHtcclxuICBmZXRjaFJlc3RhdXJhbnRGcm9tVVJMKChvaywgcmVzdGF1cmFudCkgPT4ge1xyXG4gICAgaWYgKCFvaykgeyAvLyBHb3QgYW4gZXJyb3IhXHJcbiAgICAgIGNvbnNvbGUuZXJyb3IocmVzdGF1cmFudCk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHNlbGYubWFwID0gbmV3IGdvb2dsZS5tYXBzLk1hcChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwJyksIHtcclxuICAgICAgICB6b29tOiAxNixcclxuICAgICAgICBjZW50ZXI6IHJlc3RhdXJhbnQubGF0bG5nLFxyXG4gICAgICAgIHNjcm9sbHdoZWVsOiBmYWxzZVxyXG4gICAgICB9KTtcclxuICAgICAgZmlsbEJyZWFkY3J1bWIoKTtcclxuICAgICAgZGJIZWxwZXIubWFwTWFya2VyRm9yUmVzdGF1cmFudChzZWxmLnJlc3RhdXJhbnQsIHNlbGYubWFwKTtcclxuICAgIH1cclxuICB9KTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBDcmVhdGUgcmVzdGF1cmFudCBFcnJvciBIVE1MIGlmIG5vbmUgaXMgZm91bmQgYW5kIGFkZHMgaXQgdG8gdGhlIHdlYnBhZ2VcclxuICovXHJcbmNvbnN0IGZpbGxSZXN0YXVyYW50RXJyb3JIVE1MID0gKCkgPT4ge1xyXG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LW5hbWUnKS5pbm5lckhUTUwgPSAnTm8gcmVzdGF1cmFudCBmb3VuZCEnO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIEdldCBjdXJyZW50IHJlc3RhdXJhbnQgZnJvbSBwYWdlIFVSTC5cclxuICovXHJcbmNvbnN0IGZldGNoUmVzdGF1cmFudEZyb21VUkwgPSAoY2FsbGJhY2spID0+IHtcclxuICBpZiAoc2VsZi5yZXN0YXVyYW50KSB7IC8vIHJlc3RhdXJhbnQgYWxyZWFkeSBmZXRjaGVkIVxyXG4gICAgY2FsbGJhY2sobnVsbCwgc2VsZi5yZXN0YXVyYW50KTtcclxuICAgIHJldHVybjtcclxuICB9XHJcbiAgY29uc3QgaWQgPSBnZXRQYXJhbWV0ZXJCeU5hbWUoJ2lkJyk7XHJcbiAgaWYgKCFpZCkgeyAvLyBubyBpZCBmb3VuZCBpbiBVUkxcclxuICAgIGZpbGxSZXN0YXVyYW50RXJyb3JIVE1MKCk7XHJcbiAgfSBlbHNlIHtcclxuICAgIGRiSGVscGVyLmZldGNoUmVzdGF1cmFudEJ5SWQoaWQsIChvaywgcmVzdGF1cmFudCkgPT4ge1xyXG4gICAgICBzZWxmLnJlc3RhdXJhbnQgPSByZXN0YXVyYW50O1xyXG5cclxuICAgICAgaWYgKCFvayB8fCByZXN0YXVyYW50IGluc3RhbmNlb2YgRXJyb3IgfHwgIXJlc3RhdXJhbnQpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKHJlc3RhdXJhbnQpO1xyXG4gICAgICAgIGZpbGxSZXN0YXVyYW50RXJyb3JIVE1MKCk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIGZpbGxSZXN0YXVyYW50SFRNTCgpO1xyXG4gICAgICBjYWxsYmFjayh0cnVlLCByZXN0YXVyYW50KTtcclxuICAgIH0pO1xyXG4gIH1cclxufTtcclxuXHJcbi8qKlxyXG4gKiBDcmVhdGUgcmVzdGF1cmFudCBIVE1MIGFuZCBhZGQgaXQgdG8gdGhlIHdlYnBhZ2VcclxuICovXHJcbmNvbnN0IGZpbGxSZXN0YXVyYW50SFRNTCA9IChyZXN0YXVyYW50ID0gc2VsZi5yZXN0YXVyYW50KSA9PiB7XHJcblxyXG4gIGNvbnN0IG5hbWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1uYW1lJyk7XHJcbiAgbmFtZS5pbm5lckhUTUwgPSByZXN0YXVyYW50Lm5hbWU7XHJcblxyXG4gIGNvbnN0IGFkZHJlc3MgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1hZGRyZXNzJyk7XHJcbiAgYWRkcmVzcy5pbm5lckhUTUwgPSByZXN0YXVyYW50LmFkZHJlc3M7XHJcblxyXG4gIGNvbnN0IGltZ05hbWUgPSBkYkhlbHBlci5pbWFnZU5hbWVGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpO1xyXG5cclxuICBjb25zdCBwaWN0dXJlX2NvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LXBpYy1jb250YWluZXInKTtcclxuICBpZiAocGljdHVyZV9jb250YWluZXIucXVlcnlTZWxlY3RvcigncGljdHVyZScpID09PSBudWxsKSB7XHJcblxyXG4gICAgY29uc3QgcGljdHVyZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3BpY3R1cmUnKTtcclxuXHJcbiAgICBjb25zdCBzb3VyY2Vfc21hbGwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzb3VyY2UnKTtcclxuICAgIHNvdXJjZV9zbWFsbC5zZXRBdHRyaWJ1dGUoJ21lZGlhJywgJyhtYXgtd2lkdGg6NzUwcHgpJyk7XHJcbiAgICBzb3VyY2Vfc21hbGwuc2V0QXR0cmlidXRlKCdzcmNzZXQnLCBgL2ltZy8ke2ltZ05hbWV9LTY1MC53ZWJwIDF4LCAvaW1nLyR7aW1nTmFtZX0tODAwLndlYnAgMnhgKTtcclxuXHJcbiAgICBjb25zdCBzb3VyY2VfbGFyZ2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzb3VyY2UnKTtcclxuICAgIHNvdXJjZV9sYXJnZS5zZXRBdHRyaWJ1dGUoJ21lZGlhJywgJyhtYXgtd2lkdGg6MTIwMHB4KScpO1xyXG4gICAgc291cmNlX2xhcmdlLnNldEF0dHJpYnV0ZSgnc3Jjc2V0JywgYC9pbWcvJHtpbWdOYW1lfS01NTAud2VicCAxeCwgL2ltZy8ke2ltZ05hbWV9LTgwMC53ZWJwIDJ4YCk7XHJcblxyXG4gICAgY29uc3QgaW1hZ2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKTtcclxuICAgIGltYWdlLnNyYyA9IGAvaW1nLyR7aW1nTmFtZX0tODAwLndlYnBgO1xyXG4gICAgaW1hZ2UuY2xhc3NOYW1lID0gJ3Jlc3RhdXJhbnQtaW1nJztcclxuICAgIGltYWdlLmlkID0gJ3Jlc3RhdXJhbnQtaW1nJztcclxuICAgIGltYWdlLmFsdCA9IHJlc3RhdXJhbnQubmFtZTtcclxuXHJcbiAgICBwaWN0dXJlLmFwcGVuZChzb3VyY2Vfc21hbGwpO1xyXG4gICAgcGljdHVyZS5hcHBlbmQoc291cmNlX2xhcmdlKTtcclxuICAgIHBpY3R1cmUuYXBwZW5kKGltYWdlKTtcclxuXHJcbiAgICBwaWN0dXJlX2NvbnRhaW5lci5wcmVwZW5kKHBpY3R1cmUpO1xyXG5cclxuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXAtY29udGFpbmVyJykuc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJywgYEdvb2dsZSBNYXBzIHNob3dpbmcgJHtyZXN0YXVyYW50Lm5hbWV9J3MgbG9jYXRpb25gKTtcclxuXHJcbiAgICBjb25zdCBjdWlzaW5lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtY3Vpc2luZScpO1xyXG4gICAgY3Vpc2luZS5pbm5lckhUTUwgPSBgJHtyZXN0YXVyYW50LmN1aXNpbmVfdHlwZX0gUmVzdGF1cmFudGA7XHJcblxyXG4gICAgLy8gZmlsbCBvcGVyYXRpbmcgaG91cnNcclxuICAgIGlmIChyZXN0YXVyYW50Lm9wZXJhdGluZ19ob3Vycykge1xyXG4gICAgICBmaWxsUmVzdGF1cmFudEhvdXJzSFRNTCgpO1xyXG4gICAgfVxyXG4gICAgLy8gZmlsbCByZXZpZXdzXHJcbiAgICBmaWxsUmV2aWV3c0hUTUwoKTtcclxuICB9XHJcbn07XHJcblxyXG4vKipcclxuICogQ3JlYXRlIHJlc3RhdXJhbnQgb3BlcmF0aW5nIGhvdXJzIEhUTUwgdGFibGUgYW5kIGFkZCBpdCB0byB0aGUgd2VicGFnZS5cclxuICovXHJcbmNvbnN0IGZpbGxSZXN0YXVyYW50SG91cnNIVE1MID0gKG9wZXJhdGluZ0hvdXJzID0gc2VsZi5yZXN0YXVyYW50Lm9wZXJhdGluZ19ob3VycykgPT4ge1xyXG4gIGNvbnN0IGhvdXJzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtaG91cnMnKTtcclxuICBmb3IgKGxldCBrZXkgaW4gb3BlcmF0aW5nSG91cnMpIHtcclxuICAgIGNvbnN0IHJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RyJyk7XHJcblxyXG4gICAgY29uc3QgZGF5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGQnKTtcclxuICAgIGRheS5pbm5lckhUTUwgPSBrZXk7XHJcbiAgICByb3cuYXBwZW5kQ2hpbGQoZGF5KTtcclxuXHJcbiAgICBjb25zdCB0aW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGQnKTtcclxuICAgIHRpbWUuaW5uZXJIVE1MID0gb3BlcmF0aW5nSG91cnNba2V5XTtcclxuICAgIHJvdy5hcHBlbmRDaGlsZCh0aW1lKTtcclxuXHJcbiAgICBob3Vycy5hcHBlbmRDaGlsZChyb3cpO1xyXG4gIH1cclxufTtcclxuXHJcbi8qKlxyXG4gKiBDcmVhdGUgYWxsIHJldmlld3MgSFRNTCBhbmQgYWRkIHRoZW0gdG8gdGhlIHdlYnBhZ2UuXHJcbiAqL1xyXG5jb25zdCBmaWxsUmV2aWV3c0hUTUwgPSAocmV2aWV3cyA9IHNlbGYucmVzdGF1cmFudC5yZXZpZXdzKSA9PiB7XHJcbiAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jldmlld3MtY29udGFpbmVyJyk7XHJcbiAgY29uc3QgdGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMycpO1xyXG4gIHRpdGxlLmlubmVySFRNTCA9ICdSZXZpZXdzJztcclxuICBjb250YWluZXIuYXBwZW5kQ2hpbGQodGl0bGUpO1xyXG5cclxuICBpZiAoIXJldmlld3MpIHtcclxuICAgIGNvbnN0IG5vUmV2aWV3cyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcclxuICAgIG5vUmV2aWV3cy5pbm5lckhUTUwgPSAnTm8gcmV2aWV3cyB5ZXQhJztcclxuICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChub1Jldmlld3MpO1xyXG4gICAgcmV0dXJuO1xyXG4gIH1cclxuICBjb25zdCB1bCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXZpZXdzLWxpc3QnKTtcclxuICByZXZpZXdzLmZvckVhY2gocmV2aWV3ID0+IHtcclxuICAgIHVsLmFwcGVuZENoaWxkKGNyZWF0ZVJldmlld0hUTUwocmV2aWV3KSk7XHJcbiAgfSk7XHJcbiAgY29udGFpbmVyLmFwcGVuZENoaWxkKHVsKTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBDcmVhdGUgcmV2aWV3IEhUTUwgYW5kIGFkZCBpdCB0byB0aGUgd2VicGFnZS5cclxuICovXHJcbmNvbnN0IGNyZWF0ZVJldmlld0hUTUwgPSAocmV2aWV3KSA9PiB7XHJcbiAgY29uc3QgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpO1xyXG4gIGNvbnN0IG5hbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICBuYW1lLmNsYXNzTmFtZSA9ICdyZXZpZXdzLWF1dGhvcic7XHJcbiAgbmFtZS5pbm5lckhUTUwgPSByZXZpZXcubmFtZTtcclxuICBsaS5hcHBlbmRDaGlsZChuYW1lKTtcclxuXHJcbiAgY29uc3QgZGF0ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NtYWxsJyk7XHJcbiAgZGF0ZS5jbGFzc05hbWUgPSAncmV2aWV3cy1kYXRlJztcclxuICBkYXRlLmlubmVySFRNTCA9IHJldmlldy5kYXRlO1xyXG4gIG5hbWUuYXBwZW5kQ2hpbGQoZGF0ZSk7XHJcblxyXG4gIGNvbnN0IGNvbW1lbnRzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xyXG4gIGNvbW1lbnRzLmlubmVySFRNTCA9IHJldmlldy5jb21tZW50cztcclxuICBsaS5hcHBlbmRDaGlsZChjb21tZW50cyk7XHJcblxyXG4gIGNvbnN0IHJhdGluZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcclxuICByYXRpbmcuY2xhc3NOYW1lID0gJ3Jldmlld3MtcmF0aW5nJztcclxuICByYXRpbmcudGl0bGUgPSBgUmF0aW5nOiAke3Jldmlldy5yYXRpbmd9YDtcclxuICByYXRpbmcuc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJywgcmF0aW5nLnRpdGxlKTtcclxuICByYXRpbmcuaW5uZXJIVE1MID0gJyYjOTczMzsnLnJlcGVhdChwYXJzZUludChyZXZpZXcucmF0aW5nKSkgKyAnJiM5NzM0OycucmVwZWF0KDUgLSBwYXJzZUludChyZXZpZXcucmF0aW5nKSk7IC8vc3RhciAocGFzdGluZyB0aGUgc3ltYm9sIGFzIHN0cmluZyBpdHNlbGYgZGlkbid0IHdvcmspXHJcbiAgbGkuYXBwZW5kQ2hpbGQocmF0aW5nKTtcclxuXHJcbiAgcmV0dXJuIGxpO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIEFkZCByZXN0YXVyYW50IG5hbWUgdG8gdGhlIGJyZWFkY3J1bWIgbmF2aWdhdGlvbiBtZW51XHJcbiAqL1xyXG5jb25zdCBmaWxsQnJlYWRjcnVtYiA9IChyZXN0YXVyYW50ID0gc2VsZi5yZXN0YXVyYW50KSA9PiB7XHJcbiAgY29uc3QgYnJlYWRjcnVtYiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdicmVhZGNydW1iJyk7XHJcbiAgaWYgKGJyZWFkY3J1bWIucXVlcnlTZWxlY3RvcihgI2NydW1iLXJlc3RhdXJhbnQtJHtyZXN0YXVyYW50LmlkfWApID09PSBudWxsKSB7XHJcbiAgICBjb25zdCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XHJcbiAgICBsaS5pZCA9IGBjcnVtYi1yZXN0YXVyYW50LSR7cmVzdGF1cmFudC5pZH1gO1xyXG4gICAgbGkuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5uYW1lO1xyXG4gICAgYnJlYWRjcnVtYi5hcHBlbmRDaGlsZChsaSk7XHJcbiAgfVxyXG59O1xyXG5cclxuLyoqXHJcbiAqIEdldCBhIHBhcmFtZXRlciBieSBuYW1lIGZyb20gcGFnZSBVUkwuXHJcbiAqL1xyXG5jb25zdCBnZXRQYXJhbWV0ZXJCeU5hbWUgPSAobmFtZSwgdXJsKSA9PiB7XHJcbiAgaWYgKCF1cmwpXHJcbiAgICB1cmwgPSB3aW5kb3cubG9jYXRpb24uaHJlZjtcclxuICBuYW1lID0gbmFtZS5yZXBsYWNlKC9bXFxbXFxdXS9nLCAnXFxcXCQmJyk7XHJcbiAgY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKGBbPyZdJHtuYW1lfSg9KFteJiNdKil8JnwjfCQpYCksXHJcbiAgICByZXN1bHRzID0gcmVnZXguZXhlYyh1cmwpO1xyXG4gIGlmICghcmVzdWx0cylcclxuICAgIHJldHVybiBudWxsO1xyXG4gIGlmICghcmVzdWx0c1syXSlcclxuICAgIHJldHVybiAnJztcclxuICByZXR1cm4gZGVjb2RlVVJJQ29tcG9uZW50KHJlc3VsdHNbMl0ucmVwbGFjZSgvXFwrL2csICcgJykpO1xyXG59O1xyXG4iXX0=
