"use strict";var restaurant=void 0,map=void 0,dbHelper=new DBHelper;window.initMap=function(){fetchRestaurantFromURL(function(e,t){e?(self.map=new google.maps.Map(document.getElementById("map"),{zoom:16,center:t.latlng,scrollwheel:!1}),fillBreadcrumb(),dbHelper.mapMarkerForRestaurant(self.restaurant,self.map)):console.error(t)})};var fillRestaurantErrorHTML=function(){document.getElementById("restaurant-name").innerHTML="No restaurant found!"},fetchRestaurantFromURL=function(r){if(self.restaurant)r(null,self.restaurant);else{var e=getParameterByName("id");e?dbHelper.fetchRestaurantById(e,function(e,t){if(self.restaurant=t,!e||t instanceof Error||!t)return console.error(t),void fillRestaurantErrorHTML();fillRestaurantHTML(),r(!0,t)}):fillRestaurantErrorHTML()}},fillRestaurantHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant;document.getElementById("restaurant-name").innerHTML=e.name,document.getElementById("restaurant-address").innerHTML=e.address;var t=dbHelper.imageNameForRestaurant(e),r=document.getElementById("restaurant-pic-container");if(null===r.querySelector("picture")){var n=document.createElement("picture"),a=document.createElement("source");a.setAttribute("media","(max-width:750px)"),a.setAttribute("srcset","/img/"+t+"-650.jpg 1x, /img/"+t+"-800.jpg 2x");var i=document.createElement("source");i.setAttribute("media","(max-width:1200px)"),i.setAttribute("srcset","/img/"+t+"-550.jpg 1x, /img/"+t+"-800.jpg 2x");var l=document.createElement("img");l.src="/img/"+t+"-800.jpg",l.className="restaurant-img",l.id="restaurant-img",l.alt=e.name,n.append(a),n.append(i),n.append(l),r.prepend(n),document.getElementById("map-container").setAttribute("aria-label","Google Maps showing "+e.name+"'s location"),document.getElementById("restaurant-cuisine").innerHTML=e.cuisine_type+" Restaurant",e.operating_hours&&fillRestaurantHoursHTML(),fillReviewsHTML()}},fillRestaurantHoursHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant.operating_hours,t=document.getElementById("restaurant-hours");for(var r in e){var n=document.createElement("tr"),a=document.createElement("td");a.innerHTML=r,n.appendChild(a);var i=document.createElement("td");i.innerHTML=e[r],n.appendChild(i),t.appendChild(n)}},fillReviewsHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant.reviews,t=document.getElementById("reviews-container"),r=document.createElement("h3");if(r.innerHTML="Reviews",t.appendChild(r),!e){var n=document.createElement("p");return n.innerHTML="No reviews yet!",void t.appendChild(n)}var a=document.getElementById("reviews-list");e.forEach(function(e){a.appendChild(createReviewHTML(e))}),t.appendChild(a)},createReviewHTML=function(e){var t=document.createElement("li"),r=document.createElement("div");r.className="reviews-author",r.innerHTML=e.name,t.appendChild(r);var n=document.createElement("small");n.className="reviews-date",n.innerHTML=e.date,r.appendChild(n);var a=document.createElement("p");a.innerHTML=e.comments,t.appendChild(a);var i=document.createElement("span");return i.className="reviews-rating",i.title="Rating: "+e.rating,i.setAttribute("aria-label",i.title),i.innerHTML="&#9733;".repeat(parseInt(e.rating))+"&#9734;".repeat(5-parseInt(e.rating)),t.appendChild(i),t},fillBreadcrumb=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant,t=document.getElementById("breadcrumb");if(null===t.querySelector("#crumb-restaurant-"+e.id)){var r=document.createElement("li");r.id="crumb-restaurant-"+e.id,r.innerHTML=e.name,t.appendChild(r)}},getParameterByName=function(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var r=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return r?r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):"":null};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlc3RhdXJhbnRfaW5mby5qcyJdLCJuYW1lcyI6WyJyZXN0YXVyYW50IiwibWFwIiwiZGJIZWxwZXIiLCJEQkhlbHBlciIsIndpbmRvdyIsImluaXRNYXAiLCJmZXRjaFJlc3RhdXJhbnRGcm9tVVJMIiwib2siLCJjb25zb2xlIiwiZXJyb3IiLCJNYXAiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiem9vbSIsImNlbnRlciIsImxhdGxuZyIsInNlbGYiLCJnb29nbGUiLCJzY3JvbGx3aGVlbCIsImZpbGxSZXN0YXVyYW50RXJyb3JIVE1MIiwiaW5uZXJIVE1MIiwiY2FsbGJhY2siLCJpZCIsImdldFBhcmFtZXRlckJ5TmFtZSIsImZpbGxSZXN0YXVyYW50SFRNTCIsImFyZ3VtZW50cyIsImxlbmd0aCIsInVuZGVmaW5lZCIsIm5hbWUiLCJhZGRyZXNzIiwiaW1nTmFtZSIsImltYWdlTmFtZUZvclJlc3RhdXJhbnQiLCJwaWN0dXJlX2NvbnRhaW5lciIsInF1ZXJ5U2VsZWN0b3IiLCJzb3VyY2Vfc21hbGwiLCJzZXRBdHRyaWJ1dGUiLCJzb3VyY2VfbGFyZ2UiLCJjcmVhdGVFbGVtZW50IiwicGljdHVyZSIsImltYWdlIiwiY2xhc3NOYW1lIiwiYXBwZW5kIiwic3JjIiwicHJlcGVuZCIsImN1aXNpbmVfdHlwZSIsIm9wZXJhdGluZ19ob3VycyIsImN1aXNpbmUiLCJmaWxsUmV2aWV3c0hUTUwiLCJob3VycyIsImtleSIsIm9wZXJhdGluZ0hvdXJzIiwicm93IiwiZGF5IiwiZmlsbFJlc3RhdXJhbnRIb3Vyc0hUTUwiLCJ0aW1lIiwiYXBwZW5kQ2hpbGQiLCJyZXZpZXdzIiwiY29udGFpbmVyIiwidGl0bGUiLCJub1Jldmlld3MiLCJjcmVhdGVSZXZpZXdIVE1MIiwicmV2aWV3IiwidWwiLCJmb3JFYWNoIiwiZGF0ZSIsImxpIiwiY29tbWVudHMiLCJyYXRpbmciLCJyZXBlYXQiLCJwYXJzZUludCIsImJyZWFkY3J1bWIiLCJ1cmwiLCJSZWdFeHAi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TSxTQUNBdkMsRUFBQUEsWUFBSzJCLEdBRUNXLEdBTU5DLGVBQUEsV0FBQSxJQUFBbkUsRUFBQSxFQUFBeUIsVUFBQUMsYUFBQUMsSUFBQUYsVUFBQSxHQUFBQSxVQUFBLEdBQWlDMEMsS0FBQUEsV0FDakNBLEVBQUF4RCxTQUFvQkMsZUFBcUI4QyxjQUN6Q1MsR0FBK0QsT0FBL0RBLEVBQU8vQyxjQUFQK0MscUJBQTZDTixFQUExQnZDLElBQXNEOEMsQ0FDekVILElBQUdWLEVBQUFBLFNBQUhsQixjQUFBLE1BWUU0QixFQUFHM0MsR0FBSCxvQkFBNEJ0QixFQUFXc0IsR0FWekMyQyxFQUFBN0MsVUFBQXBCLEVBQUE0QixLQXZCRjBDLEVBQUFmLFlBQUFVLEtBMENNMUMsbUJBQXFCLFNBQUNLLEVBQU0yQyxHQVoxQkQsSUFDTkMsRUFBSUQsT0FBV3JDLFNBQUFBLE1BQ2JMLEVBQU1xQyxFQUFLdEQsUUFBUzBCLFVBQUFBLFFBQ3BCNEIsSUFDQUEsRUFEQSxJQUFBTyxPQUFBLE9BQTRCeEUsRUFBNUIscUJBQ2VBLEtBQUFBLEdBQ2ZzRSxPQUFBQSxFQU5KRyxFQUFBLEdBVUFDLG1CQUFBRCxFQUFBLEdBQUFFLFFBQUEsTUFBQSxNQVlXLEdBZlIiLCJmaWxlIjoicmVzdGF1cmFudF9pbmZvLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLypqc2hpbnQgZXN2ZXJzaW9uOiA2ICovXHJcblxyXG5sZXQgcmVzdGF1cmFudCwgbWFwO1xyXG5jb25zdCBkYkhlbHBlciA9IG5ldyBEQkhlbHBlcigpO1xyXG5cclxuXHJcbi8qKlxyXG4gKiBJbml0aWFsaXplIEdvb2dsZSBtYXAsIGNhbGxlZCBmcm9tIEhUTUwuXHJcbiAqL1xyXG53aW5kb3cuaW5pdE1hcCA9ICgpID0+IHtcclxuICBmZXRjaFJlc3RhdXJhbnRGcm9tVVJMKChvaywgcmVzdGF1cmFudCkgPT4ge1xyXG4gICAgaWYgKCFvaykgeyAvLyBHb3QgYW4gZXJyb3IhXHJcbiAgICAgIGNvbnNvbGUuZXJyb3IocmVzdGF1cmFudCk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHNlbGYubWFwID0gbmV3IGdvb2dsZS5tYXBzLk1hcChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwJyksIHtcclxuICAgICAgICB6b29tOiAxNixcclxuICAgICAgICBjZW50ZXI6IHJlc3RhdXJhbnQubGF0bG5nLFxyXG4gICAgICAgIHNjcm9sbHdoZWVsOiBmYWxzZVxyXG4gICAgICB9KTtcclxuICAgICAgZmlsbEJyZWFkY3J1bWIoKTtcclxuICAgICAgZGJIZWxwZXIubWFwTWFya2VyRm9yUmVzdGF1cmFudChzZWxmLnJlc3RhdXJhbnQsIHNlbGYubWFwKTtcclxuICAgIH1cclxuICB9KTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBDcmVhdGUgcmVzdGF1cmFudCBFcnJvciBIVE1MIGlmIG5vbmUgaXMgZm91bmQgYW5kIGFkZHMgaXQgdG8gdGhlIHdlYnBhZ2VcclxuICovXHJcbmNvbnN0IGZpbGxSZXN0YXVyYW50RXJyb3JIVE1MID0gKCkgPT4ge1xyXG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LW5hbWUnKS5pbm5lckhUTUwgPSAnTm8gcmVzdGF1cmFudCBmb3VuZCEnO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIEdldCBjdXJyZW50IHJlc3RhdXJhbnQgZnJvbSBwYWdlIFVSTC5cclxuICovXHJcbmNvbnN0IGZldGNoUmVzdGF1cmFudEZyb21VUkwgPSAoY2FsbGJhY2spID0+IHtcclxuICBpZiAoc2VsZi5yZXN0YXVyYW50KSB7IC8vIHJlc3RhdXJhbnQgYWxyZWFkeSBmZXRjaGVkIVxyXG4gICAgY2FsbGJhY2sobnVsbCwgc2VsZi5yZXN0YXVyYW50KTtcclxuICAgIHJldHVybjtcclxuICB9XHJcbiAgY29uc3QgaWQgPSBnZXRQYXJhbWV0ZXJCeU5hbWUoJ2lkJyk7XHJcbiAgaWYgKCFpZCkgeyAvLyBubyBpZCBmb3VuZCBpbiBVUkxcclxuICAgIGZpbGxSZXN0YXVyYW50RXJyb3JIVE1MKCk7XHJcbiAgfSBlbHNlIHtcclxuICAgIGRiSGVscGVyLmZldGNoUmVzdGF1cmFudEJ5SWQoaWQsIChvaywgcmVzdGF1cmFudCkgPT4ge1xyXG4gICAgICBzZWxmLnJlc3RhdXJhbnQgPSByZXN0YXVyYW50O1xyXG5cclxuICAgICAgaWYgKCFvayB8fCByZXN0YXVyYW50IGluc3RhbmNlb2YgRXJyb3IgfHwgIXJlc3RhdXJhbnQpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKHJlc3RhdXJhbnQpO1xyXG4gICAgICAgIGZpbGxSZXN0YXVyYW50RXJyb3JIVE1MKCk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIGZpbGxSZXN0YXVyYW50SFRNTCgpO1xyXG4gICAgICBjYWxsYmFjayh0cnVlLCByZXN0YXVyYW50KTtcclxuICAgIH0pO1xyXG4gIH1cclxufTtcclxuXHJcbi8qKlxyXG4gKiBDcmVhdGUgcmVzdGF1cmFudCBIVE1MIGFuZCBhZGQgaXQgdG8gdGhlIHdlYnBhZ2VcclxuICovXHJcbmNvbnN0IGZpbGxSZXN0YXVyYW50SFRNTCA9IChyZXN0YXVyYW50ID0gc2VsZi5yZXN0YXVyYW50KSA9PiB7XHJcblxyXG4gIGNvbnN0IG5hbWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1uYW1lJyk7XHJcbiAgbmFtZS5pbm5lckhUTUwgPSByZXN0YXVyYW50Lm5hbWU7XHJcblxyXG4gIGNvbnN0IGFkZHJlc3MgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1hZGRyZXNzJyk7XHJcbiAgYWRkcmVzcy5pbm5lckhUTUwgPSByZXN0YXVyYW50LmFkZHJlc3M7XHJcblxyXG4gIGNvbnN0IGltZ05hbWUgPSBkYkhlbHBlci5pbWFnZU5hbWVGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpO1xyXG5cclxuICBjb25zdCBwaWN0dXJlX2NvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LXBpYy1jb250YWluZXInKTtcclxuICBpZiAocGljdHVyZV9jb250YWluZXIucXVlcnlTZWxlY3RvcigncGljdHVyZScpID09PSBudWxsKSB7XHJcblxyXG4gICAgY29uc3QgcGljdHVyZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3BpY3R1cmUnKTtcclxuXHJcbiAgICBjb25zdCBzb3VyY2Vfc21hbGwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzb3VyY2UnKTtcclxuICAgIHNvdXJjZV9zbWFsbC5zZXRBdHRyaWJ1dGUoJ21lZGlhJywgJyhtYXgtd2lkdGg6NzUwcHgpJyk7XHJcbiAgICBzb3VyY2Vfc21hbGwuc2V0QXR0cmlidXRlKCdzcmNzZXQnLCBgL2ltZy8ke2ltZ05hbWV9LTY1MC5qcGcgMXgsIC9pbWcvJHtpbWdOYW1lfS04MDAuanBnIDJ4YCk7XHJcblxyXG4gICAgY29uc3Qgc291cmNlX2xhcmdlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc291cmNlJyk7XHJcbiAgICBzb3VyY2VfbGFyZ2Uuc2V0QXR0cmlidXRlKCdtZWRpYScsICcobWF4LXdpZHRoOjEyMDBweCknKTtcclxuICAgIHNvdXJjZV9sYXJnZS5zZXRBdHRyaWJ1dGUoJ3NyY3NldCcsIGAvaW1nLyR7aW1nTmFtZX0tNTUwLmpwZyAxeCwgL2ltZy8ke2ltZ05hbWV9LTgwMC5qcGcgMnhgKTtcclxuXHJcbiAgICBjb25zdCBpbWFnZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpO1xyXG4gICAgaW1hZ2Uuc3JjID0gYC9pbWcvJHtpbWdOYW1lfS04MDAuanBnYDtcclxuICAgIGltYWdlLmNsYXNzTmFtZSA9ICdyZXN0YXVyYW50LWltZyc7XHJcbiAgICBpbWFnZS5pZCA9ICdyZXN0YXVyYW50LWltZyc7XHJcbiAgICBpbWFnZS5hbHQgPSByZXN0YXVyYW50Lm5hbWU7XHJcblxyXG4gICAgcGljdHVyZS5hcHBlbmQoc291cmNlX3NtYWxsKTtcclxuICAgIHBpY3R1cmUuYXBwZW5kKHNvdXJjZV9sYXJnZSk7XHJcbiAgICBwaWN0dXJlLmFwcGVuZChpbWFnZSk7XHJcblxyXG4gICAgcGljdHVyZV9jb250YWluZXIucHJlcGVuZChwaWN0dXJlKTtcclxuXHJcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwLWNvbnRhaW5lcicpLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsIGBHb29nbGUgTWFwcyBzaG93aW5nICR7cmVzdGF1cmFudC5uYW1lfSdzIGxvY2F0aW9uYCk7XHJcblxyXG4gICAgY29uc3QgY3Vpc2luZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LWN1aXNpbmUnKTtcclxuICAgIGN1aXNpbmUuaW5uZXJIVE1MID0gYCR7cmVzdGF1cmFudC5jdWlzaW5lX3R5cGV9IFJlc3RhdXJhbnRgO1xyXG5cclxuICAgIC8vIGZpbGwgb3BlcmF0aW5nIGhvdXJzXHJcbiAgICBpZiAocmVzdGF1cmFudC5vcGVyYXRpbmdfaG91cnMpIHtcclxuICAgICAgZmlsbFJlc3RhdXJhbnRIb3Vyc0hUTUwoKTtcclxuICAgIH1cclxuICAgIC8vIGZpbGwgcmV2aWV3c1xyXG4gICAgZmlsbFJldmlld3NIVE1MKCk7XHJcbiAgfVxyXG59O1xyXG5cclxuLyoqXHJcbiAqIENyZWF0ZSByZXN0YXVyYW50IG9wZXJhdGluZyBob3VycyBIVE1MIHRhYmxlIGFuZCBhZGQgaXQgdG8gdGhlIHdlYnBhZ2UuXHJcbiAqL1xyXG5jb25zdCBmaWxsUmVzdGF1cmFudEhvdXJzSFRNTCA9IChvcGVyYXRpbmdIb3VycyA9IHNlbGYucmVzdGF1cmFudC5vcGVyYXRpbmdfaG91cnMpID0+IHtcclxuICBjb25zdCBob3VycyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LWhvdXJzJyk7XHJcbiAgZm9yIChsZXQga2V5IGluIG9wZXJhdGluZ0hvdXJzKSB7XHJcbiAgICBjb25zdCByb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0cicpO1xyXG5cclxuICAgIGNvbnN0IGRheSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RkJyk7XHJcbiAgICBkYXkuaW5uZXJIVE1MID0ga2V5O1xyXG4gICAgcm93LmFwcGVuZENoaWxkKGRheSk7XHJcblxyXG4gICAgY29uc3QgdGltZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RkJyk7XHJcbiAgICB0aW1lLmlubmVySFRNTCA9IG9wZXJhdGluZ0hvdXJzW2tleV07XHJcbiAgICByb3cuYXBwZW5kQ2hpbGQodGltZSk7XHJcblxyXG4gICAgaG91cnMuYXBwZW5kQ2hpbGQocm93KTtcclxuICB9XHJcbn07XHJcblxyXG4vKipcclxuICogQ3JlYXRlIGFsbCByZXZpZXdzIEhUTUwgYW5kIGFkZCB0aGVtIHRvIHRoZSB3ZWJwYWdlLlxyXG4gKi9cclxuY29uc3QgZmlsbFJldmlld3NIVE1MID0gKHJldmlld3MgPSBzZWxmLnJlc3RhdXJhbnQucmV2aWV3cykgPT4ge1xyXG4gIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXZpZXdzLWNvbnRhaW5lcicpO1xyXG4gIGNvbnN0IHRpdGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDMnKTtcclxuICB0aXRsZS5pbm5lckhUTUwgPSAnUmV2aWV3cyc7XHJcbiAgY29udGFpbmVyLmFwcGVuZENoaWxkKHRpdGxlKTtcclxuXHJcbiAgaWYgKCFyZXZpZXdzKSB7XHJcbiAgICBjb25zdCBub1Jldmlld3MgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XHJcbiAgICBub1Jldmlld3MuaW5uZXJIVE1MID0gJ05vIHJldmlld3MgeWV0ISc7XHJcbiAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQobm9SZXZpZXdzKTtcclxuICAgIHJldHVybjtcclxuICB9XHJcbiAgY29uc3QgdWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmV2aWV3cy1saXN0Jyk7XHJcbiAgcmV2aWV3cy5mb3JFYWNoKHJldmlldyA9PiB7XHJcbiAgICB1bC5hcHBlbmRDaGlsZChjcmVhdGVSZXZpZXdIVE1MKHJldmlldykpO1xyXG4gIH0pO1xyXG4gIGNvbnRhaW5lci5hcHBlbmRDaGlsZCh1bCk7XHJcbn07XHJcblxyXG4vKipcclxuICogQ3JlYXRlIHJldmlldyBIVE1MIGFuZCBhZGQgaXQgdG8gdGhlIHdlYnBhZ2UuXHJcbiAqL1xyXG5jb25zdCBjcmVhdGVSZXZpZXdIVE1MID0gKHJldmlldykgPT4ge1xyXG4gIGNvbnN0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcclxuICBjb25zdCBuYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgbmFtZS5jbGFzc05hbWUgPSAncmV2aWV3cy1hdXRob3InO1xyXG4gIG5hbWUuaW5uZXJIVE1MID0gcmV2aWV3Lm5hbWU7XHJcbiAgbGkuYXBwZW5kQ2hpbGQobmFtZSk7XHJcblxyXG4gIGNvbnN0IGRhdGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzbWFsbCcpO1xyXG4gIGRhdGUuY2xhc3NOYW1lID0gJ3Jldmlld3MtZGF0ZSc7XHJcbiAgZGF0ZS5pbm5lckhUTUwgPSByZXZpZXcuZGF0ZTtcclxuICBuYW1lLmFwcGVuZENoaWxkKGRhdGUpO1xyXG5cclxuICBjb25zdCBjb21tZW50cyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcclxuICBjb21tZW50cy5pbm5lckhUTUwgPSByZXZpZXcuY29tbWVudHM7XHJcbiAgbGkuYXBwZW5kQ2hpbGQoY29tbWVudHMpO1xyXG5cclxuICBjb25zdCByYXRpbmcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XHJcbiAgcmF0aW5nLmNsYXNzTmFtZSA9ICdyZXZpZXdzLXJhdGluZyc7XHJcbiAgcmF0aW5nLnRpdGxlID0gYFJhdGluZzogJHtyZXZpZXcucmF0aW5nfWA7XHJcbiAgcmF0aW5nLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsIHJhdGluZy50aXRsZSk7XHJcbiAgcmF0aW5nLmlubmVySFRNTCA9ICcmIzk3MzM7Jy5yZXBlYXQocGFyc2VJbnQocmV2aWV3LnJhdGluZykpICsgJyYjOTczNDsnLnJlcGVhdCg1IC0gcGFyc2VJbnQocmV2aWV3LnJhdGluZykpOyAvL3N0YXIgKHBhc3RpbmcgdGhlIHN5bWJvbCBhcyBzdHJpbmcgaXRzZWxmIGRpZG4ndCB3b3JrKVxyXG4gIGxpLmFwcGVuZENoaWxkKHJhdGluZyk7XHJcblxyXG4gIHJldHVybiBsaTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBBZGQgcmVzdGF1cmFudCBuYW1lIHRvIHRoZSBicmVhZGNydW1iIG5hdmlnYXRpb24gbWVudVxyXG4gKi9cclxuY29uc3QgZmlsbEJyZWFkY3J1bWIgPSAocmVzdGF1cmFudCA9IHNlbGYucmVzdGF1cmFudCkgPT4ge1xyXG4gIGNvbnN0IGJyZWFkY3J1bWIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnJlYWRjcnVtYicpO1xyXG4gIGlmIChicmVhZGNydW1iLnF1ZXJ5U2VsZWN0b3IoYCNjcnVtYi1yZXN0YXVyYW50LSR7cmVzdGF1cmFudC5pZH1gKSA9PT0gbnVsbCkge1xyXG4gICAgY29uc3QgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpO1xyXG4gICAgbGkuaWQgPSBgY3J1bWItcmVzdGF1cmFudC0ke3Jlc3RhdXJhbnQuaWR9YDtcclxuICAgIGxpLmlubmVySFRNTCA9IHJlc3RhdXJhbnQubmFtZTtcclxuICAgIGJyZWFkY3J1bWIuYXBwZW5kQ2hpbGQobGkpO1xyXG4gIH1cclxufTtcclxuXHJcbi8qKlxyXG4gKiBHZXQgYSBwYXJhbWV0ZXIgYnkgbmFtZSBmcm9tIHBhZ2UgVVJMLlxyXG4gKi9cclxuY29uc3QgZ2V0UGFyYW1ldGVyQnlOYW1lID0gKG5hbWUsIHVybCkgPT4ge1xyXG4gIGlmICghdXJsKVxyXG4gICAgdXJsID0gd2luZG93LmxvY2F0aW9uLmhyZWY7XHJcbiAgbmFtZSA9IG5hbWUucmVwbGFjZSgvW1xcW1xcXV0vZywgJ1xcXFwkJicpO1xyXG4gIGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cChgWz8mXSR7bmFtZX0oPShbXiYjXSopfCZ8I3wkKWApLFxyXG4gICAgcmVzdWx0cyA9IHJlZ2V4LmV4ZWModXJsKTtcclxuICBpZiAoIXJlc3VsdHMpXHJcbiAgICByZXR1cm4gbnVsbDtcclxuICBpZiAoIXJlc3VsdHNbMl0pXHJcbiAgICByZXR1cm4gJyc7XHJcbiAgcmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChyZXN1bHRzWzJdLnJlcGxhY2UoL1xcKy9nLCAnICcpKTtcclxufTsiXX0=
