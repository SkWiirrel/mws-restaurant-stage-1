"use strict";!function(){function u(n){return new Promise(function(e,t){n.onsuccess=function(){e(n.result)},n.onerror=function(){t(n.error)}})}function i(n,o,r){var i,e=new Promise(function(e,t){u(i=n[o].apply(n,r)).then(e,t)});return e.request=i,e}function e(e,n,t){t.forEach(function(t){Object.defineProperty(e.prototype,t,{get:function(){return this[n][t]},set:function(e){this[n][t]=e}})})}function t(t,n,o,e){e.forEach(function(e){e in o.prototype&&(t.prototype[e]=function(){return i(this[n],e,arguments)})})}function n(t,n,o,e){e.forEach(function(e){e in o.prototype&&(t.prototype[e]=function(){return this[n][e].apply(this[n],arguments)})})}function o(e,o,t,n){n.forEach(function(n){n in t.prototype&&(e.prototype[n]=function(){return e=this[o],(t=i(e,n,arguments)).then(function(e){if(e)return new c(e,t.request)});var e,t})})}function r(e){this._index=e}function c(e,t){this._cursor=e,this._request=t}function s(e){this._store=e}function a(n){this._tx=n,this.complete=new Promise(function(e,t){n.oncomplete=function(){e()},n.onerror=function(){t(n.error)},n.onabort=function(){t(n.error)}})}function p(e,t,n){this._db=e,this.oldVersion=t,this.transaction=new a(n)}function f(e){this._db=e}e(r,"_index",["name","keyPath","multiEntry","unique"]),t(r,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),o(r,"_index",IDBIndex,["openCursor","openKeyCursor"]),e(c,"_cursor",["direction","key","primaryKey","value"]),t(c,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach(function(n){n in IDBCursor.prototype&&(c.prototype[n]=function(){var t=this,e=arguments;return Promise.resolve().then(function(){return t._cursor[n].apply(t._cursor,e),u(t._request).then(function(e){if(e)return new c(e,t._request)})})})}),s.prototype.createIndex=function(){return new r(this._store.createIndex.apply(this._store,arguments))},s.prototype.index=function(){return new r(this._store.index.apply(this._store,arguments))},e(s,"_store",["name","keyPath","indexNames","autoIncrement"]),t(s,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),o(s,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),n(s,"_store",IDBObjectStore,["deleteIndex"]),a.prototype.objectStore=function(){return new s(this._tx.objectStore.apply(this._tx,arguments))},e(a,"_tx",["objectStoreNames","mode"]),n(a,"_tx",IDBTransaction,["abort"]),p.prototype.createObjectStore=function(){return new s(this._db.createObjectStore.apply(this._db,arguments))},e(p,"_db",["name","version","objectStoreNames"]),n(p,"_db",IDBDatabase,["deleteObjectStore","close"]),f.prototype.transaction=function(){return new a(this._db.transaction.apply(this._db,arguments))},e(f,"_db",["name","version","objectStoreNames"]),n(f,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach(function(i){[s,r].forEach(function(e){e.prototype[i.replace("open","iterate")]=function(){var e,t=(e=arguments,Array.prototype.slice.call(e)),n=t[t.length-1],o=this._store||this._index,r=o[i].apply(o,t.slice(0,-1));r.onsuccess=function(){n(r.result)}}})}),[r,s].forEach(function(e){e.prototype.getAll||(e.prototype.getAll=function(e,n){var o=this,r=[];return new Promise(function(t){o.iterateCursor(e,function(e){e?(r.push(e.value),void 0===n||r.length!=n?e.continue():t(r)):t(r)})})})});var d={open:function(e,t,n){var o=i(indexedDB,"open",[e,t]),r=o.request;return r.onupgradeneeded=function(e){n&&n(new p(r.result,e.oldVersion,r.transaction))},o.then(function(e){return new f(e)})},delete:function(e){return i(indexedDB,"deleteDatabase",[e])}};"undefined"!=typeof module?(module.exports=d,module.exports.default=module.exports):self.idb=d}();
"use strict";var _slicedToArray=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,a=void 0;try{for(var o,u=t[Symbol.iterator]();!(r=(o=u.next()).done)&&(n.push(o.value),!e||n.length!==e);r=!0);}catch(t){i=!0,a=t}finally{try{!r&&u.return&&u.return()}finally{if(i)throw a}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},_createClass=function(){function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var DBHelper=function(){function t(){_classCallCheck(this,t),this.dbPromise=idb.open("restaurant-reviews",1,function(t){t.createObjectStore("restaurants",{keyPath:"id"}),t.createObjectStore("reviews",{keyPath:"id"}).createIndex("restaurant_id","restaurant_id"),t.createObjectStore("reviews-to-submit",{keyPath:"id",autoIncrement:!0}).createIndex("restaurant_id","restaurant_id")})}return _createClass(t,[{key:"fetchRestaurants",value:function(e){var n=this;this.dbPromise.then(function(t){return t.transaction("restaurants").objectStore("restaurants").getAll()}).then(function(t){e([!0,t]),fetch(n.DATABASE_URL+"restaurants").then(function(t){return t.json()}).then(function(c){e([!0,c]),n.dbPromise.then(function(t){var e=t.transaction("restaurants","readwrite"),n=e.objectStore("restaurants"),r=!0,i=!1,a=void 0;try{for(var o,u=c[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;n.put(s)}}catch(t){i=!0,a=t}finally{try{!r&&u.return&&u.return()}finally{if(i)throw a}}return e.complete})}).catch(function(t){return e([!1,t])})})}},{key:"fetchRestaurant",value:function(e,n){var r=this;this.dbPromise.then(function(t){return t.transaction("restaurants").objectStore("restaurants").get(parseInt(n))}).then(function(t){e([!0,t]),fetch(r.DATABASE_URL+"restaurants/"+n).then(function(t){return t.json()}).then(function(n){e([!0,n]),r.dbPromise.then(function(t){var e=t.transaction("restaurants","readwrite");return e.objectStore("restaurants").put(n),e.complete})}).catch(function(t){return e([!1,t])})})}},{key:"fetchRestaurantById",value:function(t,a){this.fetchRestaurant(function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=_slicedToArray(t,2),n=e[0],r=void 0!==n&&n,i=e[1];a(r||!r,i)},t)}},{key:"fetchReviewsByRestaurantId",value:function(e,n){var r=this;this.dbPromise.then(function(t){return t.transaction("reviews").objectStore("reviews").index("restaurant_id").getAll(parseInt(e))}).then(function(t){n([!0,t]),fetch(r.DATABASE_URL+"reviews/?restaurant_id="+e).then(function(t){return t.json()}).then(function(c){n([!0,c]),r.dbPromise.then(function(t){var e=t.transaction("reviews","readwrite"),n=e.objectStore("reviews"),r=!0,i=!1,a=void 0;try{for(var o,u=c[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;n.put(s)}}catch(t){i=!0,a=t}finally{try{!r&&u.return&&u.return()}finally{if(i)throw a}}return e.complete})}).catch(function(t){return n([!1,t])})})}},{key:"fetchRestaurantByCuisine",value:function(o,u){this.fetchRestaurants(function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=_slicedToArray(t,2),n=e[0],r=void 0!==n&&n,i=e[1];if(r){var a=i.filter(function(t){return t.cuisine_type==o});u(r,a)}else u(!r,i)})}},{key:"fetchRestaurantByNeighborhood",value:function(o,u){this.fetchRestaurants(function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=_slicedToArray(t,2),n=e[0],r=void 0!==n&&n,i=e[1];if(r){var a=i.filter(function(t){return t.neighborhood==o});u(r,a)}else u(!r,i)})}},{key:"fetchRestaurantByCuisineAndNeighborhood",value:function(o,u,s){this.fetchRestaurants(function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=_slicedToArray(t,2),n=e[0],r=void 0!==n&&n,i=e[1];if(r){var a=i;"all"!=o&&(a=a.filter(function(t){return t.cuisine_type==o})),"all"!=u&&(a=a.filter(function(t){return t.neighborhood==u})),s(r,a)}else s(!r,i)})}},{key:"fetchNeighborhoods",value:function(u){this.fetchRestaurants(function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=_slicedToArray(t,2),n=e[0],r=void 0!==n&&n,i=e[1];if(r){var a=i.map(function(t,e){return i[e].neighborhood}),o=a.filter(function(t,e){return a.indexOf(t)==e});u(r,o)}else u(!r,i)})}},{key:"fetchCuisines",value:function(u){this.fetchRestaurants(function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=_slicedToArray(t,2),n=e[0],r=void 0!==n&&n,i=e[1];if(r){var a=i.map(function(t,e){return i[e].cuisine_type}),o=a.filter(function(t,e){return a.indexOf(t)==e});u(r,o)}else u(!r,i)})}},{key:"urlForRestaurant",value:function(t){return"./restaurant.html?id="+t.id}},{key:"imageUrlForRestaurant",value:function(t){return"/img/"+t.photograph+".jpf"}},{key:"imageNameForRestaurant",value:function(t){return(t.photograph||"5.jpf").replace(/\.jpf$/,"")}},{key:"mapMarkerForRestaurant",value:function(t,e){return new google.maps.Marker({position:t.latlng,title:t.name,url:this.urlForRestaurant(t),map:e,animation:google.maps.Animation.DROP})}},{key:"submitReview",value:function(t,e){fetch(this.DATABASE_URL+"reviews",{method:"POST",headers:new Headers({"Content-Type":"application/json"}),body:JSON.stringify(t)}).then(function(t){return t.json()}).then(function(t){e([!0,t])}).catch(function(t){return e([!1,t])})}},{key:"cacheReviewSubmission",value:function(e){this.dbPromise.then(function(t){return t.transaction("reviews-to-submit","readwrite").objectStore("reviews-to-submit").put(e)}).catch(function(t){return console.error("Wasn't able to cache review submission")})}},{key:"deleteCachedReview",value:function(e){return this.dbPromise.then(function(t){return t.transaction("reviews-to-submit","readwrite").objectStore("reviews-to-submit").delete(e)}).catch(function(t){return console.error("Wasn't able to delete cached review submission of ID: "+e,t)})}},{key:"submitCachedReview",value:function(e){var u=this;this.dbPromise.then(function(t){return t.transaction("reviews-to-submit").objectStore("reviews-to-submit").index("restaurant_id").getAll(e)}).then(function(t){if(t.length){var e=!0,n=!1,r=void 0;try{for(var a,i=function(){var i=a.value;u.submitReview(i,function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=_slicedToArray(t,2),n=e[0],r=void 0!==n&&n;e[1];r&&u.deleteCachedReview(i.id)})},o=t[Symbol.iterator]();!(e=(a=o.next()).done);e=!0)i()}catch(t){n=!0,r=t}finally{try{!e&&o.return&&o.return()}finally{if(n)throw r}}}}).catch(function(t){return console.info("Wasn't able get cached review submissions of restaurant ID: "+e,t)})}},{key:"DATABASE_URL",get:function(){return"//localhost:1337/"}}]),t}();
"use strict";var _createClass=function(){function t(e,r){for(var n=0;n<r.length;n++){var t=r[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}var ServiceWorkerController=function(){function e(){_classCallCheck(this,e),this._registerServiceWorker()}return _createClass(e,[{key:"_registerServiceWorker",value:function(){navigator.serviceWorker&&navigator.serviceWorker.register("sw.js")}}]),e}();new ServiceWorkerController;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImlkYi5qcyIsImRiaGVscGVyLmpzIiwiU2VydmljZVdvcmtlckNvbnRyb2xsZXIuanMiXSwibmFtZXMiOlsicHJvbWlzaWZ5UmVxdWVzdCIsInJlcXVlc3QiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsIm9uc3VjY2VzcyIsInJlc3VsdCIsIm9uZXJyb3IiLCJlcnJvciIsInByb21pc2lmeVJlcXVlc3RDYWxsIiwib2JqIiwibWV0aG9kIiwiYXJncyIsInAiLCJhcHBseSIsInRoZW4iLCJwcm94eVByb3BlcnRpZXMiLCJQcm94eUNsYXNzIiwidGFyZ2V0UHJvcCIsInByb3BlcnRpZXMiLCJmb3JFYWNoIiwicHJvcCIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwicHJvdG90eXBlIiwiZ2V0IiwidGhpcyIsInNldCIsInZhbCIsInByb3h5UmVxdWVzdE1ldGhvZHMiLCJDb25zdHJ1Y3RvciIsImFyZ3VtZW50cyIsInByb3h5TWV0aG9kcyIsInByb3h5Q3Vyc29yUmVxdWVzdE1ldGhvZHMiLCJ2YWx1ZSIsIkN1cnNvciIsIkluZGV4IiwiaW5kZXgiLCJfaW5kZXgiLCJfY3Vyc29yIiwiY3Vyc29yIiwiY29tcGxldGUiLCJzdG9yZSIsImlkYlRyYW5zYWN0aW9uIiwiVHJhbnNhY3Rpb24iLCJfdHgiLCJvbmNvbXBsZXRlIiwib25hYm9ydCIsIk9iamVjdFN0b3JlIiwiaXRlbXMiLCJkYiIsIm9sZFZlcnNpb24iLCJ0cmFuc2FjdGlvbiIsIl9kYiIsImluc3RhbmNlIiwiaXRlcmF0ZUN1cnNvciIsIm9wZW4iLCJEQiIsIklEQkluZGV4IiwiSURCQ3Vyc29yIiwibWV0aG9kTmFtZSIsIl9yZXF1ZXN0IiwiSURCT2JqZWN0U3RvcmUiLCJfc3RvcmUiLCJJREJUcmFuc2FjdGlvbiIsIlVwZ3JhZGVEQiIsIm5hdGl2ZU9iamVjdCIsImZ1bmNOYW1lIiwib2JqZWN0U3RvcmUiLCJjcmVhdGVPYmplY3RTdG9yZSIsImNvdW50IiwidW5kZWZpbmVkIiwiSURCRGF0YWJhc2UiLCJvbnVwZ3JhZGVuZWVkZWQiLCJ1cGdyYWRlQ2FsbGJhY2siLCJkZWxldGUiLCJtb2R1bGUiLCJleHBvcnRzIiwiZGVmYXVsdCIsInJlcGxhY2UiLCJzZWxmIiwiYXJyIiwiQXJyYXkiLCJzbGljZSIsImNhbGwiLCJjYWxsYmFjayIsImxlbmd0aCIsImdldEFsbCIsInF1ZXJ5IiwicHVzaCIsImNvbnRpbnVlIiwiZXhwIiwibmFtZSIsInZlcnNpb24iLCJpbmRleGVkREIiLCJldmVudCIsImlkYiIsIkRCSGVscGVyIiwiX2NsYXNzQ2FsbENoZWNrIiwiZGJQcm9taXNlIiwidXBncmFkZURiIiwia2V5UGF0aCIsImNyZWF0ZUluZGV4IiwiX3RoaXMiLCJyZXN0YXVyYW50cyIsImZldGNoIiwiREFUQUJBU0VfVVJMIiwicmVzcG9uc2UiLCJqc29uIiwiZGF0YSIsInR4IiwiX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiIsIl9kaWRJdGVyYXRvckVycm9yIiwiX2l0ZXJhdG9yRXJyb3IiLCJfc3RlcCIsImVyciIsIl9pdGVyYXRvciIsInJldHVybiIsImNhdGNoIiwiaWQiLCJfdGhpczIiLCJyZXN0YXVyYW50IiwicGFyc2VJbnQiLCJwdXQiLCJmZXRjaFJlc3RhdXJhbnQiLCJfcmVmIiwiX3JlZjIiLCJfc2xpY2VkVG9BcnJheSIsIl9yZWYyJCIsIm9rIiwicmVzdGF1cmFudF9pZCIsIl90aGlzMyIsInJldmlld3MiLCJfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMiIsIl9kaWRJdGVyYXRvckVycm9yMiIsIl9pdGVyYXRvckVycm9yMiIsIl9zdGVwMiIsIl9pdGVyYXRvcjIiLCJTeW1ib2wiLCJpdGVyYXRvciIsIm5leHQiLCJkb25lIiwicmV2aWV3IiwiY3Vpc2luZSIsImZldGNoUmVzdGF1cmFudHMiLCJfcmVmMyIsIl9yZWY0IiwiX3JlZjQkIiwicmVzdWx0cyIsImZpbHRlciIsInIiLCJjdWlzaW5lX3R5cGUiLCJuZWlnaGJvcmhvb2QiLCJfcmVmNSIsIl9yZWY2IiwiX3JlZjYkIiwiX3JlZjciLCJfcmVmOCIsIl9yZWY4JCIsIl9yZWY5IiwiX3JlZjEwIiwiX3JlZjEwJCIsIm5laWdoYm9yaG9vZHMiLCJtYXAiLCJ2IiwiaSIsInVuaXF1ZU5laWdoYm9yaG9vZHMiLCJpbmRleE9mIiwiY3Vpc2luZXMiLCJ1bmlxdWVDdWlzaW5lcyIsInBob3RvZ3JhcGgiLCJnb29nbGUiLCJtYXBzIiwiTWFya2VyIiwicG9zaXRpb24iLCJsYXRsbmciLCJ1cmwiLCJ1cmxGb3JSZXN0YXVyYW50IiwiYW5pbWF0aW9uIiwiRFJPUCIsImpzb25Gb3JtRGF0YSIsImhlYWRlcnMiLCJIZWFkZXJzIiwiQ29udGVudC1UeXBlIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJyYXdEYXRhIiwibmV3UmV2aWV3IiwiY29uc29sZSIsIl90aGlzNCIsImNhY2hlZFJldmlld3MiLCJfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMyIsIl9kaWRJdGVyYXRvckVycm9yMyIsIl9pdGVyYXRvckVycm9yMyIsIl9zdGVwMyIsIl9sb29wIiwiY2FjaGVkUmV2aWV3Iiwic3VibWl0UmV2aWV3IiwiX3JlZjEzIiwiX3JlZjE0IiwiX3JlZjE0JCIsIl9pdGVyYXRvcjMiLCJpbmZvIiwiU2VydmljZVdvcmtlckNvbnRyb2xsZXIiLCJfcmVnaXN0ZXJTZXJ2aWNlV29ya2VyIiwibmF2aWdhdG9yIiwic2VydmljZVdvcmtlciIsInJlZ2lzdGVyIl0sIm1hcHBpbmdzIjoiQUFBQSxjQUVDLFdBS0MsU0FBU0EsRUFBaUJDLEdBQ3hCLE9BQU8sSUFBSUMsUUFBUSxTQUFBQyxFQUFBQyxHQUNqQkgsRUFBUUksVUFBWSxXQUNsQkYsRUFBUUYsRUFBUUssU0FHbEJMLEVBQVFNLFFBQVUsV0FDaEJILEVBQU9ILEVBQVFPLFVBS3JCLFNBQVNDLEVBQXFCQyxFQUFLQyxFQUFRQyxHQUN6QyxJQUFJWCxFQUNBWSxFQUFJLElBQUlYLFFBQVEsU0FBQUMsRUFBQUMsR0FFbEJKLEVBREFDLEVBQVVTLEVBQUlDLEdBQVFHLE1BQU1KLEVBQUtF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QUFBMEcsR0FBQSxFQUFBQyxHQUFBLEVBQUFDLE9BQUEzSCxFQUFBLElBa0hELElBbEhDLElBa0hENEgsRUFsSENDLEVBQUEsV0FBQSxJQWtIVUMsRUFsSFZGLEVBQUFqSyxNQW9IQzRKLEVBQUtRLGFBQWFELEVBQWMsV0FBK0IsSUFBQUUsRUFBQSxFQUFBeEssVUFBQXVELGFBQUFmLElBQUF4QyxVQUFBLEdBQUFBLFVBQUEsR0FBUCxHQUFPeUssRUFBQXpFLGVBQUF3RSxFQUFBLEdBQUFFLEVBQUFELEVBQUEsR0FBN0J2RSxPQUE2QjFELElBQUFrSSxHQUFBQSxFQUFBRCxFQUFBLEdBNUduRXZFLEdBQ0tlLEVBQUFBLG1CQUFpQnFELEVBQWlDOUUsT0F5R3JEbUYsRUFBMkJYLEVBQTNCckQsT0FBQUMsY0FBQXFELEdBQUFHLEVBQUFPLEVBQUE5RCxRQUFBQyxNQUFBbUQsR0FBQSxFQUEwQ0ksSUFsSHpDLE1BQUFqRixHQUFBOEUsR0FBQSxFQUFBQyxFQUFBL0UsRUFBQSxRQUFBLEtBQUE2RSxHQUFBVSxFQUFBckYsUUFBQXFGLEVBQUFyRixTQUFBLFFBQUEsR0FBQTRFLEVBQUEsTUFBQUMsT0E2SEE1RSxNQUFNLFNBQUE5RyxHQUFBLE9BQVNxTCxRQUFRYyxLQUFSLCtEQUE0RXpFLEVBQWlCMUgsMENBelM5RyxNQUFBO2lZQ3BCQ29NLG1DQUVKLFNBQUFBLElBQWMxRyxnQkFBQXhFLEtBQUFrTCxHQUNabEwsS0FBS21MLCtGQUFBQSxVQUFBQSxlQUNOQyxVQUFBQyxjQUFBQyxTQUFBLGtCQVdILElBQUlKIiwiZmlsZSI6ImNvbW1vbnMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XHJcblxyXG4oZnVuY3Rpb24oKSB7XHJcbiAgZnVuY3Rpb24gdG9BcnJheShhcnIpIHtcclxuICAgIHJldHVybiBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcnIpO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gcHJvbWlzaWZ5UmVxdWVzdChyZXF1ZXN0KSB7XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgIHJlcXVlc3Qub25zdWNjZXNzID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmVzb2x2ZShyZXF1ZXN0LnJlc3VsdCk7XHJcbiAgICAgIH07XHJcblxyXG4gICAgICByZXF1ZXN0Lm9uZXJyb3IgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICByZWplY3QocmVxdWVzdC5lcnJvcik7XHJcbiAgICAgIH07XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHByb21pc2lmeVJlcXVlc3RDYWxsKG9iaiwgbWV0aG9kLCBhcmdzKSB7XHJcbiAgICB2YXIgcmVxdWVzdDtcclxuICAgIHZhciBwID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgIHJlcXVlc3QgPSBvYmpbbWV0aG9kXS5hcHBseShvYmosIGFyZ3MpO1xyXG4gICAgICBwcm9taXNpZnlSZXF1ZXN0KHJlcXVlc3QpLnRoZW4ocmVzb2x2ZSwgcmVqZWN0KTtcclxuICAgIH0pO1xyXG5cclxuICAgIHAucmVxdWVzdCA9IHJlcXVlc3Q7XHJcbiAgICByZXR1cm4gcDtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHByb21pc2lmeUN1cnNvclJlcXVlc3RDYWxsKG9iaiwgbWV0aG9kLCBhcmdzKSB7XHJcbiAgICB2YXIgcCA9IHByb21pc2lmeVJlcXVlc3RDYWxsKG9iaiwgbWV0aG9kLCBhcmdzKTtcclxuICAgIHJldHVybiBwLnRoZW4oZnVuY3Rpb24odmFsdWUpIHtcclxuICAgICAgaWYgKCF2YWx1ZSkgcmV0dXJuO1xyXG4gICAgICByZXR1cm4gbmV3IEN1cnNvcih2YWx1ZSwgcC5yZXF1ZXN0KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gcHJveHlQcm9wZXJ0aWVzKFByb3h5Q2xhc3MsIHRhcmdldFByb3AsIHByb3BlcnRpZXMpIHtcclxuICAgIHByb3BlcnRpZXMuZm9yRWFjaChmdW5jdGlvbihwcm9wKSB7XHJcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShQcm94eUNsYXNzLnByb3RvdHlwZSwgcHJvcCwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICByZXR1cm4gdGhpc1t0YXJnZXRQcm9wXVtwcm9wXTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHNldDogZnVuY3Rpb24odmFsKSB7XHJcbiAgICAgICAgICB0aGlzW3RhcmdldFByb3BdW3Byb3BdID0gdmFsO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHByb3h5UmVxdWVzdE1ldGhvZHMoUHJveHlDbGFzcywgdGFyZ2V0UHJvcCwgQ29uc3RydWN0b3IsIHByb3BlcnRpZXMpIHtcclxuICAgIHByb3BlcnRpZXMuZm9yRWFjaChmdW5jdGlvbihwcm9wKSB7XHJcbiAgICAgIGlmICghKHByb3AgaW4gQ29uc3RydWN0b3IucHJvdG90eXBlKSkgcmV0dXJuO1xyXG4gICAgICBQcm94eUNsYXNzLnByb3RvdHlwZVtwcm9wXSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiBwcm9taXNpZnlSZXF1ZXN0Q2FsbCh0aGlzW3RhcmdldFByb3BdLCBwcm9wLCBhcmd1bWVudHMpO1xyXG4gICAgICB9O1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBwcm94eU1ldGhvZHMoUHJveHlDbGFzcywgdGFyZ2V0UHJvcCwgQ29uc3RydWN0b3IsIHByb3BlcnRpZXMpIHtcclxuICAgIHByb3BlcnRpZXMuZm9yRWFjaChmdW5jdGlvbihwcm9wKSB7XHJcbiAgICAgIGlmICghKHByb3AgaW4gQ29uc3RydWN0b3IucHJvdG90eXBlKSkgcmV0dXJuO1xyXG4gICAgICBQcm94eUNsYXNzLnByb3RvdHlwZVtwcm9wXSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzW3RhcmdldFByb3BdW3Byb3BdLmFwcGx5KHRoaXNbdGFyZ2V0UHJvcF0sIGFyZ3VtZW50cyk7XHJcbiAgICAgIH07XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHByb3h5Q3Vyc29yUmVxdWVzdE1ldGhvZHMoUHJveHlDbGFzcywgdGFyZ2V0UHJvcCwgQ29uc3RydWN0b3IsIHByb3BlcnRpZXMpIHtcclxuICAgIHByb3BlcnRpZXMuZm9yRWFjaChmdW5jdGlvbihwcm9wKSB7XHJcbiAgICAgIGlmICghKHByb3AgaW4gQ29uc3RydWN0b3IucHJvdG90eXBlKSkgcmV0dXJuO1xyXG4gICAgICBQcm94eUNsYXNzLnByb3RvdHlwZVtwcm9wXSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiBwcm9taXNpZnlDdXJzb3JSZXF1ZXN0Q2FsbCh0aGlzW3RhcmdldFByb3BdLCBwcm9wLCBhcmd1bWVudHMpO1xyXG4gICAgICB9O1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBJbmRleChpbmRleCkge1xyXG4gICAgdGhpcy5faW5kZXggPSBpbmRleDtcclxuICB9XHJcblxyXG4gIHByb3h5UHJvcGVydGllcyhJbmRleCwgJ19pbmRleCcsIFtcclxuICAgICduYW1lJyxcclxuICAgICdrZXlQYXRoJyxcclxuICAgICdtdWx0aUVudHJ5JyxcclxuICAgICd1bmlxdWUnXHJcbiAgXSk7XHJcblxyXG4gIHByb3h5UmVxdWVzdE1ldGhvZHMoSW5kZXgsICdfaW5kZXgnLCBJREJJbmRleCwgW1xyXG4gICAgJ2dldCcsXHJcbiAgICAnZ2V0S2V5JyxcclxuICAgICdnZXRBbGwnLFxyXG4gICAgJ2dldEFsbEtleXMnLFxyXG4gICAgJ2NvdW50J1xyXG4gIF0pO1xyXG5cclxuICBwcm94eUN1cnNvclJlcXVlc3RNZXRob2RzKEluZGV4LCAnX2luZGV4JywgSURCSW5kZXgsIFtcclxuICAgICdvcGVuQ3Vyc29yJyxcclxuICAgICdvcGVuS2V5Q3Vyc29yJ1xyXG4gIF0pO1xyXG5cclxuICBmdW5jdGlvbiBDdXJzb3IoY3Vyc29yLCByZXF1ZXN0KSB7XHJcbiAgICB0aGlzLl9jdXJzb3IgPSBjdXJzb3I7XHJcbiAgICB0aGlzLl9yZXF1ZXN0ID0gcmVxdWVzdDtcclxuICB9XHJcblxyXG4gIHByb3h5UHJvcGVydGllcyhDdXJzb3IsICdfY3Vyc29yJywgW1xyXG4gICAgJ2RpcmVjdGlvbicsXHJcbiAgICAna2V5JyxcclxuICAgICdwcmltYXJ5S2V5JyxcclxuICAgICd2YWx1ZSdcclxuICBdKTtcclxuXHJcbiAgcHJveHlSZXF1ZXN0TWV0aG9kcyhDdXJzb3IsICdfY3Vyc29yJywgSURCQ3Vyc29yLCBbXHJcbiAgICAndXBkYXRlJyxcclxuICAgICdkZWxldGUnXHJcbiAgXSk7XHJcblxyXG4gIC8vIHByb3h5ICduZXh0JyBtZXRob2RzXHJcbiAgWydhZHZhbmNlJywgJ2NvbnRpbnVlJywgJ2NvbnRpbnVlUHJpbWFyeUtleSddLmZvckVhY2goZnVuY3Rpb24obWV0aG9kTmFtZSkge1xyXG4gICAgaWYgKCEobWV0aG9kTmFtZSBpbiBJREJDdXJzb3IucHJvdG90eXBlKSkgcmV0dXJuO1xyXG4gICAgQ3Vyc29yLnByb3RvdHlwZVttZXRob2ROYW1lXSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICB2YXIgY3Vyc29yID0gdGhpcztcclxuICAgICAgdmFyIGFyZ3MgPSBhcmd1bWVudHM7XHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKS50aGVuKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGN1cnNvci5fY3Vyc29yW21ldGhvZE5hbWVdLmFwcGx5KGN1cnNvci5fY3Vyc29yLCBhcmdzKTtcclxuICAgICAgICByZXR1cm4gcHJvbWlzaWZ5UmVxdWVzdChjdXJzb3IuX3JlcXVlc3QpLnRoZW4oZnVuY3Rpb24odmFsdWUpIHtcclxuICAgICAgICAgIGlmICghdmFsdWUpIHJldHVybjtcclxuICAgICAgICAgIHJldHVybiBuZXcgQ3Vyc29yKHZhbHVlLCBjdXJzb3IuX3JlcXVlc3QpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuICAgIH07XHJcbiAgfSk7XHJcblxyXG4gIGZ1bmN0aW9uIE9iamVjdFN0b3JlKHN0b3JlKSB7XHJcbiAgICB0aGlzLl9zdG9yZSA9IHN0b3JlO1xyXG4gIH1cclxuXHJcbiAgT2JqZWN0U3RvcmUucHJvdG90eXBlLmNyZWF0ZUluZGV4ID0gZnVuY3Rpb24oKSB7XHJcbiAgICByZXR1cm4gbmV3IEluZGV4KHRoaXMuX3N0b3JlLmNyZWF0ZUluZGV4LmFwcGx5KHRoaXMuX3N0b3JlLCBhcmd1bWVudHMpKTtcclxuICB9O1xyXG5cclxuICBPYmplY3RTdG9yZS5wcm90b3R5cGUuaW5kZXggPSBmdW5jdGlvbigpIHtcclxuICAgIHJldHVybiBuZXcgSW5kZXgodGhpcy5fc3RvcmUuaW5kZXguYXBwbHkodGhpcy5fc3RvcmUsIGFyZ3VtZW50cykpO1xyXG4gIH07XHJcblxyXG4gIHByb3h5UHJvcGVydGllcyhPYmplY3RTdG9yZSwgJ19zdG9yZScsIFtcclxuICAgICduYW1lJyxcclxuICAgICdrZXlQYXRoJyxcclxuICAgICdpbmRleE5hbWVzJyxcclxuICAgICdhdXRvSW5jcmVtZW50J1xyXG4gIF0pO1xyXG5cclxuICBwcm94eVJlcXVlc3RNZXRob2RzKE9iamVjdFN0b3JlLCAnX3N0b3JlJywgSURCT2JqZWN0U3RvcmUsIFtcclxuICAgICdwdXQnLFxyXG4gICAgJ2FkZCcsXHJcbiAgICAnZGVsZXRlJyxcclxuICAgICdjbGVhcicsXHJcbiAgICAnZ2V0JyxcclxuICAgICdnZXRBbGwnLFxyXG4gICAgJ2dldEtleScsXHJcbiAgICAnZ2V0QWxsS2V5cycsXHJcbiAgICAnY291bnQnXHJcbiAgXSk7XHJcblxyXG4gIHByb3h5Q3Vyc29yUmVxdWVzdE1ldGhvZHMoT2JqZWN0U3RvcmUsICdfc3RvcmUnLCBJREJPYmplY3RTdG9yZSwgW1xyXG4gICAgJ29wZW5DdXJzb3InLFxyXG4gICAgJ29wZW5LZXlDdXJzb3InXHJcbiAgXSk7XHJcblxyXG4gIHByb3h5TWV0aG9kcyhPYmplY3RTdG9yZSwgJ19zdG9yZScsIElEQk9iamVjdFN0b3JlLCBbXHJcbiAgICAnZGVsZXRlSW5kZXgnXHJcbiAgXSk7XHJcblxyXG4gIGZ1bmN0aW9uIFRyYW5zYWN0aW9uKGlkYlRyYW5zYWN0aW9uKSB7XHJcbiAgICB0aGlzLl90eCA9IGlkYlRyYW5zYWN0aW9uO1xyXG4gICAgdGhpcy5jb21wbGV0ZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICBpZGJUcmFuc2FjdGlvbi5vbmNvbXBsZXRlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmVzb2x2ZSgpO1xyXG4gICAgICB9O1xyXG4gICAgICBpZGJUcmFuc2FjdGlvbi5vbmVycm9yID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmVqZWN0KGlkYlRyYW5zYWN0aW9uLmVycm9yKTtcclxuICAgICAgfTtcclxuICAgICAgaWRiVHJhbnNhY3Rpb24ub25hYm9ydCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJlamVjdChpZGJUcmFuc2FjdGlvbi5lcnJvcik7XHJcbiAgICAgIH07XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIFRyYW5zYWN0aW9uLnByb3RvdHlwZS5vYmplY3RTdG9yZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgcmV0dXJuIG5ldyBPYmplY3RTdG9yZSh0aGlzLl90eC5vYmplY3RTdG9yZS5hcHBseSh0aGlzLl90eCwgYXJndW1lbnRzKSk7XHJcbiAgfTtcclxuXHJcbiAgcHJveHlQcm9wZXJ0aWVzKFRyYW5zYWN0aW9uLCAnX3R4JywgW1xyXG4gICAgJ29iamVjdFN0b3JlTmFtZXMnLFxyXG4gICAgJ21vZGUnXHJcbiAgXSk7XHJcblxyXG4gIHByb3h5TWV0aG9kcyhUcmFuc2FjdGlvbiwgJ190eCcsIElEQlRyYW5zYWN0aW9uLCBbXHJcbiAgICAnYWJvcnQnXHJcbiAgXSk7XHJcblxyXG4gIGZ1bmN0aW9uIFVwZ3JhZGVEQihkYiwgb2xkVmVyc2lvbiwgdHJhbnNhY3Rpb24pIHtcclxuICAgIHRoaXMuX2RiID0gZGI7XHJcbiAgICB0aGlzLm9sZFZlcnNpb24gPSBvbGRWZXJzaW9uO1xyXG4gICAgdGhpcy50cmFuc2FjdGlvbiA9IG5ldyBUcmFuc2FjdGlvbih0cmFuc2FjdGlvbik7XHJcbiAgfVxyXG5cclxuICBVcGdyYWRlREIucHJvdG90eXBlLmNyZWF0ZU9iamVjdFN0b3JlID0gZnVuY3Rpb24oKSB7XHJcbiAgICByZXR1cm4gbmV3IE9iamVjdFN0b3JlKHRoaXMuX2RiLmNyZWF0ZU9iamVjdFN0b3JlLmFwcGx5KHRoaXMuX2RiLCBhcmd1bWVudHMpKTtcclxuICB9O1xyXG5cclxuICBwcm94eVByb3BlcnRpZXMoVXBncmFkZURCLCAnX2RiJywgW1xyXG4gICAgJ25hbWUnLFxyXG4gICAgJ3ZlcnNpb24nLFxyXG4gICAgJ29iamVjdFN0b3JlTmFtZXMnXHJcbiAgXSk7XHJcblxyXG4gIHByb3h5TWV0aG9kcyhVcGdyYWRlREIsICdfZGInLCBJREJEYXRhYmFzZSwgW1xyXG4gICAgJ2RlbGV0ZU9iamVjdFN0b3JlJyxcclxuICAgICdjbG9zZSdcclxuICBdKTtcclxuXHJcbiAgZnVuY3Rpb24gREIoZGIpIHtcclxuICAgIHRoaXMuX2RiID0gZGI7XHJcbiAgfVxyXG5cclxuICBEQi5wcm90b3R5cGUudHJhbnNhY3Rpb24gPSBmdW5jdGlvbigpIHtcclxuICAgIHJldHVybiBuZXcgVHJhbnNhY3Rpb24odGhpcy5fZGIudHJhbnNhY3Rpb24uYXBwbHkodGhpcy5fZGIsIGFyZ3VtZW50cykpO1xyXG4gIH07XHJcblxyXG4gIHByb3h5UHJvcGVydGllcyhEQiwgJ19kYicsIFtcclxuICAgICduYW1lJyxcclxuICAgICd2ZXJzaW9uJyxcclxuICAgICdvYmplY3RTdG9yZU5hbWVzJ1xyXG4gIF0pO1xyXG5cclxuICBwcm94eU1ldGhvZHMoREIsICdfZGInLCBJREJEYXRhYmFzZSwgW1xyXG4gICAgJ2Nsb3NlJ1xyXG4gIF0pO1xyXG5cclxuICAvLyBBZGQgY3Vyc29yIGl0ZXJhdG9yc1xyXG4gIC8vIFRPRE86IHJlbW92ZSB0aGlzIG9uY2UgYnJvd3NlcnMgZG8gdGhlIHJpZ2h0IHRoaW5nIHdpdGggcHJvbWlzZXNcclxuICBbJ29wZW5DdXJzb3InLCAnb3BlbktleUN1cnNvciddLmZvckVhY2goZnVuY3Rpb24oZnVuY05hbWUpIHtcclxuICAgIFtPYmplY3RTdG9yZSwgSW5kZXhdLmZvckVhY2goZnVuY3Rpb24oQ29uc3RydWN0b3IpIHtcclxuICAgICAgQ29uc3RydWN0b3IucHJvdG90eXBlW2Z1bmNOYW1lLnJlcGxhY2UoJ29wZW4nLCAnaXRlcmF0ZScpXSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBhcmdzID0gdG9BcnJheShhcmd1bWVudHMpO1xyXG4gICAgICAgIHZhciBjYWxsYmFjayA9IGFyZ3NbYXJncy5sZW5ndGggLSAxXTtcclxuICAgICAgICB2YXIgbmF0aXZlT2JqZWN0ID0gdGhpcy5fc3RvcmUgfHwgdGhpcy5faW5kZXg7XHJcbiAgICAgICAgdmFyIHJlcXVlc3QgPSBuYXRpdmVPYmplY3RbZnVuY05hbWVdLmFwcGx5KG5hdGl2ZU9iamVjdCwgYXJncy5zbGljZSgwLCAtMSkpO1xyXG4gICAgICAgIHJlcXVlc3Qub25zdWNjZXNzID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICBjYWxsYmFjayhyZXF1ZXN0LnJlc3VsdCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgfTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICAvLyBwb2x5ZmlsbCBnZXRBbGxcclxuICBbSW5kZXgsIE9iamVjdFN0b3JlXS5mb3JFYWNoKGZ1bmN0aW9uKENvbnN0cnVjdG9yKSB7XHJcbiAgICBpZiAoQ29uc3RydWN0b3IucHJvdG90eXBlLmdldEFsbCkgcmV0dXJuO1xyXG4gICAgQ29uc3RydWN0b3IucHJvdG90eXBlLmdldEFsbCA9IGZ1bmN0aW9uKHF1ZXJ5LCBjb3VudCkge1xyXG4gICAgICB2YXIgaW5zdGFuY2UgPSB0aGlzO1xyXG4gICAgICB2YXIgaXRlbXMgPSBbXTtcclxuXHJcbiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlKSB7XHJcbiAgICAgICAgaW5zdGFuY2UuaXRlcmF0ZUN1cnNvcihxdWVyeSwgZnVuY3Rpb24oY3Vyc29yKSB7XHJcbiAgICAgICAgICBpZiAoIWN1cnNvcikge1xyXG4gICAgICAgICAgICByZXNvbHZlKGl0ZW1zKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgaXRlbXMucHVzaChjdXJzb3IudmFsdWUpO1xyXG5cclxuICAgICAgICAgIGlmIChjb3VudCAhPT0gdW5kZWZpbmVkICYmIGl0ZW1zLmxlbmd0aCA9PSBjb3VudCkge1xyXG4gICAgICAgICAgICByZXNvbHZlKGl0ZW1zKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgY3Vyc29yLmNvbnRpbnVlKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfTtcclxuICB9KTtcclxuXHJcbiAgdmFyIGV4cCA9IHtcclxuICAgIG9wZW46IGZ1bmN0aW9uKG5hbWUsIHZlcnNpb24sIHVwZ3JhZGVDYWxsYmFjaykge1xyXG4gICAgICB2YXIgcCA9IHByb21pc2lmeVJlcXVlc3RDYWxsKGluZGV4ZWREQiwgJ29wZW4nLCBbbmFtZSwgdmVyc2lvbl0pO1xyXG4gICAgICB2YXIgcmVxdWVzdCA9IHAucmVxdWVzdDtcclxuXHJcbiAgICAgIHJlcXVlc3Qub251cGdyYWRlbmVlZGVkID0gZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICBpZiAodXBncmFkZUNhbGxiYWNrKSB7XHJcbiAgICAgICAgICB1cGdyYWRlQ2FsbGJhY2sobmV3IFVwZ3JhZGVEQihyZXF1ZXN0LnJlc3VsdCwgZXZlbnQub2xkVmVyc2lvbiwgcmVxdWVzdC50cmFuc2FjdGlvbikpO1xyXG4gICAgICAgIH1cclxuICAgICAgfTtcclxuXHJcbiAgICAgIHJldHVybiBwLnRoZW4oZnVuY3Rpb24oZGIpIHtcclxuICAgICAgICByZXR1cm4gbmV3IERCKGRiKTtcclxuICAgICAgfSk7XHJcbiAgICB9LFxyXG4gICAgZGVsZXRlOiBmdW5jdGlvbihuYW1lKSB7XHJcbiAgICAgIHJldHVybiBwcm9taXNpZnlSZXF1ZXN0Q2FsbChpbmRleGVkREIsICdkZWxldGVEYXRhYmFzZScsIFtuYW1lXSk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgaWYgKHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICBtb2R1bGUuZXhwb3J0cyA9IGV4cDtcclxuICAgIG1vZHVsZS5leHBvcnRzLmRlZmF1bHQgPSBtb2R1bGUuZXhwb3J0cztcclxuICB9IGVsc2Uge1xyXG4gICAgc2VsZi5pZGIgPSBleHA7XHJcbiAgfVxyXG59KCkpOyIsIi8qanNoaW50IGVzdmVyc2lvbjogNiAqL1xyXG5cclxuLyoqXHJcbiAqIENvbW1vbiBkYXRhYmFzZSBoZWxwZXIgZnVuY3Rpb25zLlxyXG4gKi9cclxuY2xhc3MgREJIZWxwZXIge1xyXG5cclxuICBjb25zdHJ1Y3RvcigpIHtcclxuICAgIHRoaXMuZGJQcm9taXNlID0gaWRiLm9wZW4oJ3Jlc3RhdXJhbnQtcmV2aWV3cycsIDEsIHVwZ3JhZGVEYiA9PiB7XHJcbiAgICAgIHVwZ3JhZGVEYi5jcmVhdGVPYmplY3RTdG9yZSgncmVzdGF1cmFudHMnLCB7XHJcbiAgICAgICAga2V5UGF0aDogJ2lkJ1xyXG4gICAgICB9KTtcclxuICAgICAgdXBncmFkZURiLmNyZWF0ZU9iamVjdFN0b3JlKCdyZXZpZXdzJywge1xyXG4gICAgICAgIGtleVBhdGg6ICdpZCdcclxuICAgICAgfSkuY3JlYXRlSW5kZXgoJ3Jlc3RhdXJhbnRfaWQnLCAncmVzdGF1cmFudF9pZCcpO1xyXG5cclxuICAgICAgdXBncmFkZURiLmNyZWF0ZU9iamVjdFN0b3JlKCdyZXZpZXdzLXRvLXN1Ym1pdCcsIHtcclxuICAgICAgICBrZXlQYXRoOiAnaWQnLFxyXG4gICAgICAgIGF1dG9JbmNyZW1lbnQ6IHRydWVcclxuICAgICAgfSkuY3JlYXRlSW5kZXgoJ3Jlc3RhdXJhbnRfaWQnLCAncmVzdGF1cmFudF9pZCcpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBEYXRhYmFzZSBVUkwuXHJcbiAgICogQ2hhbmdlIHRoaXMgdG8gcmVzdGF1cmFudHMuanNvbiBmaWxlIGxvY2F0aW9uIG9uIHlvdXIgc2VydmVyLlxyXG4gICAqL1xyXG4gIGdldCBEQVRBQkFTRV9VUkwoKSB7XHJcbiAgICBjb25zdCBwb3J0ID0gMTMzNzsgLy8gQ2hhbmdlIHRoaXMgdG8geW91ciBzZXJ2ZXIgcG9ydFxyXG4gICAgcmV0dXJuIGAvL2xvY2FsaG9zdDoke3BvcnR9L2A7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBGZXRjaCBhbGwgcmVzdGF1cmFudHMgZnJvbSBEQiBpZiBwb3NzaWJsZS5cclxuICAgKi9cclxuICBmZXRjaFJlc3RhdXJhbnRzKGNhbGxiYWNrKSB7XHJcblxyXG4gICAgLy8gRmlyc3QgZ2V0IHJlc3RhdXJhbnRzIGZyb20gdGhlIGRhdGFiYXNlIGFuZCB0aGVuIGZyb20gdGhlIHdlYlxyXG4gICAgdGhpcy5kYlByb21pc2UudGhlbihkYiA9PiB7XHJcblxyXG4gICAgICByZXR1cm4gZGIudHJhbnNhY3Rpb24oJ3Jlc3RhdXJhbnRzJykub2JqZWN0U3RvcmUoJ3Jlc3RhdXJhbnRzJykuZ2V0QWxsKCk7XHJcblxyXG4gICAgfSkudGhlbihyZXN0YXVyYW50cyA9PiB7XHJcblxyXG4gICAgICAvLyBEaXNwbGF5IHJlc3RhdXJhbnRzIGZyb20gdGhlIGRhdGFiYXNlXHJcbiAgICAgIGNhbGxiYWNrKFt0cnVlLCByZXN0YXVyYW50c10pO1xyXG5cclxuICAgICAgLy8gR2V0IHJlc3RhdXJhbnRzIGZyb20gdGhlIHdlYlxyXG4gICAgICBmZXRjaCh0aGlzLkRBVEFCQVNFX1VSTCArICdyZXN0YXVyYW50cycpXHJcbiAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4gcmVzcG9uc2UuanNvbigpKVxyXG4gICAgICAgIC50aGVuKGRhdGEgPT4ge1xyXG4gICAgICAgICAgY2FsbGJhY2soW3RydWUsIGRhdGFdKTtcclxuXHJcbiAgICAgICAgICAvLyBBZGQgcmVzdGF1cmFudHMgZnJvbSB0aGUgd2ViIHRvIHRoZSBkYXRhYmFzZVxyXG4gICAgICAgICAgdGhpcy5kYlByb21pc2UudGhlbihkYiA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHR4ID0gZGIudHJhbnNhY3Rpb24oJ3Jlc3RhdXJhbnRzJywgJ3JlYWR3cml0ZScpO1xyXG4gICAgICAgICAgICBjb25zdCBzdG9yZSA9IHR4Lm9iamVjdFN0b3JlKCdyZXN0YXVyYW50cycpO1xyXG5cclxuICAgICAgICAgICAgZm9yIChjb25zdCByZXN0YXVyYW50IG9mIGRhdGEpIHtcclxuICAgICAgICAgICAgICBzdG9yZS5wdXQocmVzdGF1cmFudCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiB0eC5jb21wbGV0ZTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmNhdGNoKGVycm9yID0+IGNhbGxiYWNrKFtmYWxzZSwgZXJyb3JdKSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEZldGNoIGFsbCByZXN0YXVyYW50IGJ5IElEIGZyb20gREIgaWYgcG9zc2libGUuXHJcbiAgICovXHJcbiAgZmV0Y2hSZXN0YXVyYW50KGNhbGxiYWNrLCBpZCkge1xyXG5cclxuICAgIC8vIEZpcnN0IGdldCByZXN0YXVyYW50cyBmcm9tIHRoZSBkYXRhYmFzZSBhbmQgdGhlbiBmcm9tIHRoZSB3ZWJcclxuICAgIHRoaXMuZGJQcm9taXNlLnRoZW4oZGIgPT4ge1xyXG4gICAgICByZXR1cm4gZGIudHJhbnNhY3Rpb24oJ3Jlc3RhdXJhbnRzJykub2JqZWN0U3RvcmUoJ3Jlc3RhdXJhbnRzJykuZ2V0KHBhcnNlSW50KGlkKSk7XHJcbiAgICB9KS50aGVuKHJlc3RhdXJhbnQgPT4ge1xyXG4gICAgICAvLyBEaXNwbGF5IHJlc3RhdXJhbnRzIGZyb20gdGhlIGRhdGFiYXNlXHJcbiAgICAgIGNhbGxiYWNrKFt0cnVlLCByZXN0YXVyYW50XSk7XHJcblxyXG4gICAgICAvLyBHZXQgcmVzdGF1cmFudHMgZnJvbSB0aGUgd2ViXHJcbiAgICAgIGZldGNoKHRoaXMuREFUQUJBU0VfVVJMICsgYHJlc3RhdXJhbnRzLyR7aWR9YClcclxuICAgICAgICAudGhlbihyZXNwb25zZSA9PiByZXNwb25zZS5qc29uKCkpXHJcbiAgICAgICAgLnRoZW4oZGF0YSA9PiB7XHJcbiAgICAgICAgICBjYWxsYmFjayhbdHJ1ZSwgZGF0YV0pO1xyXG5cclxuICAgICAgICAgIC8vIEFkZCByZXN0YXVyYW50cyBmcm9tIHRoZSB3ZWIgdG8gdGhlIGRhdGFiYXNlXHJcbiAgICAgICAgICB0aGlzLmRiUHJvbWlzZS50aGVuKGRiID0+IHtcclxuICAgICAgICAgICAgY29uc3QgdHggPSBkYi50cmFuc2FjdGlvbigncmVzdGF1cmFudHMnLCAncmVhZHdyaXRlJyk7XHJcbiAgICAgICAgICAgIHR4Lm9iamVjdFN0b3JlKCdyZXN0YXVyYW50cycpLnB1dChkYXRhKTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiB0eC5jb21wbGV0ZTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmNhdGNoKGVycm9yID0+IGNhbGxiYWNrKFtmYWxzZSwgZXJyb3JdKSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEZldGNoIGEgcmVzdGF1cmFudCBieSBpdHMgSUQuXHJcbiAgICovXHJcbiAgZmV0Y2hSZXN0YXVyYW50QnlJZChpZCwgY2FsbGJhY2spIHtcclxuICAgIC8vIGZldGNoIGFsbCByZXN0YXVyYW50cyB3aXRoIHByb3BlciBlcnJvciBoYW5kbGluZy5cclxuICAgIHRoaXMuZmV0Y2hSZXN0YXVyYW50KChbb2sgPSBmYWxzZSwgcmVzcG9uc2VdID0gW10pID0+IHtcclxuICAgICAgaWYgKCFvaykge1xyXG4gICAgICAgIGNhbGxiYWNrKCFvaywgcmVzcG9uc2UpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGNhbGxiYWNrKG9rLCByZXNwb25zZSk7XHJcbiAgICAgIH1cclxuICAgIH0sIGlkKTtcclxuICB9XHJcblxyXG4gIGZldGNoUmV2aWV3c0J5UmVzdGF1cmFudElkKHJlc3RhdXJhbnRfaWQsIGNhbGxiYWNrKSB7XHJcblxyXG4gICAgdGhpcy5kYlByb21pc2UudGhlbihkYiA9PiB7XHJcbiAgICAgIHJldHVybiBkYi50cmFuc2FjdGlvbigncmV2aWV3cycpLm9iamVjdFN0b3JlKCdyZXZpZXdzJykuaW5kZXgoJ3Jlc3RhdXJhbnRfaWQnKS5nZXRBbGwocGFyc2VJbnQocmVzdGF1cmFudF9pZCkpO1xyXG4gICAgfSkudGhlbihyZXZpZXdzID0+IHtcclxuICAgICAgLy8gRGlzcGxheSByZXN0YXVyYW50cyBmcm9tIHRoZSBkYXRhYmFzZVxyXG4gICAgICBjYWxsYmFjayhbdHJ1ZSwgcmV2aWV3c10pO1xyXG5cclxuICAgICAgLy8gR2V0IHJlc3RhdXJhbnRzIGZyb20gdGhlIHdlYlxyXG4gICAgICBmZXRjaCh0aGlzLkRBVEFCQVNFX1VSTCArIGByZXZpZXdzLz9yZXN0YXVyYW50X2lkPSR7cmVzdGF1cmFudF9pZH1gKVxyXG4gICAgICAgIC50aGVuKHJlc3BvbnNlID0+IHJlc3BvbnNlLmpzb24oKSlcclxuICAgICAgICAudGhlbihkYXRhID0+IHtcclxuICAgICAgICAgIGNhbGxiYWNrKFt0cnVlLCBkYXRhXSk7XHJcblxyXG4gICAgICAgICAgLy8gQWRkIHJlc3RhdXJhbnRzIGZyb20gdGhlIHdlYiB0byB0aGUgZGF0YWJhc2VcclxuICAgICAgICAgIHRoaXMuZGJQcm9taXNlLnRoZW4oZGIgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCB0eCA9IGRiLnRyYW5zYWN0aW9uKCdyZXZpZXdzJywgJ3JlYWR3cml0ZScpO1xyXG4gICAgICAgICAgICBjb25zdCBzdG9yZSA9IHR4Lm9iamVjdFN0b3JlKCdyZXZpZXdzJyk7XHJcblxyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IHJldmlldyBvZiBkYXRhKSB7XHJcbiAgICAgICAgICAgICAgc3RvcmUucHV0KHJldmlldyk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiB0eC5jb21wbGV0ZTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmNhdGNoKGVycm9yID0+IGNhbGxiYWNrKFtmYWxzZSwgZXJyb3JdKSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEZldGNoIHJlc3RhdXJhbnRzIGJ5IGEgY3Vpc2luZSB0eXBlIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nLlxyXG4gICAqL1xyXG4gIGZldGNoUmVzdGF1cmFudEJ5Q3Vpc2luZShjdWlzaW5lLCBjYWxsYmFjaykge1xyXG4gICAgLy8gRmV0Y2ggYWxsIHJlc3RhdXJhbnRzICB3aXRoIHByb3BlciBlcnJvciBoYW5kbGluZ1xyXG4gICAgdGhpcy5mZXRjaFJlc3RhdXJhbnRzKChbb2sgPSBmYWxzZSwgcmVzcG9uc2VdID0gW10pID0+IHtcclxuICAgICAgaWYgKCFvaykge1xyXG4gICAgICAgIGNhbGxiYWNrKCFvaywgcmVzcG9uc2UpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vIEZpbHRlciByZXN0YXVyYW50cyB0byBoYXZlIG9ubHkgZ2l2ZW4gY3Vpc2luZSB0eXBlXHJcbiAgICAgICAgY29uc3QgcmVzdWx0cyA9IHJlc3BvbnNlLmZpbHRlcihyID0+IHIuY3Vpc2luZV90eXBlID09IGN1aXNpbmUpO1xyXG4gICAgICAgIGNhbGxiYWNrKG9rLCByZXN1bHRzKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBGZXRjaCByZXN0YXVyYW50cyBieSBhIG5laWdoYm9yaG9vZCB3aXRoIHByb3BlciBlcnJvciBoYW5kbGluZy5cclxuICAgKi9cclxuICBmZXRjaFJlc3RhdXJhbnRCeU5laWdoYm9yaG9vZChuZWlnaGJvcmhvb2QsIGNhbGxiYWNrKSB7XHJcbiAgICAvLyBGZXRjaCBhbGwgcmVzdGF1cmFudHNcclxuICAgIHRoaXMuZmV0Y2hSZXN0YXVyYW50cygoW29rID0gZmFsc2UsIHJlc3BvbnNlXSA9IFtdKSA9PiB7XHJcbiAgICAgIGlmICghb2spIHtcclxuICAgICAgICBjYWxsYmFjayghb2ssIHJlc3BvbnNlKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAvLyBGaWx0ZXIgcmVzdGF1cmFudHMgdG8gaGF2ZSBvbmx5IGdpdmVuIG5laWdoYm9yaG9vZFxyXG4gICAgICAgIGNvbnN0IHJlc3VsdHMgPSByZXNwb25zZS5maWx0ZXIociA9PiByLm5laWdoYm9yaG9vZCA9PSBuZWlnaGJvcmhvb2QpO1xyXG4gICAgICAgIGNhbGxiYWNrKG9rLCByZXN1bHRzKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBGZXRjaCByZXN0YXVyYW50cyBieSBhIGN1aXNpbmUgYW5kIGEgbmVpZ2hib3Job29kIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nLlxyXG4gICAqL1xyXG4gIGZldGNoUmVzdGF1cmFudEJ5Q3Vpc2luZUFuZE5laWdoYm9yaG9vZChjdWlzaW5lLCBuZWlnaGJvcmhvb2QsIGNhbGxiYWNrKSB7XHJcbiAgICAvLyBGZXRjaCBhbGwgcmVzdGF1cmFudHNcclxuICAgIHRoaXMuZmV0Y2hSZXN0YXVyYW50cygoW29rID0gZmFsc2UsIHJlc3BvbnNlXSA9IFtdKSA9PiB7XHJcbiAgICAgIGlmICghb2spIHtcclxuICAgICAgICBjYWxsYmFjayghb2ssIHJlc3BvbnNlKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBsZXQgcmVzdWx0cyA9IHJlc3BvbnNlO1xyXG4gICAgICAgIGlmIChjdWlzaW5lICE9ICdhbGwnKSB7IC8vIGZpbHRlciBieSBjdWlzaW5lXHJcbiAgICAgICAgICByZXN1bHRzID0gcmVzdWx0cy5maWx0ZXIociA9PiByLmN1aXNpbmVfdHlwZSA9PSBjdWlzaW5lKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKG5laWdoYm9yaG9vZCAhPSAnYWxsJykgeyAvLyBmaWx0ZXIgYnkgbmVpZ2hib3Job29kXHJcbiAgICAgICAgICByZXN1bHRzID0gcmVzdWx0cy5maWx0ZXIociA9PiByLm5laWdoYm9yaG9vZCA9PSBuZWlnaGJvcmhvb2QpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYWxsYmFjayhvaywgcmVzdWx0cyk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRmV0Y2ggYWxsIG5laWdoYm9yaG9vZHMgd2l0aCBwcm9wZXIgZXJyb3IgaGFuZGxpbmcuXHJcbiAgICovXHJcbiAgZmV0Y2hOZWlnaGJvcmhvb2RzKGNhbGxiYWNrKSB7XHJcbiAgICAvLyBGZXRjaCBhbGwgcmVzdGF1cmFudHNcclxuICAgIHRoaXMuZmV0Y2hSZXN0YXVyYW50cygoW29rID0gZmFsc2UsIHJlc3BvbnNlXSA9IFtdKSA9PiB7XHJcbiAgICAgIGlmICghb2spIHtcclxuICAgICAgICBjYWxsYmFjayghb2ssIHJlc3BvbnNlKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAvLyBHZXQgYWxsIG5laWdoYm9yaG9vZHMgZnJvbSBhbGwgcmVzdGF1cmFudHNcclxuICAgICAgICBjb25zdCBuZWlnaGJvcmhvb2RzID0gcmVzcG9uc2UubWFwKCh2LCBpKSA9PiByZXNwb25zZVtpXS5uZWlnaGJvcmhvb2QpO1xyXG4gICAgICAgIC8vIFJlbW92ZSBkdXBsaWNhdGVzIGZyb20gbmVpZ2hib3Job29kc1xyXG4gICAgICAgIGNvbnN0IHVuaXF1ZU5laWdoYm9yaG9vZHMgPSBuZWlnaGJvcmhvb2RzLmZpbHRlcigodiwgaSkgPT4gbmVpZ2hib3Job29kcy5pbmRleE9mKHYpID09IGkpO1xyXG4gICAgICAgIGNhbGxiYWNrKG9rLCB1bmlxdWVOZWlnaGJvcmhvb2RzKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBGZXRjaCBhbGwgY3Vpc2luZXMgd2l0aCBwcm9wZXIgZXJyb3IgaGFuZGxpbmcuXHJcbiAgICovXHJcbiAgZmV0Y2hDdWlzaW5lcyhjYWxsYmFjaykge1xyXG4gICAgLy8gRmV0Y2ggYWxsIHJlc3RhdXJhbnRzXHJcbiAgICB0aGlzLmZldGNoUmVzdGF1cmFudHMoKFtvayA9IGZhbHNlLCByZXNwb25zZV0gPSBbXSkgPT4ge1xyXG4gICAgICBpZiAoIW9rKSB7XHJcbiAgICAgICAgY2FsbGJhY2soIW9rLCByZXNwb25zZSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy8gR2V0IGFsbCBjdWlzaW5lcyBmcm9tIGFsbCByZXN0YXVyYW50c1xyXG4gICAgICAgIGNvbnN0IGN1aXNpbmVzID0gcmVzcG9uc2UubWFwKCh2LCBpKSA9PiByZXNwb25zZVtpXS5jdWlzaW5lX3R5cGUpO1xyXG4gICAgICAgIC8vIFJlbW92ZSBkdXBsaWNhdGVzIGZyb20gY3Vpc2luZXNcclxuICAgICAgICBjb25zdCB1bmlxdWVDdWlzaW5lcyA9IGN1aXNpbmVzLmZpbHRlcigodiwgaSkgPT4gY3Vpc2luZXMuaW5kZXhPZih2KSA9PSBpKTtcclxuICAgICAgICBjYWxsYmFjayhvaywgdW5pcXVlQ3Vpc2luZXMpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJlc3RhdXJhbnQgcGFnZSBVUkwuXHJcbiAgICovXHJcbiAgdXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50KSB7XHJcbiAgICByZXR1cm4gKGAuL3Jlc3RhdXJhbnQuaHRtbD9pZD0ke3Jlc3RhdXJhbnQuaWR9YCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZXN0YXVyYW50IGltYWdlIFVSTC5cclxuICAgKi9cclxuICBpbWFnZVVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCkge1xyXG4gICAgcmV0dXJuIChgL2ltZy8ke3Jlc3RhdXJhbnQucGhvdG9ncmFwaH0uanBmYCk7XHJcbiAgfVxyXG5cclxuICBpbWFnZU5hbWVGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpIHtcclxuICAgIHJldHVybiAocmVzdGF1cmFudC5waG90b2dyYXBoIHx8ICc1LmpwZicpLnJlcGxhY2UoL1xcLmpwZiQvLCAnJyk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBNYXAgbWFya2VyIGZvciBhIHJlc3RhdXJhbnQuXHJcbiAgICovXHJcbiAgbWFwTWFya2VyRm9yUmVzdGF1cmFudChyZXN0YXVyYW50LCBtYXApIHtcclxuICAgIGNvbnN0IG1hcmtlciA9IG5ldyBnb29nbGUubWFwcy5NYXJrZXIoe1xyXG4gICAgICBwb3NpdGlvbjogcmVzdGF1cmFudC5sYXRsbmcsXHJcbiAgICAgIHRpdGxlOiByZXN0YXVyYW50Lm5hbWUsXHJcbiAgICAgIHVybDogdGhpcy51cmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpLFxyXG4gICAgICBtYXA6IG1hcCxcclxuICAgICAgYW5pbWF0aW9uOiBnb29nbGUubWFwcy5BbmltYXRpb24uRFJPUFxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gbWFya2VyO1xyXG4gIH1cclxuXHJcbiAgc3VibWl0UmV2aWV3KGpzb25Gb3JtRGF0YSwgY2FsbGJhY2spIHtcclxuXHJcbiAgICBmZXRjaCh0aGlzLkRBVEFCQVNFX1VSTCArICdyZXZpZXdzJywge1xyXG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgICAgIGhlYWRlcnM6IG5ldyBIZWFkZXJzKHtcclxuICAgICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gICAgICAgIH0pLFxyXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGpzb25Gb3JtRGF0YSlcclxuICAgICAgfSlcclxuICAgICAgLnRoZW4ocmF3RGF0YSA9PiByYXdEYXRhLmpzb24oKSlcclxuICAgICAgLnRoZW4obmV3UmV2aWV3ID0+IHtcclxuICAgICAgICBjYWxsYmFjayhbdHJ1ZSwgbmV3UmV2aWV3XSk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaChlcnJvciA9PiBjYWxsYmFjayhbZmFsc2UsIGVycm9yXSkpO1xyXG4gIH1cclxuXHJcbiAgY2FjaGVSZXZpZXdTdWJtaXNzaW9uKGpzb25Gb3JtRGF0YSkge1xyXG5cclxuICAgIHRoaXMuZGJQcm9taXNlLnRoZW4oZGIgPT4ge1xyXG5cclxuICAgICAgcmV0dXJuIGRiLnRyYW5zYWN0aW9uKCdyZXZpZXdzLXRvLXN1Ym1pdCcsICdyZWFkd3JpdGUnKS5vYmplY3RTdG9yZSgncmV2aWV3cy10by1zdWJtaXQnKS5wdXQoanNvbkZvcm1EYXRhKTtcclxuXHJcbiAgICB9KS5jYXRjaChlcnJvciA9PiBjb25zb2xlLmVycm9yKCdXYXNuXFwndCBhYmxlIHRvIGNhY2hlIHJldmlldyBzdWJtaXNzaW9uJykpO1xyXG5cclxuICB9XHJcblxyXG4gIGRlbGV0ZUNhY2hlZFJldmlldyhpZCkge1xyXG4gICAgcmV0dXJuIHRoaXMuZGJQcm9taXNlLnRoZW4oZGIgPT4ge1xyXG4gICAgICByZXR1cm4gZGIudHJhbnNhY3Rpb24oJ3Jldmlld3MtdG8tc3VibWl0JywgJ3JlYWR3cml0ZScpLm9iamVjdFN0b3JlKCdyZXZpZXdzLXRvLXN1Ym1pdCcpLmRlbGV0ZShpZCk7XHJcbiAgICB9KS5jYXRjaChlcnJvciA9PiBjb25zb2xlLmVycm9yKGBXYXNuJ3QgYWJsZSB0byBkZWxldGUgY2FjaGVkIHJldmlldyBzdWJtaXNzaW9uIG9mIElEOiAke2lkfWAsIGVycm9yKSk7XHJcbiAgfVxyXG5cclxuICBzdWJtaXRDYWNoZWRSZXZpZXcocmVzdGF1cmFudF9pZCkge1xyXG4gICAgdGhpcy5kYlByb21pc2UudGhlbihkYiA9PiB7XHJcbiAgICAgIHJldHVybiBkYi50cmFuc2FjdGlvbigncmV2aWV3cy10by1zdWJtaXQnKS5vYmplY3RTdG9yZSgncmV2aWV3cy10by1zdWJtaXQnKS5pbmRleCgncmVzdGF1cmFudF9pZCcpLmdldEFsbChyZXN0YXVyYW50X2lkKTtcclxuICAgIH0pLnRoZW4oY2FjaGVkUmV2aWV3cyA9PiB7XHJcblxyXG4gICAgICAvL1RoZXJlIGFyZSBubyBjYWNoZWQgcmV2aWV3cyB3YWl0aW5nIGZvciBzdWJtaXNzaW9uXHJcbiAgICAgIGlmICghY2FjaGVkUmV2aWV3cy5sZW5ndGgpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGZvciAoY29uc3QgY2FjaGVkUmV2aWV3IG9mIGNhY2hlZFJldmlld3MpIHtcclxuXHJcbiAgICAgICAgdGhpcy5zdWJtaXRSZXZpZXcoY2FjaGVkUmV2aWV3LCAoW29rID0gZmFsc2UsIHJldmlld10gPSBbXSkgPT4ge1xyXG5cclxuICAgICAgICAgIGlmIChvaykge1xyXG4gICAgICAgICAgICB0aGlzLmRlbGV0ZUNhY2hlZFJldmlldyhjYWNoZWRSZXZpZXcuaWQpO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG5cclxuICAgIH0pLmNhdGNoKGVycm9yID0+IGNvbnNvbGUuaW5mbyhgV2Fzbid0IGFibGUgZ2V0IGNhY2hlZCByZXZpZXcgc3VibWlzc2lvbnMgb2YgcmVzdGF1cmFudCBJRDogJHtyZXN0YXVyYW50X2lkfWAsIGVycm9yKSk7XHJcbiAgfVxyXG5cclxufVxyXG4iLCJjbGFzcyBTZXJ2aWNlV29ya2VyQ29udHJvbGxlciB7XHJcblxyXG4gIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgdGhpcy5fcmVnaXN0ZXJTZXJ2aWNlV29ya2VyKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiAgUmVnaXN0ZXIgdGhlIFNlcnZpY2UgV29ya2VyXHJcbiAgICovXHJcbiAgX3JlZ2lzdGVyU2VydmljZVdvcmtlcigpIHtcclxuICAgIGlmICghbmF2aWdhdG9yLnNlcnZpY2VXb3JrZXIpIHJldHVybjtcclxuICAgIG5hdmlnYXRvci5zZXJ2aWNlV29ya2VyLnJlZ2lzdGVyKCdzdy5qcycpO1xyXG4gIH1cclxufVxyXG5cclxubmV3IFNlcnZpY2VXb3JrZXJDb250cm9sbGVyKCk7XHJcbiJdfQ==
