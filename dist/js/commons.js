"use strict";!function(){function u(n){return new Promise(function(e,t){n.onsuccess=function(){e(n.result)},n.onerror=function(){t(n.error)}})}function i(n,o,r){var i,e=new Promise(function(e,t){u(i=n[o].apply(n,r)).then(e,t)});return e.request=i,e}function e(e,n,t){t.forEach(function(t){Object.defineProperty(e.prototype,t,{get:function(){return this[n][t]},set:function(e){this[n][t]=e}})})}function t(t,n,o,e){e.forEach(function(e){e in o.prototype&&(t.prototype[e]=function(){return i(this[n],e,arguments)})})}function n(t,n,o,e){e.forEach(function(e){e in o.prototype&&(t.prototype[e]=function(){return this[n][e].apply(this[n],arguments)})})}function o(e,o,t,n){n.forEach(function(n){n in t.prototype&&(e.prototype[n]=function(){return e=this[o],(t=i(e,n,arguments)).then(function(e){if(e)return new c(e,t.request)});var e,t})})}function r(e){this._index=e}function c(e,t){this._cursor=e,this._request=t}function s(e){this._store=e}function a(n){this._tx=n,this.complete=new Promise(function(e,t){n.oncomplete=function(){e()},n.onerror=function(){t(n.error)},n.onabort=function(){t(n.error)}})}function p(e,t,n){this._db=e,this.oldVersion=t,this.transaction=new a(n)}function f(e){this._db=e}e(r,"_index",["name","keyPath","multiEntry","unique"]),t(r,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),o(r,"_index",IDBIndex,["openCursor","openKeyCursor"]),e(c,"_cursor",["direction","key","primaryKey","value"]),t(c,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach(function(n){n in IDBCursor.prototype&&(c.prototype[n]=function(){var t=this,e=arguments;return Promise.resolve().then(function(){return t._cursor[n].apply(t._cursor,e),u(t._request).then(function(e){if(e)return new c(e,t._request)})})})}),s.prototype.createIndex=function(){return new r(this._store.createIndex.apply(this._store,arguments))},s.prototype.index=function(){return new r(this._store.index.apply(this._store,arguments))},e(s,"_store",["name","keyPath","indexNames","autoIncrement"]),t(s,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),o(s,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),n(s,"_store",IDBObjectStore,["deleteIndex"]),a.prototype.objectStore=function(){return new s(this._tx.objectStore.apply(this._tx,arguments))},e(a,"_tx",["objectStoreNames","mode"]),n(a,"_tx",IDBTransaction,["abort"]),p.prototype.createObjectStore=function(){return new s(this._db.createObjectStore.apply(this._db,arguments))},e(p,"_db",["name","version","objectStoreNames"]),n(p,"_db",IDBDatabase,["deleteObjectStore","close"]),f.prototype.transaction=function(){return new a(this._db.transaction.apply(this._db,arguments))},e(f,"_db",["name","version","objectStoreNames"]),n(f,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach(function(i){[s,r].forEach(function(e){e.prototype[i.replace("open","iterate")]=function(){var e,t=(e=arguments,Array.prototype.slice.call(e)),n=t[t.length-1],o=this._store||this._index,r=o[i].apply(o,t.slice(0,-1));r.onsuccess=function(){n(r.result)}}})}),[r,s].forEach(function(e){e.prototype.getAll||(e.prototype.getAll=function(e,n){var o=this,r=[];return new Promise(function(t){o.iterateCursor(e,function(e){e?(r.push(e.value),void 0===n||r.length!=n?e.continue():t(r)):t(r)})})})});var d={open:function(e,t,n){var o=i(indexedDB,"open",[e,t]),r=o.request;return r.onupgradeneeded=function(e){n&&n(new p(r.result,e.oldVersion,r.transaction))},o.then(function(e){return new f(e)})},delete:function(e){return i(indexedDB,"deleteDatabase",[e])}};"undefined"!=typeof module?(module.exports=d,module.exports.default=module.exports):self.idb=d}();
"use strict";var _slicedToArray=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,a=void 0;try{for(var o,u=t[Symbol.iterator]();!(r=(o=u.next()).done)&&(n.push(o.value),!e||n.length!==e);r=!0);}catch(t){i=!0,a=t}finally{try{!r&&u.return&&u.return()}finally{if(i)throw a}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},_createClass=function(){function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var DBHelper=function(){function t(){_classCallCheck(this,t),this.dbPromise=idb.open("restaurant-reviews",1,function(t){t.createObjectStore("restaurants",{keyPath:"id"}),t.createObjectStore("reviews",{keyPath:"id"}).createIndex("restaurant_id","restaurant_id"),t.createObjectStore("reviews-to-submit",{keyPath:"cache_id",autoIncrement:!0}).createIndex("restaurant_id","restaurant_id")})}return _createClass(t,[{key:"fetchRestaurants",value:function(e){var n=this;this.dbPromise.then(function(t){return t.transaction("restaurants").objectStore("restaurants").getAll()}).then(function(t){e([!0,t]),fetch(n.DATABASE_URL+"restaurants").then(function(t){return t.json()}).then(function(c){e([!0,c]),n.dbPromise.then(function(t){var e=t.transaction("restaurants","readwrite"),n=e.objectStore("restaurants"),r=!0,i=!1,a=void 0;try{for(var o,u=c[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;n.put(s)}}catch(t){i=!0,a=t}finally{try{!r&&u.return&&u.return()}finally{if(i)throw a}}return e.complete})}).catch(function(t){return e([!1,t])})})}},{key:"fetchRestaurant",value:function(e,n){var r=this;this.dbPromise.then(function(t){return t.transaction("restaurants").objectStore("restaurants").get(parseInt(n))}).then(function(t){e([!0,t]),fetch(r.DATABASE_URL+"restaurants/"+n).then(function(t){return t.json()}).then(function(n){e([!0,n]),r.dbPromise.then(function(t){var e=t.transaction("restaurants","readwrite");return e.objectStore("restaurants").put(n),e.complete})}).catch(function(t){return e([!1,t])})})}},{key:"fetchRestaurantById",value:function(t,a){this.fetchRestaurant(function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=_slicedToArray(t,2),n=e[0],r=void 0!==n&&n,i=e[1];a(r||!r,i)},t)}},{key:"fetchReviewsByRestaurantId",value:function(e,n){var r=this;this.dbPromise.then(function(t){return t.transaction("reviews").objectStore("reviews").index("restaurant_id").getAll(parseInt(e))}).then(function(t){n([!0,t]),fetch(r.DATABASE_URL+"reviews/?restaurant_id="+e).then(function(t){return t.json()}).then(function(c){n([!0,c]),r.dbPromise.then(function(t){var e=t.transaction("reviews","readwrite"),n=e.objectStore("reviews"),r=!0,i=!1,a=void 0;try{for(var o,u=c[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;n.put(s)}}catch(t){i=!0,a=t}finally{try{!r&&u.return&&u.return()}finally{if(i)throw a}}return e.complete})}).catch(function(t){return n([!1,t])})})}},{key:"fetchRestaurantByCuisine",value:function(o,u){this.fetchRestaurants(function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=_slicedToArray(t,2),n=e[0],r=void 0!==n&&n,i=e[1];if(r){var a=i.filter(function(t){return t.cuisine_type==o});u(r,a)}else u(!r,i)})}},{key:"fetchRestaurantByNeighborhood",value:function(o,u){this.fetchRestaurants(function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=_slicedToArray(t,2),n=e[0],r=void 0!==n&&n,i=e[1];if(r){var a=i.filter(function(t){return t.neighborhood==o});u(r,a)}else u(!r,i)})}},{key:"fetchRestaurantByCuisineAndNeighborhood",value:function(o,u,s){this.fetchRestaurants(function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=_slicedToArray(t,2),n=e[0],r=void 0!==n&&n,i=e[1];if(r){var a=i;"all"!=o&&(a=a.filter(function(t){return t.cuisine_type==o})),"all"!=u&&(a=a.filter(function(t){return t.neighborhood==u})),s(r,a)}else s(!r,i)})}},{key:"fetchNeighborhoods",value:function(u){this.fetchRestaurants(function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=_slicedToArray(t,2),n=e[0],r=void 0!==n&&n,i=e[1];if(r){var a=i.map(function(t,e){return i[e].neighborhood}),o=a.filter(function(t,e){return a.indexOf(t)==e});u(r,o)}else u(!r,i)})}},{key:"fetchCuisines",value:function(u){this.fetchRestaurants(function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=_slicedToArray(t,2),n=e[0],r=void 0!==n&&n,i=e[1];if(r){var a=i.map(function(t,e){return i[e].cuisine_type}),o=a.filter(function(t,e){return a.indexOf(t)==e});u(r,o)}else u(!r,i)})}},{key:"urlForRestaurant",value:function(t){return"./restaurant.html?id="+t.id}},{key:"imageUrlForRestaurant",value:function(t){return"/img/"+t.photograph+".jpf"}},{key:"imageNameForRestaurant",value:function(t){return(t.photograph||"5.jpf").replace(/\.jpf$/,"")}},{key:"mapMarkerForRestaurant",value:function(t,e){return new google.maps.Marker({position:t.latlng,title:t.name,url:this.urlForRestaurant(t),map:e,animation:google.maps.Animation.DROP})}},{key:"submitReview",value:function(t,e){fetch(this.DATABASE_URL+"reviews",{method:"POST",headers:new Headers({"Content-Type":"application/json"}),body:JSON.stringify(t)}).then(function(t){return t.json()}).then(function(t){e([!0,t])}).catch(function(t){return e([!1,t])})}},{key:"cacheReviewSubmission",value:function(e){this.dbPromise.then(function(t){return t.transaction("reviews-to-submit","readwrite").objectStore("reviews-to-submit").put(e)}).catch(function(t){return console.error("Wasn't able to cache review submission")})}},{key:"deleteCachedReview",value:function(e){return this.dbPromise.then(function(t){return t.transaction("reviews-to-submit","readwrite").objectStore("reviews-to-submit").delete(e)}).catch(function(t){return console.error("Wasn't able to delete cached review submission of ID: "+e,t)})}},{key:"submitCachedReview",value:function(e){var u=this;this.dbPromise.then(function(t){return t.transaction("reviews-to-submit").objectStore("reviews-to-submit").index("restaurant_id").getAll(e)}).then(function(t){if(t.length){var e=!0,n=!1,r=void 0;try{for(var a,i=function(){var i=a.value;u.submitReview(i,function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=_slicedToArray(t,2),n=e[0],r=void 0!==n&&n;e[1];r&&u.deleteCachedReview(i.cache_id)})},o=t[Symbol.iterator]();!(e=(a=o.next()).done);e=!0)i()}catch(t){n=!0,r=t}finally{try{!e&&o.return&&o.return()}finally{if(n)throw r}}}}).catch(function(t){return console.info("Wasn't able get cached review submissions of restaurant ID: "+e,t)})}},{key:"DATABASE_URL",get:function(){return"//localhost:1337/"}}]),t}();
"use strict";var _createClass=function(){function t(e,r){for(var n=0;n<r.length;n++){var t=r[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}var ServiceWorkerController=function(){function e(){_classCallCheck(this,e),this._registerServiceWorker()}return _createClass(e,[{key:"_registerServiceWorker",value:function(){navigator.serviceWorker&&navigator.serviceWorker.register("sw.js")}}]),e}();new ServiceWorkerController;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImlkYi5qcyIsImRiaGVscGVyLmpzIiwiU2VydmljZVdvcmtlckNvbnRyb2xsZXIuanMiXSwibmFtZXMiOlsicHJvbWlzaWZ5UmVxdWVzdCIsInJlcXVlc3QiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsIm9uc3VjY2VzcyIsInJlc3VsdCIsIm9uZXJyb3IiLCJlcnJvciIsInByb21pc2lmeVJlcXVlc3RDYWxsIiwib2JqIiwibWV0aG9kIiwiYXJncyIsInAiLCJhcHBseSIsInRoZW4iLCJwcm94eVByb3BlcnRpZXMiLCJQcm94eUNsYXNzIiwidGFyZ2V0UHJvcCIsInByb3BlcnRpZXMiLCJmb3JFYWNoIiwicHJvcCIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwicHJvdG90eXBlIiwiZ2V0IiwidGhpcyIsInNldCIsInZhbCIsInByb3h5UmVxdWVzdE1ldGhvZHMiLCJDb25zdHJ1Y3RvciIsImFyZ3VtZW50cyIsInByb3h5TWV0aG9kcyIsInByb3h5Q3Vyc29yUmVxdWVzdE1ldGhvZHMiLCJ2YWx1ZSIsIkN1cnNvciIsIkluZGV4IiwiaW5kZXgiLCJfaW5kZXgiLCJfY3Vyc29yIiwiY3Vyc29yIiwiY29tcGxldGUiLCJzdG9yZSIsImlkYlRyYW5zYWN0aW9uIiwiVHJhbnNhY3Rpb24iLCJfdHgiLCJvbmNvbXBsZXRlIiwib25hYm9ydCIsIk9iamVjdFN0b3JlIiwiaXRlbXMiLCJkYiIsIm9sZFZlcnNpb24iLCJ0cmFuc2FjdGlvbiIsIl9kYiIsImluc3RhbmNlIiwiaXRlcmF0ZUN1cnNvciIsIm9wZW4iLCJEQiIsIklEQkluZGV4IiwiSURCQ3Vyc29yIiwibWV0aG9kTmFtZSIsIl9yZXF1ZXN0IiwiSURCT2JqZWN0U3RvcmUiLCJfc3RvcmUiLCJJREJUcmFuc2FjdGlvbiIsIlVwZ3JhZGVEQiIsIm5hdGl2ZU9iamVjdCIsImZ1bmNOYW1lIiwib2JqZWN0U3RvcmUiLCJjcmVhdGVPYmplY3RTdG9yZSIsImNvdW50IiwidW5kZWZpbmVkIiwiSURCRGF0YWJhc2UiLCJvbnVwZ3JhZGVuZWVkZWQiLCJ1cGdyYWRlQ2FsbGJhY2siLCJkZWxldGUiLCJtb2R1bGUiLCJleHBvcnRzIiwiZGVmYXVsdCIsInJlcGxhY2UiLCJzZWxmIiwiYXJyIiwiQXJyYXkiLCJzbGljZSIsImNhbGwiLCJjYWxsYmFjayIsImxlbmd0aCIsImdldEFsbCIsInF1ZXJ5IiwicHVzaCIsImNvbnRpbnVlIiwiZXhwIiwibmFtZSIsInZlcnNpb24iLCJpbmRleGVkREIiLCJldmVudCIsImlkYiIsIkRCSGVscGVyIiwiX2NsYXNzQ2FsbENoZWNrIiwiZGJQcm9taXNlIiwidXBncmFkZURiIiwia2V5UGF0aCIsImNyZWF0ZUluZGV4IiwiX3RoaXMiLCJyZXN0YXVyYW50cyIsImZldGNoIiwiREFUQUJBU0VfVVJMIiwicmVzcG9uc2UiLCJqc29uIiwiZGF0YSIsInR4IiwiX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiIsIl9kaWRJdGVyYXRvckVycm9yIiwiX2l0ZXJhdG9yRXJyb3IiLCJfc3RlcCIsImVyciIsIl9pdGVyYXRvciIsInJldHVybiIsImNhdGNoIiwiaWQiLCJfdGhpczIiLCJyZXN0YXVyYW50IiwicGFyc2VJbnQiLCJwdXQiLCJmZXRjaFJlc3RhdXJhbnQiLCJfcmVmIiwiX3JlZjIiLCJfc2xpY2VkVG9BcnJheSIsIl9yZWYyJCIsIm9rIiwicmVzdGF1cmFudF9pZCIsIl90aGlzMyIsInJldmlld3MiLCJfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMiIsIl9kaWRJdGVyYXRvckVycm9yMiIsIl9pdGVyYXRvckVycm9yMiIsIl9zdGVwMiIsIl9pdGVyYXRvcjIiLCJTeW1ib2wiLCJpdGVyYXRvciIsIm5leHQiLCJkb25lIiwicmV2aWV3IiwiY3Vpc2luZSIsImZldGNoUmVzdGF1cmFudHMiLCJfcmVmMyIsIl9yZWY0IiwiX3JlZjQkIiwicmVzdWx0cyIsImZpbHRlciIsInIiLCJjdWlzaW5lX3R5cGUiLCJuZWlnaGJvcmhvb2QiLCJfcmVmNSIsIl9yZWY2IiwiX3JlZjYkIiwiX3JlZjciLCJfcmVmOCIsIl9yZWY4JCIsIl9yZWY5IiwiX3JlZjEwIiwiX3JlZjEwJCIsIm5laWdoYm9yaG9vZHMiLCJtYXAiLCJ2IiwiaSIsInVuaXF1ZU5laWdoYm9yaG9vZHMiLCJpbmRleE9mIiwiY3Vpc2luZXMiLCJ1bmlxdWVDdWlzaW5lcyIsInBob3RvZ3JhcGgiLCJnb29nbGUiLCJtYXBzIiwiTWFya2VyIiwicG9zaXRpb24iLCJsYXRsbmciLCJ1cmwiLCJ1cmxGb3JSZXN0YXVyYW50IiwiYW5pbWF0aW9uIiwiRFJPUCIsImpzb25Gb3JtRGF0YSIsImhlYWRlcnMiLCJIZWFkZXJzIiwiQ29udGVudC1UeXBlIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJyYXdEYXRhIiwibmV3UmV2aWV3IiwiY2FjaGVfaWQiLCJjb25zb2xlIiwiX3RoaXM0IiwiY2FjaGVkUmV2aWV3cyIsIl9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24zIiwiX2RpZEl0ZXJhdG9yRXJyb3IzIiwiX2l0ZXJhdG9yRXJyb3IzIiwiX3N0ZXAzIiwiX2xvb3AiLCJjYWNoZWRSZXZpZXciLCJzdWJtaXRSZXZpZXciLCJfcmVmMTMiLCJfcmVmMTQiLCJfcmVmMTQkIiwiX2l0ZXJhdG9yMyIsImluZm8iLCJTZXJ2aWNlV29ya2VyQ29udHJvbGxlciIsIl9yZWdpc3RlclNlcnZpY2VXb3JrZXIiLCJuYXZpZ2F0b3IiLCJzZXJ2aWNlV29ya2VyIiwicmVnaXN0ZXIiXSwibWFwcGluZ3MiOiJBQUFBLGNBRUMsV0FLQyxTQUFTQSxFQUFpQkMsR0FDeEIsT0FBTyxJQUFJQyxRQUFRLFNBQUFDLEVBQUFDLEdBQ2pCSCxFQUFRSSxVQUFZLFdBQ2xCRixFQUFRRixFQUFRSyxTQUdsQkwsRUFBUU0sUUFBVSxXQUNoQkgsRUFBT0gsRUFBUU8sVUFLckIsU0FBU0MsRUFBcUJDLEVBQUtDLEVBQVFDLEdBQ3pDLElBQUlYLEVBQ0FZLEVBQUksSUFBSVgsUUFBUSxTQUFBQyxFQUFBQyxHQUVsQkosRUFEQUMsRUFBVVMsRUFBSUMsR0FBUUcs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QUFuQixDQTlHQyxJQUFBMkcsR0FBQSxFQUFBQyxHQUFBLEVBQUFDLE9BQUE1SCxFQUFBLElBa0hELElBbEhDLElBa0hENkgsRUFsSENDLEVBQUEsV0FBQSxJQWtIVUMsRUFsSFZGLEVBQUFsSyxNQW9IQzZKLEVBQUtRLGFBQWFELEVBQWMsV0FBK0IsSUFBQUUsRUFBQSxFQUFBekssVUFBQXVELGFBQUFmLElBQUF4QyxVQUFBLEdBQUFBLFVBQUEsR0FBUCxHQUFPMEssRUFBQTFFLGVBQUF5RSxFQUFBLEdBQUFFLEVBQUFELEVBQUEsR0FBN0J4RSxPQUE2QjFELElBQUFtSSxHQUFBQSxFQUFBRCxFQUFBLEdBNUduRXhFLEdBQ0tlLEVBQUFBLG1CQUFpQnNELEVBQWlDVCxhQXlHckRjLEVBQTJCWCxFQUEzQnRELE9BQUFDLGNBQUFzRCxHQUFBRyxFQUFBTyxFQUFBL0QsUUFBQUMsTUFBQW9ELEdBQUEsRUFBMENJLElBbEh6QyxNQUFBbEYsR0FBQStFLEdBQUEsRUFBQUMsRUFBQWhGLEVBQUEsUUFBQSxLQUFBOEUsR0FBQVUsRUFBQXRGLFFBQUFzRixFQUFBdEYsU0FBQSxRQUFBLEdBQUE2RSxFQUFBLE1BQUFDLE9BNkhBN0UsTUFBTSxTQUFBOUcsR0FBQSxPQUFTc0wsUUFBUWMsS0FBUiwrREFBNEUxRSxFQUFpQjFILDBDQXpTOUcsTUFBQTtpWUNwQkNxTSxtQ0FFSixTQUFBQSxJQUFjM0csZ0JBQUF4RSxLQUFBbUwsR0FDWm5MLEtBQUtvTCwrRkFBQUEsVUFBQUEsZUFDTkMsVUFBQUMsY0FBQUMsU0FBQSxrQkFXSCxJQUFJSiIsImZpbGUiOiJjb21tb25zLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xyXG5cclxuKGZ1bmN0aW9uKCkge1xyXG4gIGZ1bmN0aW9uIHRvQXJyYXkoYXJyKSB7XHJcbiAgICByZXR1cm4gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJyKTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHByb21pc2lmeVJlcXVlc3QocmVxdWVzdCkge1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICByZXF1ZXN0Lm9uc3VjY2VzcyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJlc29sdmUocmVxdWVzdC5yZXN1bHQpO1xyXG4gICAgICB9O1xyXG5cclxuICAgICAgcmVxdWVzdC5vbmVycm9yID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmVqZWN0KHJlcXVlc3QuZXJyb3IpO1xyXG4gICAgICB9O1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBwcm9taXNpZnlSZXF1ZXN0Q2FsbChvYmosIG1ldGhvZCwgYXJncykge1xyXG4gICAgdmFyIHJlcXVlc3Q7XHJcbiAgICB2YXIgcCA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICByZXF1ZXN0ID0gb2JqW21ldGhvZF0uYXBwbHkob2JqLCBhcmdzKTtcclxuICAgICAgcHJvbWlzaWZ5UmVxdWVzdChyZXF1ZXN0KS50aGVuKHJlc29sdmUsIHJlamVjdCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBwLnJlcXVlc3QgPSByZXF1ZXN0O1xyXG4gICAgcmV0dXJuIHA7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBwcm9taXNpZnlDdXJzb3JSZXF1ZXN0Q2FsbChvYmosIG1ldGhvZCwgYXJncykge1xyXG4gICAgdmFyIHAgPSBwcm9taXNpZnlSZXF1ZXN0Q2FsbChvYmosIG1ldGhvZCwgYXJncyk7XHJcbiAgICByZXR1cm4gcC50aGVuKGZ1bmN0aW9uKHZhbHVlKSB7XHJcbiAgICAgIGlmICghdmFsdWUpIHJldHVybjtcclxuICAgICAgcmV0dXJuIG5ldyBDdXJzb3IodmFsdWUsIHAucmVxdWVzdCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHByb3h5UHJvcGVydGllcyhQcm94eUNsYXNzLCB0YXJnZXRQcm9wLCBwcm9wZXJ0aWVzKSB7XHJcbiAgICBwcm9wZXJ0aWVzLmZvckVhY2goZnVuY3Rpb24ocHJvcCkge1xyXG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUHJveHlDbGFzcy5wcm90b3R5cGUsIHByb3AsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgcmV0dXJuIHRoaXNbdGFyZ2V0UHJvcF1bcHJvcF07XHJcbiAgICAgICAgfSxcclxuICAgICAgICBzZXQ6IGZ1bmN0aW9uKHZhbCkge1xyXG4gICAgICAgICAgdGhpc1t0YXJnZXRQcm9wXVtwcm9wXSA9IHZhbDtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBwcm94eVJlcXVlc3RNZXRob2RzKFByb3h5Q2xhc3MsIHRhcmdldFByb3AsIENvbnN0cnVjdG9yLCBwcm9wZXJ0aWVzKSB7XHJcbiAgICBwcm9wZXJ0aWVzLmZvckVhY2goZnVuY3Rpb24ocHJvcCkge1xyXG4gICAgICBpZiAoIShwcm9wIGluIENvbnN0cnVjdG9yLnByb3RvdHlwZSkpIHJldHVybjtcclxuICAgICAgUHJveHlDbGFzcy5wcm90b3R5cGVbcHJvcF0gPSBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gcHJvbWlzaWZ5UmVxdWVzdENhbGwodGhpc1t0YXJnZXRQcm9wXSwgcHJvcCwgYXJndW1lbnRzKTtcclxuICAgICAgfTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gcHJveHlNZXRob2RzKFByb3h5Q2xhc3MsIHRhcmdldFByb3AsIENvbnN0cnVjdG9yLCBwcm9wZXJ0aWVzKSB7XHJcbiAgICBwcm9wZXJ0aWVzLmZvckVhY2goZnVuY3Rpb24ocHJvcCkge1xyXG4gICAgICBpZiAoIShwcm9wIGluIENvbnN0cnVjdG9yLnByb3RvdHlwZSkpIHJldHVybjtcclxuICAgICAgUHJveHlDbGFzcy5wcm90b3R5cGVbcHJvcF0gPSBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gdGhpc1t0YXJnZXRQcm9wXVtwcm9wXS5hcHBseSh0aGlzW3RhcmdldFByb3BdLCBhcmd1bWVudHMpO1xyXG4gICAgICB9O1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBwcm94eUN1cnNvclJlcXVlc3RNZXRob2RzKFByb3h5Q2xhc3MsIHRhcmdldFByb3AsIENvbnN0cnVjdG9yLCBwcm9wZXJ0aWVzKSB7XHJcbiAgICBwcm9wZXJ0aWVzLmZvckVhY2goZnVuY3Rpb24ocHJvcCkge1xyXG4gICAgICBpZiAoIShwcm9wIGluIENvbnN0cnVjdG9yLnByb3RvdHlwZSkpIHJldHVybjtcclxuICAgICAgUHJveHlDbGFzcy5wcm90b3R5cGVbcHJvcF0gPSBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gcHJvbWlzaWZ5Q3Vyc29yUmVxdWVzdENhbGwodGhpc1t0YXJnZXRQcm9wXSwgcHJvcCwgYXJndW1lbnRzKTtcclxuICAgICAgfTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gSW5kZXgoaW5kZXgpIHtcclxuICAgIHRoaXMuX2luZGV4ID0gaW5kZXg7XHJcbiAgfVxyXG5cclxuICBwcm94eVByb3BlcnRpZXMoSW5kZXgsICdfaW5kZXgnLCBbXHJcbiAgICAnbmFtZScsXHJcbiAgICAna2V5UGF0aCcsXHJcbiAgICAnbXVsdGlFbnRyeScsXHJcbiAgICAndW5pcXVlJ1xyXG4gIF0pO1xyXG5cclxuICBwcm94eVJlcXVlc3RNZXRob2RzKEluZGV4LCAnX2luZGV4JywgSURCSW5kZXgsIFtcclxuICAgICdnZXQnLFxyXG4gICAgJ2dldEtleScsXHJcbiAgICAnZ2V0QWxsJyxcclxuICAgICdnZXRBbGxLZXlzJyxcclxuICAgICdjb3VudCdcclxuICBdKTtcclxuXHJcbiAgcHJveHlDdXJzb3JSZXF1ZXN0TWV0aG9kcyhJbmRleCwgJ19pbmRleCcsIElEQkluZGV4LCBbXHJcbiAgICAnb3BlbkN1cnNvcicsXHJcbiAgICAnb3BlbktleUN1cnNvcidcclxuICBdKTtcclxuXHJcbiAgZnVuY3Rpb24gQ3Vyc29yKGN1cnNvciwgcmVxdWVzdCkge1xyXG4gICAgdGhpcy5fY3Vyc29yID0gY3Vyc29yO1xyXG4gICAgdGhpcy5fcmVxdWVzdCA9IHJlcXVlc3Q7XHJcbiAgfVxyXG5cclxuICBwcm94eVByb3BlcnRpZXMoQ3Vyc29yLCAnX2N1cnNvcicsIFtcclxuICAgICdkaXJlY3Rpb24nLFxyXG4gICAgJ2tleScsXHJcbiAgICAncHJpbWFyeUtleScsXHJcbiAgICAndmFsdWUnXHJcbiAgXSk7XHJcblxyXG4gIHByb3h5UmVxdWVzdE1ldGhvZHMoQ3Vyc29yLCAnX2N1cnNvcicsIElEQkN1cnNvciwgW1xyXG4gICAgJ3VwZGF0ZScsXHJcbiAgICAnZGVsZXRlJ1xyXG4gIF0pO1xyXG5cclxuICAvLyBwcm94eSAnbmV4dCcgbWV0aG9kc1xyXG4gIFsnYWR2YW5jZScsICdjb250aW51ZScsICdjb250aW51ZVByaW1hcnlLZXknXS5mb3JFYWNoKGZ1bmN0aW9uKG1ldGhvZE5hbWUpIHtcclxuICAgIGlmICghKG1ldGhvZE5hbWUgaW4gSURCQ3Vyc29yLnByb3RvdHlwZSkpIHJldHVybjtcclxuICAgIEN1cnNvci5wcm90b3R5cGVbbWV0aG9kTmFtZV0gPSBmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIGN1cnNvciA9IHRoaXM7XHJcbiAgICAgIHZhciBhcmdzID0gYXJndW1lbnRzO1xyXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCkudGhlbihmdW5jdGlvbigpIHtcclxuICAgICAgICBjdXJzb3IuX2N1cnNvclttZXRob2ROYW1lXS5hcHBseShjdXJzb3IuX2N1cnNvciwgYXJncyk7XHJcbiAgICAgICAgcmV0dXJuIHByb21pc2lmeVJlcXVlc3QoY3Vyc29yLl9yZXF1ZXN0KS50aGVuKGZ1bmN0aW9uKHZhbHVlKSB7XHJcbiAgICAgICAgICBpZiAoIXZhbHVlKSByZXR1cm47XHJcbiAgICAgICAgICByZXR1cm4gbmV3IEN1cnNvcih2YWx1ZSwgY3Vyc29yLl9yZXF1ZXN0KTtcclxuICAgICAgICB9KTtcclxuICAgICAgfSk7XHJcbiAgICB9O1xyXG4gIH0pO1xyXG5cclxuICBmdW5jdGlvbiBPYmplY3RTdG9yZShzdG9yZSkge1xyXG4gICAgdGhpcy5fc3RvcmUgPSBzdG9yZTtcclxuICB9XHJcblxyXG4gIE9iamVjdFN0b3JlLnByb3RvdHlwZS5jcmVhdGVJbmRleCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgcmV0dXJuIG5ldyBJbmRleCh0aGlzLl9zdG9yZS5jcmVhdGVJbmRleC5hcHBseSh0aGlzLl9zdG9yZSwgYXJndW1lbnRzKSk7XHJcbiAgfTtcclxuXHJcbiAgT2JqZWN0U3RvcmUucHJvdG90eXBlLmluZGV4ID0gZnVuY3Rpb24oKSB7XHJcbiAgICByZXR1cm4gbmV3IEluZGV4KHRoaXMuX3N0b3JlLmluZGV4LmFwcGx5KHRoaXMuX3N0b3JlLCBhcmd1bWVudHMpKTtcclxuICB9O1xyXG5cclxuICBwcm94eVByb3BlcnRpZXMoT2JqZWN0U3RvcmUsICdfc3RvcmUnLCBbXHJcbiAgICAnbmFtZScsXHJcbiAgICAna2V5UGF0aCcsXHJcbiAgICAnaW5kZXhOYW1lcycsXHJcbiAgICAnYXV0b0luY3JlbWVudCdcclxuICBdKTtcclxuXHJcbiAgcHJveHlSZXF1ZXN0TWV0aG9kcyhPYmplY3RTdG9yZSwgJ19zdG9yZScsIElEQk9iamVjdFN0b3JlLCBbXHJcbiAgICAncHV0JyxcclxuICAgICdhZGQnLFxyXG4gICAgJ2RlbGV0ZScsXHJcbiAgICAnY2xlYXInLFxyXG4gICAgJ2dldCcsXHJcbiAgICAnZ2V0QWxsJyxcclxuICAgICdnZXRLZXknLFxyXG4gICAgJ2dldEFsbEtleXMnLFxyXG4gICAgJ2NvdW50J1xyXG4gIF0pO1xyXG5cclxuICBwcm94eUN1cnNvclJlcXVlc3RNZXRob2RzKE9iamVjdFN0b3JlLCAnX3N0b3JlJywgSURCT2JqZWN0U3RvcmUsIFtcclxuICAgICdvcGVuQ3Vyc29yJyxcclxuICAgICdvcGVuS2V5Q3Vyc29yJ1xyXG4gIF0pO1xyXG5cclxuICBwcm94eU1ldGhvZHMoT2JqZWN0U3RvcmUsICdfc3RvcmUnLCBJREJPYmplY3RTdG9yZSwgW1xyXG4gICAgJ2RlbGV0ZUluZGV4J1xyXG4gIF0pO1xyXG5cclxuICBmdW5jdGlvbiBUcmFuc2FjdGlvbihpZGJUcmFuc2FjdGlvbikge1xyXG4gICAgdGhpcy5fdHggPSBpZGJUcmFuc2FjdGlvbjtcclxuICAgIHRoaXMuY29tcGxldGUgPSBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgaWRiVHJhbnNhY3Rpb24ub25jb21wbGV0ZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJlc29sdmUoKTtcclxuICAgICAgfTtcclxuICAgICAgaWRiVHJhbnNhY3Rpb24ub25lcnJvciA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJlamVjdChpZGJUcmFuc2FjdGlvbi5lcnJvcik7XHJcbiAgICAgIH07XHJcbiAgICAgIGlkYlRyYW5zYWN0aW9uLm9uYWJvcnQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICByZWplY3QoaWRiVHJhbnNhY3Rpb24uZXJyb3IpO1xyXG4gICAgICB9O1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBUcmFuc2FjdGlvbi5wcm90b3R5cGUub2JqZWN0U3RvcmUgPSBmdW5jdGlvbigpIHtcclxuICAgIHJldHVybiBuZXcgT2JqZWN0U3RvcmUodGhpcy5fdHgub2JqZWN0U3RvcmUuYXBwbHkodGhpcy5fdHgsIGFyZ3VtZW50cykpO1xyXG4gIH07XHJcblxyXG4gIHByb3h5UHJvcGVydGllcyhUcmFuc2FjdGlvbiwgJ190eCcsIFtcclxuICAgICdvYmplY3RTdG9yZU5hbWVzJyxcclxuICAgICdtb2RlJ1xyXG4gIF0pO1xyXG5cclxuICBwcm94eU1ldGhvZHMoVHJhbnNhY3Rpb24sICdfdHgnLCBJREJUcmFuc2FjdGlvbiwgW1xyXG4gICAgJ2Fib3J0J1xyXG4gIF0pO1xyXG5cclxuICBmdW5jdGlvbiBVcGdyYWRlREIoZGIsIG9sZFZlcnNpb24sIHRyYW5zYWN0aW9uKSB7XHJcbiAgICB0aGlzLl9kYiA9IGRiO1xyXG4gICAgdGhpcy5vbGRWZXJzaW9uID0gb2xkVmVyc2lvbjtcclxuICAgIHRoaXMudHJhbnNhY3Rpb24gPSBuZXcgVHJhbnNhY3Rpb24odHJhbnNhY3Rpb24pO1xyXG4gIH1cclxuXHJcbiAgVXBncmFkZURCLnByb3RvdHlwZS5jcmVhdGVPYmplY3RTdG9yZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgcmV0dXJuIG5ldyBPYmplY3RTdG9yZSh0aGlzLl9kYi5jcmVhdGVPYmplY3RTdG9yZS5hcHBseSh0aGlzLl9kYiwgYXJndW1lbnRzKSk7XHJcbiAgfTtcclxuXHJcbiAgcHJveHlQcm9wZXJ0aWVzKFVwZ3JhZGVEQiwgJ19kYicsIFtcclxuICAgICduYW1lJyxcclxuICAgICd2ZXJzaW9uJyxcclxuICAgICdvYmplY3RTdG9yZU5hbWVzJ1xyXG4gIF0pO1xyXG5cclxuICBwcm94eU1ldGhvZHMoVXBncmFkZURCLCAnX2RiJywgSURCRGF0YWJhc2UsIFtcclxuICAgICdkZWxldGVPYmplY3RTdG9yZScsXHJcbiAgICAnY2xvc2UnXHJcbiAgXSk7XHJcblxyXG4gIGZ1bmN0aW9uIERCKGRiKSB7XHJcbiAgICB0aGlzLl9kYiA9IGRiO1xyXG4gIH1cclxuXHJcbiAgREIucHJvdG90eXBlLnRyYW5zYWN0aW9uID0gZnVuY3Rpb24oKSB7XHJcbiAgICByZXR1cm4gbmV3IFRyYW5zYWN0aW9uKHRoaXMuX2RiLnRyYW5zYWN0aW9uLmFwcGx5KHRoaXMuX2RiLCBhcmd1bWVudHMpKTtcclxuICB9O1xyXG5cclxuICBwcm94eVByb3BlcnRpZXMoREIsICdfZGInLCBbXHJcbiAgICAnbmFtZScsXHJcbiAgICAndmVyc2lvbicsXHJcbiAgICAnb2JqZWN0U3RvcmVOYW1lcydcclxuICBdKTtcclxuXHJcbiAgcHJveHlNZXRob2RzKERCLCAnX2RiJywgSURCRGF0YWJhc2UsIFtcclxuICAgICdjbG9zZSdcclxuICBdKTtcclxuXHJcbiAgLy8gQWRkIGN1cnNvciBpdGVyYXRvcnNcclxuICAvLyBUT0RPOiByZW1vdmUgdGhpcyBvbmNlIGJyb3dzZXJzIGRvIHRoZSByaWdodCB0aGluZyB3aXRoIHByb21pc2VzXHJcbiAgWydvcGVuQ3Vyc29yJywgJ29wZW5LZXlDdXJzb3InXS5mb3JFYWNoKGZ1bmN0aW9uKGZ1bmNOYW1lKSB7XHJcbiAgICBbT2JqZWN0U3RvcmUsIEluZGV4XS5mb3JFYWNoKGZ1bmN0aW9uKENvbnN0cnVjdG9yKSB7XHJcbiAgICAgIENvbnN0cnVjdG9yLnByb3RvdHlwZVtmdW5jTmFtZS5yZXBsYWNlKCdvcGVuJywgJ2l0ZXJhdGUnKV0gPSBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgYXJncyA9IHRvQXJyYXkoYXJndW1lbnRzKTtcclxuICAgICAgICB2YXIgY2FsbGJhY2sgPSBhcmdzW2FyZ3MubGVuZ3RoIC0gMV07XHJcbiAgICAgICAgdmFyIG5hdGl2ZU9iamVjdCA9IHRoaXMuX3N0b3JlIHx8IHRoaXMuX2luZGV4O1xyXG4gICAgICAgIHZhciByZXF1ZXN0ID0gbmF0aXZlT2JqZWN0W2Z1bmNOYW1lXS5hcHBseShuYXRpdmVPYmplY3QsIGFyZ3Muc2xpY2UoMCwgLTEpKTtcclxuICAgICAgICByZXF1ZXN0Lm9uc3VjY2VzcyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgY2FsbGJhY2socmVxdWVzdC5yZXN1bHQpO1xyXG4gICAgICAgIH07XHJcbiAgICAgIH07XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgLy8gcG9seWZpbGwgZ2V0QWxsXHJcbiAgW0luZGV4LCBPYmplY3RTdG9yZV0uZm9yRWFjaChmdW5jdGlvbihDb25zdHJ1Y3Rvcikge1xyXG4gICAgaWYgKENvbnN0cnVjdG9yLnByb3RvdHlwZS5nZXRBbGwpIHJldHVybjtcclxuICAgIENvbnN0cnVjdG9yLnByb3RvdHlwZS5nZXRBbGwgPSBmdW5jdGlvbihxdWVyeSwgY291bnQpIHtcclxuICAgICAgdmFyIGluc3RhbmNlID0gdGhpcztcclxuICAgICAgdmFyIGl0ZW1zID0gW107XHJcblxyXG4gICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSkge1xyXG4gICAgICAgIGluc3RhbmNlLml0ZXJhdGVDdXJzb3IocXVlcnksIGZ1bmN0aW9uKGN1cnNvcikge1xyXG4gICAgICAgICAgaWYgKCFjdXJzb3IpIHtcclxuICAgICAgICAgICAgcmVzb2x2ZShpdGVtcyk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGl0ZW1zLnB1c2goY3Vyc29yLnZhbHVlKTtcclxuXHJcbiAgICAgICAgICBpZiAoY291bnQgIT09IHVuZGVmaW5lZCAmJiBpdGVtcy5sZW5ndGggPT0gY291bnQpIHtcclxuICAgICAgICAgICAgcmVzb2x2ZShpdGVtcyk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGN1cnNvci5jb250aW51ZSgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuICAgIH07XHJcbiAgfSk7XHJcblxyXG4gIHZhciBleHAgPSB7XHJcbiAgICBvcGVuOiBmdW5jdGlvbihuYW1lLCB2ZXJzaW9uLCB1cGdyYWRlQ2FsbGJhY2spIHtcclxuICAgICAgdmFyIHAgPSBwcm9taXNpZnlSZXF1ZXN0Q2FsbChpbmRleGVkREIsICdvcGVuJywgW25hbWUsIHZlcnNpb25dKTtcclxuICAgICAgdmFyIHJlcXVlc3QgPSBwLnJlcXVlc3Q7XHJcblxyXG4gICAgICByZXF1ZXN0Lm9udXBncmFkZW5lZWRlZCA9IGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgaWYgKHVwZ3JhZGVDYWxsYmFjaykge1xyXG4gICAgICAgICAgdXBncmFkZUNhbGxiYWNrKG5ldyBVcGdyYWRlREIocmVxdWVzdC5yZXN1bHQsIGV2ZW50Lm9sZFZlcnNpb24sIHJlcXVlc3QudHJhbnNhY3Rpb24pKTtcclxuICAgICAgICB9XHJcbiAgICAgIH07XHJcblxyXG4gICAgICByZXR1cm4gcC50aGVuKGZ1bmN0aW9uKGRiKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBEQihkYik7XHJcbiAgICAgIH0pO1xyXG4gICAgfSxcclxuICAgIGRlbGV0ZTogZnVuY3Rpb24obmFtZSkge1xyXG4gICAgICByZXR1cm4gcHJvbWlzaWZ5UmVxdWVzdENhbGwoaW5kZXhlZERCLCAnZGVsZXRlRGF0YWJhc2UnLCBbbmFtZV0pO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIGlmICh0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJykge1xyXG4gICAgbW9kdWxlLmV4cG9ydHMgPSBleHA7XHJcbiAgICBtb2R1bGUuZXhwb3J0cy5kZWZhdWx0ID0gbW9kdWxlLmV4cG9ydHM7XHJcbiAgfSBlbHNlIHtcclxuICAgIHNlbGYuaWRiID0gZXhwO1xyXG4gIH1cclxufSgpKTsiLCIvKmpzaGludCBlc3ZlcnNpb246IDYgKi9cclxuXHJcbi8qKlxyXG4gKiBDb21tb24gZGF0YWJhc2UgaGVscGVyIGZ1bmN0aW9ucy5cclxuICovXHJcbmNsYXNzIERCSGVscGVyIHtcclxuXHJcbiAgY29uc3RydWN0b3IoKSB7XHJcbiAgICB0aGlzLmRiUHJvbWlzZSA9IGlkYi5vcGVuKCdyZXN0YXVyYW50LXJldmlld3MnLCAxLCB1cGdyYWRlRGIgPT4ge1xyXG4gICAgICB1cGdyYWRlRGIuY3JlYXRlT2JqZWN0U3RvcmUoJ3Jlc3RhdXJhbnRzJywge1xyXG4gICAgICAgIGtleVBhdGg6ICdpZCdcclxuICAgICAgfSk7XHJcbiAgICAgIHVwZ3JhZGVEYi5jcmVhdGVPYmplY3RTdG9yZSgncmV2aWV3cycsIHtcclxuICAgICAgICBrZXlQYXRoOiAnaWQnXHJcbiAgICAgIH0pLmNyZWF0ZUluZGV4KCdyZXN0YXVyYW50X2lkJywgJ3Jlc3RhdXJhbnRfaWQnKTtcclxuXHJcbiAgICAgIHVwZ3JhZGVEYi5jcmVhdGVPYmplY3RTdG9yZSgncmV2aWV3cy10by1zdWJtaXQnLCB7XHJcbiAgICAgICAga2V5UGF0aDogJ2NhY2hlX2lkJyxcclxuICAgICAgICBhdXRvSW5jcmVtZW50OiB0cnVlXHJcbiAgICAgIH0pLmNyZWF0ZUluZGV4KCdyZXN0YXVyYW50X2lkJywgJ3Jlc3RhdXJhbnRfaWQnKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRGF0YWJhc2UgVVJMLlxyXG4gICAqIENoYW5nZSB0aGlzIHRvIHJlc3RhdXJhbnRzLmpzb24gZmlsZSBsb2NhdGlvbiBvbiB5b3VyIHNlcnZlci5cclxuICAgKi9cclxuICBnZXQgREFUQUJBU0VfVVJMKCkge1xyXG4gICAgY29uc3QgcG9ydCA9IDEzMzc7IC8vIENoYW5nZSB0aGlzIHRvIHlvdXIgc2VydmVyIHBvcnRcclxuICAgIHJldHVybiBgLy9sb2NhbGhvc3Q6JHtwb3J0fS9gO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRmV0Y2ggYWxsIHJlc3RhdXJhbnRzIGZyb20gREIgaWYgcG9zc2libGUuXHJcbiAgICovXHJcbiAgZmV0Y2hSZXN0YXVyYW50cyhjYWxsYmFjaykge1xyXG5cclxuICAgIC8vIEZpcnN0IGdldCByZXN0YXVyYW50cyBmcm9tIHRoZSBkYXRhYmFzZSBhbmQgdGhlbiBmcm9tIHRoZSB3ZWJcclxuICAgIHRoaXMuZGJQcm9taXNlLnRoZW4oZGIgPT4ge1xyXG5cclxuICAgICAgcmV0dXJuIGRiLnRyYW5zYWN0aW9uKCdyZXN0YXVyYW50cycpLm9iamVjdFN0b3JlKCdyZXN0YXVyYW50cycpLmdldEFsbCgpO1xyXG5cclxuICAgIH0pLnRoZW4ocmVzdGF1cmFudHMgPT4ge1xyXG5cclxuICAgICAgLy8gRGlzcGxheSByZXN0YXVyYW50cyBmcm9tIHRoZSBkYXRhYmFzZVxyXG4gICAgICBjYWxsYmFjayhbdHJ1ZSwgcmVzdGF1cmFudHNdKTtcclxuXHJcbiAgICAgIC8vIEdldCByZXN0YXVyYW50cyBmcm9tIHRoZSB3ZWJcclxuICAgICAgZmV0Y2godGhpcy5EQVRBQkFTRV9VUkwgKyAncmVzdGF1cmFudHMnKVxyXG4gICAgICAgIC50aGVuKHJlc3BvbnNlID0+IHJlc3BvbnNlLmpzb24oKSlcclxuICAgICAgICAudGhlbihkYXRhID0+IHtcclxuICAgICAgICAgIGNhbGxiYWNrKFt0cnVlLCBkYXRhXSk7XHJcblxyXG4gICAgICAgICAgLy8gQWRkIHJlc3RhdXJhbnRzIGZyb20gdGhlIHdlYiB0byB0aGUgZGF0YWJhc2VcclxuICAgICAgICAgIHRoaXMuZGJQcm9taXNlLnRoZW4oZGIgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCB0eCA9IGRiLnRyYW5zYWN0aW9uKCdyZXN0YXVyYW50cycsICdyZWFkd3JpdGUnKTtcclxuICAgICAgICAgICAgY29uc3Qgc3RvcmUgPSB0eC5vYmplY3RTdG9yZSgncmVzdGF1cmFudHMnKTtcclxuXHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgcmVzdGF1cmFudCBvZiBkYXRhKSB7XHJcbiAgICAgICAgICAgICAgc3RvcmUucHV0KHJlc3RhdXJhbnQpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdHguY29tcGxldGU7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5jYXRjaChlcnJvciA9PiBjYWxsYmFjayhbZmFsc2UsIGVycm9yXSkpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBGZXRjaCBhbGwgcmVzdGF1cmFudCBieSBJRCBmcm9tIERCIGlmIHBvc3NpYmxlLlxyXG4gICAqL1xyXG4gIGZldGNoUmVzdGF1cmFudChjYWxsYmFjaywgaWQpIHtcclxuXHJcbiAgICAvLyBGaXJzdCBnZXQgcmVzdGF1cmFudHMgZnJvbSB0aGUgZGF0YWJhc2UgYW5kIHRoZW4gZnJvbSB0aGUgd2ViXHJcbiAgICB0aGlzLmRiUHJvbWlzZS50aGVuKGRiID0+IHtcclxuICAgICAgcmV0dXJuIGRiLnRyYW5zYWN0aW9uKCdyZXN0YXVyYW50cycpLm9iamVjdFN0b3JlKCdyZXN0YXVyYW50cycpLmdldChwYXJzZUludChpZCkpO1xyXG4gICAgfSkudGhlbihyZXN0YXVyYW50ID0+IHtcclxuICAgICAgLy8gRGlzcGxheSByZXN0YXVyYW50cyBmcm9tIHRoZSBkYXRhYmFzZVxyXG4gICAgICBjYWxsYmFjayhbdHJ1ZSwgcmVzdGF1cmFudF0pO1xyXG5cclxuICAgICAgLy8gR2V0IHJlc3RhdXJhbnRzIGZyb20gdGhlIHdlYlxyXG4gICAgICBmZXRjaCh0aGlzLkRBVEFCQVNFX1VSTCArIGByZXN0YXVyYW50cy8ke2lkfWApXHJcbiAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4gcmVzcG9uc2UuanNvbigpKVxyXG4gICAgICAgIC50aGVuKGRhdGEgPT4ge1xyXG4gICAgICAgICAgY2FsbGJhY2soW3RydWUsIGRhdGFdKTtcclxuXHJcbiAgICAgICAgICAvLyBBZGQgcmVzdGF1cmFudHMgZnJvbSB0aGUgd2ViIHRvIHRoZSBkYXRhYmFzZVxyXG4gICAgICAgICAgdGhpcy5kYlByb21pc2UudGhlbihkYiA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHR4ID0gZGIudHJhbnNhY3Rpb24oJ3Jlc3RhdXJhbnRzJywgJ3JlYWR3cml0ZScpO1xyXG4gICAgICAgICAgICB0eC5vYmplY3RTdG9yZSgncmVzdGF1cmFudHMnKS5wdXQoZGF0YSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdHguY29tcGxldGU7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5jYXRjaChlcnJvciA9PiBjYWxsYmFjayhbZmFsc2UsIGVycm9yXSkpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBGZXRjaCBhIHJlc3RhdXJhbnQgYnkgaXRzIElELlxyXG4gICAqL1xyXG4gIGZldGNoUmVzdGF1cmFudEJ5SWQoaWQsIGNhbGxiYWNrKSB7XHJcbiAgICAvLyBmZXRjaCBhbGwgcmVzdGF1cmFudHMgd2l0aCBwcm9wZXIgZXJyb3IgaGFuZGxpbmcuXHJcbiAgICB0aGlzLmZldGNoUmVzdGF1cmFudCgoW29rID0gZmFsc2UsIHJlc3BvbnNlXSA9IFtdKSA9PiB7XHJcbiAgICAgIGlmICghb2spIHtcclxuICAgICAgICBjYWxsYmFjayghb2ssIHJlc3BvbnNlKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBjYWxsYmFjayhvaywgcmVzcG9uc2UpO1xyXG4gICAgICB9XHJcbiAgICB9LCBpZCk7XHJcbiAgfVxyXG5cclxuICBmZXRjaFJldmlld3NCeVJlc3RhdXJhbnRJZChyZXN0YXVyYW50X2lkLCBjYWxsYmFjaykge1xyXG5cclxuICAgIHRoaXMuZGJQcm9taXNlLnRoZW4oZGIgPT4ge1xyXG4gICAgICByZXR1cm4gZGIudHJhbnNhY3Rpb24oJ3Jldmlld3MnKS5vYmplY3RTdG9yZSgncmV2aWV3cycpLmluZGV4KCdyZXN0YXVyYW50X2lkJykuZ2V0QWxsKHBhcnNlSW50KHJlc3RhdXJhbnRfaWQpKTtcclxuICAgIH0pLnRoZW4ocmV2aWV3cyA9PiB7XHJcbiAgICAgIC8vIERpc3BsYXkgcmVzdGF1cmFudHMgZnJvbSB0aGUgZGF0YWJhc2VcclxuICAgICAgY2FsbGJhY2soW3RydWUsIHJldmlld3NdKTtcclxuXHJcbiAgICAgIC8vIEdldCByZXN0YXVyYW50cyBmcm9tIHRoZSB3ZWJcclxuICAgICAgZmV0Y2godGhpcy5EQVRBQkFTRV9VUkwgKyBgcmV2aWV3cy8/cmVzdGF1cmFudF9pZD0ke3Jlc3RhdXJhbnRfaWR9YClcclxuICAgICAgICAudGhlbihyZXNwb25zZSA9PiByZXNwb25zZS5qc29uKCkpXHJcbiAgICAgICAgLnRoZW4oZGF0YSA9PiB7XHJcbiAgICAgICAgICBjYWxsYmFjayhbdHJ1ZSwgZGF0YV0pO1xyXG5cclxuICAgICAgICAgIC8vIEFkZCByZXN0YXVyYW50cyBmcm9tIHRoZSB3ZWIgdG8gdGhlIGRhdGFiYXNlXHJcbiAgICAgICAgICB0aGlzLmRiUHJvbWlzZS50aGVuKGRiID0+IHtcclxuICAgICAgICAgICAgY29uc3QgdHggPSBkYi50cmFuc2FjdGlvbigncmV2aWV3cycsICdyZWFkd3JpdGUnKTtcclxuICAgICAgICAgICAgY29uc3Qgc3RvcmUgPSB0eC5vYmplY3RTdG9yZSgncmV2aWV3cycpO1xyXG5cclxuICAgICAgICAgICAgZm9yIChjb25zdCByZXZpZXcgb2YgZGF0YSkge1xyXG4gICAgICAgICAgICAgIHN0b3JlLnB1dChyZXZpZXcpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdHguY29tcGxldGU7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5jYXRjaChlcnJvciA9PiBjYWxsYmFjayhbZmFsc2UsIGVycm9yXSkpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBGZXRjaCByZXN0YXVyYW50cyBieSBhIGN1aXNpbmUgdHlwZSB3aXRoIHByb3BlciBlcnJvciBoYW5kbGluZy5cclxuICAgKi9cclxuICBmZXRjaFJlc3RhdXJhbnRCeUN1aXNpbmUoY3Vpc2luZSwgY2FsbGJhY2spIHtcclxuICAgIC8vIEZldGNoIGFsbCByZXN0YXVyYW50cyAgd2l0aCBwcm9wZXIgZXJyb3IgaGFuZGxpbmdcclxuICAgIHRoaXMuZmV0Y2hSZXN0YXVyYW50cygoW29rID0gZmFsc2UsIHJlc3BvbnNlXSA9IFtdKSA9PiB7XHJcbiAgICAgIGlmICghb2spIHtcclxuICAgICAgICBjYWxsYmFjayghb2ssIHJlc3BvbnNlKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAvLyBGaWx0ZXIgcmVzdGF1cmFudHMgdG8gaGF2ZSBvbmx5IGdpdmVuIGN1aXNpbmUgdHlwZVxyXG4gICAgICAgIGNvbnN0IHJlc3VsdHMgPSByZXNwb25zZS5maWx0ZXIociA9PiByLmN1aXNpbmVfdHlwZSA9PSBjdWlzaW5lKTtcclxuICAgICAgICBjYWxsYmFjayhvaywgcmVzdWx0cyk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRmV0Y2ggcmVzdGF1cmFudHMgYnkgYSBuZWlnaGJvcmhvb2Qgd2l0aCBwcm9wZXIgZXJyb3IgaGFuZGxpbmcuXHJcbiAgICovXHJcbiAgZmV0Y2hSZXN0YXVyYW50QnlOZWlnaGJvcmhvb2QobmVpZ2hib3Job29kLCBjYWxsYmFjaykge1xyXG4gICAgLy8gRmV0Y2ggYWxsIHJlc3RhdXJhbnRzXHJcbiAgICB0aGlzLmZldGNoUmVzdGF1cmFudHMoKFtvayA9IGZhbHNlLCByZXNwb25zZV0gPSBbXSkgPT4ge1xyXG4gICAgICBpZiAoIW9rKSB7XHJcbiAgICAgICAgY2FsbGJhY2soIW9rLCByZXNwb25zZSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy8gRmlsdGVyIHJlc3RhdXJhbnRzIHRvIGhhdmUgb25seSBnaXZlbiBuZWlnaGJvcmhvb2RcclxuICAgICAgICBjb25zdCByZXN1bHRzID0gcmVzcG9uc2UuZmlsdGVyKHIgPT4gci5uZWlnaGJvcmhvb2QgPT0gbmVpZ2hib3Job29kKTtcclxuICAgICAgICBjYWxsYmFjayhvaywgcmVzdWx0cyk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRmV0Y2ggcmVzdGF1cmFudHMgYnkgYSBjdWlzaW5lIGFuZCBhIG5laWdoYm9yaG9vZCB3aXRoIHByb3BlciBlcnJvciBoYW5kbGluZy5cclxuICAgKi9cclxuICBmZXRjaFJlc3RhdXJhbnRCeUN1aXNpbmVBbmROZWlnaGJvcmhvb2QoY3Vpc2luZSwgbmVpZ2hib3Job29kLCBjYWxsYmFjaykge1xyXG4gICAgLy8gRmV0Y2ggYWxsIHJlc3RhdXJhbnRzXHJcbiAgICB0aGlzLmZldGNoUmVzdGF1cmFudHMoKFtvayA9IGZhbHNlLCByZXNwb25zZV0gPSBbXSkgPT4ge1xyXG4gICAgICBpZiAoIW9rKSB7XHJcbiAgICAgICAgY2FsbGJhY2soIW9rLCByZXNwb25zZSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgbGV0IHJlc3VsdHMgPSByZXNwb25zZTtcclxuICAgICAgICBpZiAoY3Vpc2luZSAhPSAnYWxsJykgeyAvLyBmaWx0ZXIgYnkgY3Vpc2luZVxyXG4gICAgICAgICAgcmVzdWx0cyA9IHJlc3VsdHMuZmlsdGVyKHIgPT4gci5jdWlzaW5lX3R5cGUgPT0gY3Vpc2luZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChuZWlnaGJvcmhvb2QgIT0gJ2FsbCcpIHsgLy8gZmlsdGVyIGJ5IG5laWdoYm9yaG9vZFxyXG4gICAgICAgICAgcmVzdWx0cyA9IHJlc3VsdHMuZmlsdGVyKHIgPT4gci5uZWlnaGJvcmhvb2QgPT0gbmVpZ2hib3Job29kKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2FsbGJhY2sob2ssIHJlc3VsdHMpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEZldGNoIGFsbCBuZWlnaGJvcmhvb2RzIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nLlxyXG4gICAqL1xyXG4gIGZldGNoTmVpZ2hib3Job29kcyhjYWxsYmFjaykge1xyXG4gICAgLy8gRmV0Y2ggYWxsIHJlc3RhdXJhbnRzXHJcbiAgICB0aGlzLmZldGNoUmVzdGF1cmFudHMoKFtvayA9IGZhbHNlLCByZXNwb25zZV0gPSBbXSkgPT4ge1xyXG4gICAgICBpZiAoIW9rKSB7XHJcbiAgICAgICAgY2FsbGJhY2soIW9rLCByZXNwb25zZSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy8gR2V0IGFsbCBuZWlnaGJvcmhvb2RzIGZyb20gYWxsIHJlc3RhdXJhbnRzXHJcbiAgICAgICAgY29uc3QgbmVpZ2hib3Job29kcyA9IHJlc3BvbnNlLm1hcCgodiwgaSkgPT4gcmVzcG9uc2VbaV0ubmVpZ2hib3Job29kKTtcclxuICAgICAgICAvLyBSZW1vdmUgZHVwbGljYXRlcyBmcm9tIG5laWdoYm9yaG9vZHNcclxuICAgICAgICBjb25zdCB1bmlxdWVOZWlnaGJvcmhvb2RzID0gbmVpZ2hib3Job29kcy5maWx0ZXIoKHYsIGkpID0+IG5laWdoYm9yaG9vZHMuaW5kZXhPZih2KSA9PSBpKTtcclxuICAgICAgICBjYWxsYmFjayhvaywgdW5pcXVlTmVpZ2hib3Job29kcyk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRmV0Y2ggYWxsIGN1aXNpbmVzIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nLlxyXG4gICAqL1xyXG4gIGZldGNoQ3Vpc2luZXMoY2FsbGJhY2spIHtcclxuICAgIC8vIEZldGNoIGFsbCByZXN0YXVyYW50c1xyXG4gICAgdGhpcy5mZXRjaFJlc3RhdXJhbnRzKChbb2sgPSBmYWxzZSwgcmVzcG9uc2VdID0gW10pID0+IHtcclxuICAgICAgaWYgKCFvaykge1xyXG4gICAgICAgIGNhbGxiYWNrKCFvaywgcmVzcG9uc2UpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vIEdldCBhbGwgY3Vpc2luZXMgZnJvbSBhbGwgcmVzdGF1cmFudHNcclxuICAgICAgICBjb25zdCBjdWlzaW5lcyA9IHJlc3BvbnNlLm1hcCgodiwgaSkgPT4gcmVzcG9uc2VbaV0uY3Vpc2luZV90eXBlKTtcclxuICAgICAgICAvLyBSZW1vdmUgZHVwbGljYXRlcyBmcm9tIGN1aXNpbmVzXHJcbiAgICAgICAgY29uc3QgdW5pcXVlQ3Vpc2luZXMgPSBjdWlzaW5lcy5maWx0ZXIoKHYsIGkpID0+IGN1aXNpbmVzLmluZGV4T2YodikgPT0gaSk7XHJcbiAgICAgICAgY2FsbGJhY2sob2ssIHVuaXF1ZUN1aXNpbmVzKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZXN0YXVyYW50IHBhZ2UgVVJMLlxyXG4gICAqL1xyXG4gIHVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCkge1xyXG4gICAgcmV0dXJuIChgLi9yZXN0YXVyYW50Lmh0bWw/aWQ9JHtyZXN0YXVyYW50LmlkfWApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmVzdGF1cmFudCBpbWFnZSBVUkwuXHJcbiAgICovXHJcbiAgaW1hZ2VVcmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpIHtcclxuICAgIHJldHVybiAoYC9pbWcvJHtyZXN0YXVyYW50LnBob3RvZ3JhcGh9LmpwZmApO1xyXG4gIH1cclxuXHJcbiAgaW1hZ2VOYW1lRm9yUmVzdGF1cmFudChyZXN0YXVyYW50KSB7XHJcbiAgICByZXR1cm4gKHJlc3RhdXJhbnQucGhvdG9ncmFwaCB8fCAnNS5qcGYnKS5yZXBsYWNlKC9cXC5qcGYkLywgJycpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogTWFwIG1hcmtlciBmb3IgYSByZXN0YXVyYW50LlxyXG4gICAqL1xyXG4gIG1hcE1hcmtlckZvclJlc3RhdXJhbnQocmVzdGF1cmFudCwgbWFwKSB7XHJcbiAgICBjb25zdCBtYXJrZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTWFya2VyKHtcclxuICAgICAgcG9zaXRpb246IHJlc3RhdXJhbnQubGF0bG5nLFxyXG4gICAgICB0aXRsZTogcmVzdGF1cmFudC5uYW1lLFxyXG4gICAgICB1cmw6IHRoaXMudXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50KSxcclxuICAgICAgbWFwOiBtYXAsXHJcbiAgICAgIGFuaW1hdGlvbjogZ29vZ2xlLm1hcHMuQW5pbWF0aW9uLkRST1BcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIG1hcmtlcjtcclxuICB9XHJcblxyXG4gIHN1Ym1pdFJldmlldyhqc29uRm9ybURhdGEsIGNhbGxiYWNrKSB7XHJcblxyXG4gICAgZmV0Y2godGhpcy5EQVRBQkFTRV9VUkwgKyAncmV2aWV3cycsIHtcclxuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgICAgICBoZWFkZXJzOiBuZXcgSGVhZGVycyh7XHJcbiAgICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICAgICAgICB9KSxcclxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShqc29uRm9ybURhdGEpXHJcbiAgICAgIH0pXHJcbiAgICAgIC50aGVuKHJhd0RhdGEgPT4gcmF3RGF0YS5qc29uKCkpXHJcbiAgICAgIC50aGVuKG5ld1JldmlldyA9PiB7XHJcbiAgICAgICAgY2FsbGJhY2soW3RydWUsIG5ld1Jldmlld10pO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goZXJyb3IgPT4gY2FsbGJhY2soW2ZhbHNlLCBlcnJvcl0pKTtcclxuICB9XHJcblxyXG4gIGNhY2hlUmV2aWV3U3VibWlzc2lvbihqc29uRm9ybURhdGEpIHtcclxuXHJcbiAgICB0aGlzLmRiUHJvbWlzZS50aGVuKGRiID0+IHtcclxuXHJcbiAgICAgIHJldHVybiBkYi50cmFuc2FjdGlvbigncmV2aWV3cy10by1zdWJtaXQnLCAncmVhZHdyaXRlJykub2JqZWN0U3RvcmUoJ3Jldmlld3MtdG8tc3VibWl0JykucHV0KGpzb25Gb3JtRGF0YSk7XHJcblxyXG4gICAgfSkuY2F0Y2goZXJyb3IgPT4gY29uc29sZS5lcnJvcignV2FzblxcJ3QgYWJsZSB0byBjYWNoZSByZXZpZXcgc3VibWlzc2lvbicpKTtcclxuXHJcbiAgfVxyXG5cclxuICBkZWxldGVDYWNoZWRSZXZpZXcoY2FjaGVfaWQpIHtcclxuICAgIHJldHVybiB0aGlzLmRiUHJvbWlzZS50aGVuKGRiID0+IHtcclxuICAgICAgcmV0dXJuIGRiLnRyYW5zYWN0aW9uKCdyZXZpZXdzLXRvLXN1Ym1pdCcsICdyZWFkd3JpdGUnKS5vYmplY3RTdG9yZSgncmV2aWV3cy10by1zdWJtaXQnKS5kZWxldGUoY2FjaGVfaWQpO1xyXG4gICAgfSkuY2F0Y2goZXJyb3IgPT4gY29uc29sZS5lcnJvcihgV2Fzbid0IGFibGUgdG8gZGVsZXRlIGNhY2hlZCByZXZpZXcgc3VibWlzc2lvbiBvZiBJRDogJHtjYWNoZV9pZH1gLCBlcnJvcikpO1xyXG4gIH1cclxuXHJcbiAgc3VibWl0Q2FjaGVkUmV2aWV3KHJlc3RhdXJhbnRfaWQpIHtcclxuICAgIHRoaXMuZGJQcm9taXNlLnRoZW4oZGIgPT4ge1xyXG4gICAgICByZXR1cm4gZGIudHJhbnNhY3Rpb24oJ3Jldmlld3MtdG8tc3VibWl0Jykub2JqZWN0U3RvcmUoJ3Jldmlld3MtdG8tc3VibWl0JykuaW5kZXgoJ3Jlc3RhdXJhbnRfaWQnKS5nZXRBbGwocmVzdGF1cmFudF9pZCk7XHJcbiAgICB9KS50aGVuKGNhY2hlZFJldmlld3MgPT4ge1xyXG5cclxuICAgICAgLy9UaGVyZSBhcmUgbm8gY2FjaGVkIHJldmlld3Mgd2FpdGluZyBmb3Igc3VibWlzc2lvblxyXG4gICAgICBpZiAoIWNhY2hlZFJldmlld3MubGVuZ3RoKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBmb3IgKGNvbnN0IGNhY2hlZFJldmlldyBvZiBjYWNoZWRSZXZpZXdzKSB7XHJcblxyXG4gICAgICAgIHRoaXMuc3VibWl0UmV2aWV3KGNhY2hlZFJldmlldywgKFtvayA9IGZhbHNlLCByZXZpZXddID0gW10pID0+IHtcclxuXHJcbiAgICAgICAgICBpZiAob2spIHtcclxuICAgICAgICAgICAgdGhpcy5kZWxldGVDYWNoZWRSZXZpZXcoY2FjaGVkUmV2aWV3LmNhY2hlX2lkKTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICB9KS5jYXRjaChlcnJvciA9PiBjb25zb2xlLmluZm8oYFdhc24ndCBhYmxlIGdldCBjYWNoZWQgcmV2aWV3IHN1Ym1pc3Npb25zIG9mIHJlc3RhdXJhbnQgSUQ6ICR7cmVzdGF1cmFudF9pZH1gLCBlcnJvcikpO1xyXG4gIH1cclxuXHJcbn1cclxuIiwiY2xhc3MgU2VydmljZVdvcmtlckNvbnRyb2xsZXIge1xyXG5cclxuICBjb25zdHJ1Y3RvcigpIHtcclxuICAgIHRoaXMuX3JlZ2lzdGVyU2VydmljZVdvcmtlcigpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogIFJlZ2lzdGVyIHRoZSBTZXJ2aWNlIFdvcmtlclxyXG4gICAqL1xyXG4gIF9yZWdpc3RlclNlcnZpY2VXb3JrZXIoKSB7XHJcbiAgICBpZiAoIW5hdmlnYXRvci5zZXJ2aWNlV29ya2VyKSByZXR1cm47XHJcbiAgICBuYXZpZ2F0b3Iuc2VydmljZVdvcmtlci5yZWdpc3Rlcignc3cuanMnKTtcclxuICB9XHJcbn1cclxuXHJcbm5ldyBTZXJ2aWNlV29ya2VyQ29udHJvbGxlcigpO1xyXG4iXX0=
